<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jacques van Helden" />

<meta name="date" content="2020-03-09" />

<title>Differential analysis of proteomics data</title>

<script src="Stare_data-analysis_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="Stare_data-analysis_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="Stare_data-analysis_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="Stare_data-analysis_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="Stare_data-analysis_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="Stare_data-analysis_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="Stare_data-analysis_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="Stare_data-analysis_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="Stare_data-analysis_files/navigation-1.1/tabsets.js"></script>
<script src="Stare_data-analysis_files/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Differential analysis of proteomics data</h1>
<h3 class="subtitle">DUBii – Statistics with R</h3>
<h4 class="author">Jacques van Helden</h4>
<h4 class="date">2020-03-09</h4>

</div>


<div id="data-sources" class="section level2">
<h2>Data sources</h2>
<p>Study case:</p>
<ul>
<li><p>Stare, T., Ramšak, Ž., Križnik, M. et al. Multiomics analysis of tolerant interaction of potato with potato virus Y. Sci Data 6, 250 (2019). <a href="https://doi.org/10.1038/s41597-019-0216-1" class="uri">https://doi.org/10.1038/s41597-019-0216-1</a> (<a href="https://www.nature.com/articles/s41597-019-0216-1" class="uri">https://www.nature.com/articles/s41597-019-0216-1</a>)</p></li>
<li><p>The metadata and data area available on the PRIDE database (<a href="https://www.ebi.ac.uk/pride/archive/projects/PXD015221" class="uri">https://www.ebi.ac.uk/pride/archive/projects/PXD015221</a>).</p></li>
<li><p>The data was downloaded from the FTP site (<a href="ftp://ftp.pride.ebi.ac.uk/pride/data/archive/2019/09/PXD015221" class="uri">ftp://ftp.pride.ebi.ac.uk/pride/data/archive/2019/09/PXD015221</a>).</p></li>
</ul>
</div>
<div id="data-loading" class="section level2">
<h2>Data loading</h2>
<div id="data-location" class="section level3">
<h3>Data location</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">## Local dir containing the data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">dataDir &lt;-<span class="st"> &quot;data&quot;</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># list.files(dataDir)</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">## Data file (table of protein quantifications)</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">data.file &lt;-<span class="st"> &quot;ProteomeDiscoverer_Multiconsensus_from_18_Reports_PEP_INFO_protein-table.csv&quot;</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">## Metadata file (sample descriptions)</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">metadata.file &lt;-<span class="st"> &quot;Metadata_sample_names.csv&quot;</span> </a></code></pre></div>
</div>
<div id="load-and-check-the-metadata" class="section level3">
<h3>Load and check the metadata</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">## Load metadata table</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">metadata &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="kw">file.path</span>(dataDir, metadata.file))</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># View(metadata)</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># names(metadata)</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># Select the relevant columns for our analysis</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">fields &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;proteomicsPool&quot;</span>, </a>
<a class="sourceLine" id="cb2-8" data-line-number="8">            <span class="st">&quot;Genotype&quot;</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">            <span class="st">&quot;Treatment&quot;</span>, </a>
<a class="sourceLine" id="cb2-10" data-line-number="10">            <span class="st">&quot;BiosampleName&quot;</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">poolDescriptions &lt;-<span class="st"> </span><span class="kw">unique</span>(metadata[, fields])</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># dim(poolDescriptions)</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co"># View(poolDescriptions)</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">poolNames &lt;-<span class="st"> </span><span class="kw">as.vector</span>(poolDescriptions<span class="op">$</span>proteomicsPool)</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">## Define pool condition as the combination of genotype + treatment</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">poolDescriptions<span class="op">$</span>condition &lt;-<span class="st"> </span><span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">  <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, </a>
<a class="sourceLine" id="cb2-20" data-line-number="20">  poolDescriptions<span class="op">$</span>Genotype,</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">  poolDescriptions<span class="op">$</span>Treatment)</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">## Suppress the leadin &quot;D-&quot;, which is found everywhere and this not informative</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24">poolDescriptions<span class="op">$</span>condition &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="dt">pattern =</span> <span class="st">&quot;^D-&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;&quot;</span>, <span class="dt">x =</span> poolDescriptions<span class="op">$</span>condition)</a>
<a class="sourceLine" id="cb2-25" data-line-number="25"></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">## Build informative labels for the pools</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27">poolLabels &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, </a>
<a class="sourceLine" id="cb2-28" data-line-number="28">                    poolDescriptions<span class="op">$</span>condition,</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">                    poolDescriptions<span class="op">$</span>proteomicsPool)</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">poolLabels &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="dt">pattern =</span> <span class="st">&quot;_pool&quot;</span>, <span class="dt">replacement =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">x =</span> poolLabels)</a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="kw">names</span>(poolLabels) &lt;-<span class="st"> </span>poolNames <span class="co"># use poolNames as indices</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">## Assign the pool labels as rownames for the metadata</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="kw">rownames</span>(poolDescriptions) &lt;-<span class="st"> </span>poolLabels</a>
<a class="sourceLine" id="cb2-35" data-line-number="35"></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">## Define condition-specific colors</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37">conditions &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(poolDescriptions<span class="op">$</span>condition))</a>
<a class="sourceLine" id="cb2-38" data-line-number="38">conditionColors &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="dt">n =</span> <span class="kw">length</span>(conditions))</a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="kw">names</span>(conditionColors) &lt;-<span class="st"> </span>conditions</a>
<a class="sourceLine" id="cb2-40" data-line-number="40"></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">## Assign a color to each pool according to its condition</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42">poolDescriptions<span class="op">$</span>color &lt;-<span class="st"> </span>conditionColors[poolDescriptions<span class="op">$</span>condition]</a></code></pre></div>
<p>The metadata table contains 36 rows, each describing one sample. However, samples were pooled by pairs for the proteomics analysis, so that the actual data contains 18 pools. The table below provides the description of the pools.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">kable</span>(poolDescriptions, <span class="dt">caption =</span> <span class="st">&quot;Description of the sample pools.&quot;</span>)</a></code></pre></div>
<table>
<caption>Description of the sample pools.</caption>
<thead>
<tr class="header">
<th></th>
<th align="left">proteomicsPool</th>
<th align="left">Genotype</th>
<th align="left">Treatment</th>
<th align="left">BiosampleName</th>
<th align="left">condition</th>
<th align="left">color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>COI_MOCK_1C</td>
<td align="left">pool1C</td>
<td align="left">D-COI</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée-COI); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">COI_MOCK</td>
<td align="left">#FF0000FF</td>
</tr>
<tr class="even">
<td>COI_MOCK_2C</td>
<td align="left">pool2C</td>
<td align="left">D-COI</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée-COI); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">COI_MOCK</td>
<td align="left">#FF0000FF</td>
</tr>
<tr class="odd">
<td>COI_MOCK_3C</td>
<td align="left">pool3C</td>
<td align="left">D-COI</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée-COI); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">COI_MOCK</td>
<td align="left">#FF0000FF</td>
</tr>
<tr class="even">
<td>COI_PVY_4C</td>
<td align="left">pool4C</td>
<td align="left">D-COI</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée-COI); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">COI_PVY</td>
<td align="left">#FFFF00FF</td>
</tr>
<tr class="odd">
<td>COI_PVY_5C</td>
<td align="left">pool5C</td>
<td align="left">D-COI</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée-COI); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">COI_PVY</td>
<td align="left">#FFFF00FF</td>
</tr>
<tr class="even">
<td>COI_PVY_6C</td>
<td align="left">pool6C</td>
<td align="left">D-COI</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée-COI); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">COI_PVY</td>
<td align="left">#FFFF00FF</td>
</tr>
<tr class="odd">
<td>NAHG_MOCK_9</td>
<td align="left">pool9</td>
<td align="left">D-NAHG</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée-NahG); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">NAHG_MOCK</td>
<td align="left">#00FF00FF</td>
</tr>
<tr class="even">
<td>NAHG_MOCK_7</td>
<td align="left">pool7</td>
<td align="left">D-NAHG</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée-NahG); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">NAHG_MOCK</td>
<td align="left">#00FF00FF</td>
</tr>
<tr class="odd">
<td>NAHG_MOCK_8</td>
<td align="left">pool8</td>
<td align="left">D-NAHG</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée-NahG); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">NAHG_MOCK</td>
<td align="left">#00FF00FF</td>
</tr>
<tr class="even">
<td>NAHG_PVY_3</td>
<td align="left">pool3</td>
<td align="left">D-NAHG</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée-NahG); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">NAHG_PVY</td>
<td align="left">#00FFFFFF</td>
</tr>
<tr class="odd">
<td>NAHG_PVY_1</td>
<td align="left">pool1</td>
<td align="left">D-NAHG</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée-NahG); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">NAHG_PVY</td>
<td align="left">#00FFFFFF</td>
</tr>
<tr class="even">
<td>NAHG_PVY_2</td>
<td align="left">pool2</td>
<td align="left">D-NAHG</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée-NahG); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">NAHG_PVY</td>
<td align="left">#00FFFFFF</td>
</tr>
<tr class="odd">
<td>WT_MOCK_10</td>
<td align="left">pool10</td>
<td align="left">D-WT</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">WT_MOCK</td>
<td align="left">#0000FFFF</td>
</tr>
<tr class="even">
<td>WT_MOCK_12</td>
<td align="left">pool12</td>
<td align="left">D-WT</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">WT_MOCK</td>
<td align="left">#0000FFFF</td>
</tr>
<tr class="odd">
<td>WT_MOCK_11</td>
<td align="left">pool11</td>
<td align="left">D-WT</td>
<td align="left">MOCK</td>
<td align="left">Potato sample (Désirée); 4 days post mechanical treatment; bottom treated leaf</td>
<td align="left">WT_MOCK</td>
<td align="left">#0000FFFF</td>
</tr>
<tr class="even">
<td>WT_PVY_6</td>
<td align="left">pool6</td>
<td align="left">D-WT</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">WT_PVY</td>
<td align="left">#FF00FFFF</td>
</tr>
<tr class="odd">
<td>WT_PVY_4</td>
<td align="left">pool4</td>
<td align="left">D-WT</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">WT_PVY</td>
<td align="left">#FF00FFFF</td>
</tr>
<tr class="even">
<td>WT_PVY_5</td>
<td align="left">pool5</td>
<td align="left">D-WT</td>
<td align="left">PVY</td>
<td align="left">Potato sample (Désirée); 4 days post potato virus Y inoculation; bottom treated leaf</td>
<td align="left">WT_PVY</td>
<td align="left">#FF00FFFF</td>
</tr>
</tbody>
</table>
<p>The data contains 3 replicates per condition, where a condition is a combination of a genotype (COI, NAHG or WT) and a treatment (MOCK or PVY).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">kable</span>(<span class="kw">table</span>(poolDescriptions[, <span class="kw">c</span>(<span class="st">&quot;Genotype&quot;</span>, <span class="st">&quot;Treatment&quot;</span>)]), </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">      <span class="dt">caption =</span> <span class="st">&quot;Number of replicates per condition. Columns: treatment (MOCK or virus infection). Rows: genotype. &quot;</span>)</a></code></pre></div>
<table>
<caption>Number of replicates per condition. Columns: treatment (MOCK or virus infection). Rows: genotype.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">MOCK</th>
<th align="right">PVY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D-COI</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td>D-NAHG</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td>D-WT</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
</div>
<div id="loading-the-data-table" class="section level3">
<h3>Loading the data table</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="kw">file.path</span>(dataDir, data.file))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># names(data)</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># head(data)</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">## Extract the quantities in a separat data table to facilitate the statistical analysis</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">proteinQuant &lt;-<span class="st"> </span>data[, poolNames]</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw">rownames</span>(proteinQuant) &lt;-<span class="st"> </span>data[, <span class="st">&quot;Accession&quot;</span>]</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co"># dim(proteinQuant)</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co"># View(proteinQuant)</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">## Replace pool names by pool labels in the protein table</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw">names</span>(proteinQuant) &lt;-<span class="st"> </span>poolLabels[<span class="kw">names</span>(proteinQuant)]</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co"># View(proteinQuant)</span></a></code></pre></div>
<p>The data table contains some descriptive columns, followed by 338 columns providing the quantities of 338 proteins (rows) in each sample pool (columns).</p>
</div>
</div>
<div id="distributions-of-quantities-per-sample" class="section level2">
<h2>Distributions of quantities per sample</h2>
<p>Draw a box plot of the protein quantities using <code>boxplot()</code> with its the default options. Then read the help page (<code>help(boxplot)</code>) and fine-tune the options to get a more informative result.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">boxplot</span>(proteinQuant)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/data-structures_boxplot_ugly-1.png" alt="Boxplot showing the distribution of counts per sample for all the detected proteins. The result is not readable, we will do better in the next fiugure. " width="80%" />
<p class="caption">
Boxplot showing the distribution of counts per sample for all the detected proteins. The result is not readable, we will do better in the next fiugure.
</p>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">## Store initial parameter values</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">initialParameters &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># par(&quot;mar&quot;)</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## Modify the parameters</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.1</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw">boxplot</span>(proteinQuant, </a>
<a class="sourceLine" id="cb7-9" data-line-number="9">        <span class="dt">col =</span> poolDescriptions<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">        <span class="dt">xlab =</span> <span class="st">&quot;Raw counts&quot;</span>,</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb7-12" data-line-number="12">        <span class="dt">cex.axis =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">        <span class="dt">las =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="kw">boxplot</span>(<span class="kw">log2</span>(proteinQuant), </a>
<a class="sourceLine" id="cb7-15" data-line-number="15">        <span class="dt">col =</span> poolDescriptions<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">        <span class="dt">xlab =</span> <span class="st">&quot;log2(counts)&quot;</span>,</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb7-18" data-line-number="18">        <span class="dt">cex.axis =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">        <span class="dt">las =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/data-structures_boxplot-1.png" alt="Boxplot showing the distribution of counts per sample for all the detected proteins" width="100%" />
<p class="caption">
Boxplot showing the distribution of counts per sample for all the detected proteins
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">par</span>(initialParameters)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co">## Store initial parameter values</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># par(&quot;mar&quot;)</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">## Modify the parameters</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.1</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw">vioplot</span>(proteinQuant, </a>
<a class="sourceLine" id="cb9-8" data-line-number="8">        <span class="dt">col =</span> poolDescriptions<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">        <span class="dt">xlab =</span> <span class="st">&quot;Raw counts&quot;</span>,</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb9-11" data-line-number="11">        <span class="dt">cex.axis =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">        <span class="dt">las =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="kw">vioplot</span>(<span class="kw">log2</span>(proteinQuant), </a>
<a class="sourceLine" id="cb9-14" data-line-number="14">        <span class="dt">col =</span> poolDescriptions<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">        <span class="dt">xlab =</span> <span class="st">&quot;log2(counts)&quot;</span>,</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb9-17" data-line-number="17">        <span class="dt">cex.axis =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">        <span class="dt">las =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/data-structures_vioplot-1.png" alt="Violin showing the distribution of counts per sample for all the detected proteins" width="100%" />
<p class="caption">
Violin showing the distribution of counts per sample for all the detected proteins
</p>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">par</span>(initialParameters)</a></code></pre></div>
</div>
<div id="normalisation" class="section level2">
<h2>Normalisation</h2>
<div id="mean-based-normalisation" class="section level3">
<h3>Mean-based normalisation</h3>
</div>
<div id="median-based-normalisation" class="section level3">
<h3>Median-based normalisation</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">## Compute the median per pool</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">medianPerPool &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> proteinQuant, <span class="dv">2</span>, median, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">median &lt;-<span class="st"> </span><span class="kw">median</span>(<span class="kw">unlist</span>(proteinQuant), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">proteinQuantMedianNorm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">t</span>(proteinQuant) <span class="op">*</span><span class="st"> </span>median <span class="op">/</span><span class="st"> </span>medianPerPool))</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co"># dim(proteinQuantMedianNorm)</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co"># summary(proteinQuantMedianNorm)</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co"># apply(proteinQuantMedianNorm, 2, median, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">## Modify the parameters</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">4.1</span>, <span class="dv">7</span>, <span class="fl">4.1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="kw">class</span>(proteinQuant)</a></code></pre></div>
<pre><code>[1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">dim</span>(proteinQuant)</a></code></pre></div>
<pre><code>[1] 338  18</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">vioplot</span>(proteinQuantMedianNorm, </a>
<a class="sourceLine" id="cb15-2" data-line-number="2">        <span class="dt">main =</span> <span class="st">&quot;Median-based scaling&quot;</span>,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">        <span class="dt">col =</span> poolDescriptions<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">        <span class="dt">xlab =</span> <span class="st">&quot;Raw counts&quot;</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb15-6" data-line-number="6">        <span class="dt">cex.axis =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">        <span class="dt">las =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="kw">vioplot</span>(<span class="kw">log2</span>(proteinQuantMedianNorm), </a>
<a class="sourceLine" id="cb15-9" data-line-number="9">        <span class="dt">main =</span> <span class="st">&quot;Median-based scaling&quot;</span>,</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">        <span class="dt">col =</span> poolDescriptions<span class="op">$</span>color,</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">        <span class="dt">xlab =</span> <span class="st">&quot;log2(counts)&quot;</span>,</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">        <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb15-13" data-line-number="13">        <span class="dt">cex.axis =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">        <span class="dt">las =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="figures/data-structures_median_norm-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">par</span>(initialParameters)</a></code></pre></div>
</div>
</div>
<div id="log2-transformation-and-filtering" class="section level2">
<h2>Log2 transformation and Filtering</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">## log2 transformation</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">proteinQuantMedianNormLog2 &lt;-<span class="st"> </span><span class="kw">log2</span>(proteinQuantMedianNorm)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">## Replace NA values by zero values</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">na2zero &lt;-<span class="st"> </span>proteinQuantMedianNormLog2[]</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">na2zero[<span class="kw">is.na</span>(na2zero)] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">## Filter out proteins with NA values</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">nona &lt;-<span class="st"> </span><span class="kw">na.omit</span>(proteinQuantMedianNormLog2)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="kw">dim</span>(nona)</a></code></pre></div>
<pre><code>[1] 50 18</code></pre>
</div>
<div id="multidimensional-scaling-with-pca" class="section level2">
<h2>Multidimensional scaling with PCA</h2>
<p>A first exploratory approach is to project the samples on a 2-dimensional plane, where the distance between samples approximately corresponds to the differences between their proteomics profiles.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">pc &lt;-<span class="st"> </span><span class="kw">prcomp</span>(<span class="dt">x =</span> <span class="kw">t</span>(nona), <span class="dt">center =</span> <span class="ot">FALSE</span>, <span class="dt">scale. =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">plot</span>(pc, <span class="dt">col =</span> <span class="st">&quot;#BBFFDD&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Components&quot;</span>)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co"># dim(pc$x)</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co"># rownames(pc$x)</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co"># View(pc$x)</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)) {</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">  <span class="kw">plot</span>(pc<span class="op">$</span>x[, <span class="kw">c</span>(i, i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)], </a>
<a class="sourceLine" id="cb19-9" data-line-number="9">       <span class="dt">col =</span> poolDescriptions[<span class="kw">rownames</span>(pc<span class="op">$</span>x), <span class="st">&quot;color&quot;</span>], </a>
<a class="sourceLine" id="cb19-10" data-line-number="10">       <span class="dt">panel.first =</span> <span class="kw">grid</span>(), <span class="dt">pch =</span> <span class="dv">19</span>)</a>
<a class="sourceLine" id="cb19-11" data-line-number="11">  <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb19-12" data-line-number="12">    <span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> <span class="kw">names</span>(conditionColors), <span class="dt">col =</span> conditionColors, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">0.65</span>)</a>
<a class="sourceLine" id="cb19-13" data-line-number="13">  }</a>
<a class="sourceLine" id="cb19-14" data-line-number="14">}  </a></code></pre></div>
<p><img src="figures/data-structures_pc_plots-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">par</span>(initialParameters)</a></code></pre></div>
</div>
<div id="clustering" class="section level2">
<h2>Clustering</h2>
<div id="clustering-of-the-proteins" class="section level3">
<h3>Clustering of the proteins</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co">## Clustering of the proteins</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">protDist &lt;-<span class="st"> </span><span class="kw">as.dist</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(<span class="kw">t</span>(nona)))</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="co"># dim(protDist)</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">protTree &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="dt">d =</span> protDist, <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="kw">plot</span>(protTree, <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">main =</span> <span class="st">&quot;Clustering between proteins</span><span class="ch">\n</span><span class="st">(correlation, complete)&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/data-structures_protein_tree-1.png" alt="Clustering of the proteins based on their profiles across sample pools. Similarity measure: correlation. Aggregation rule: complete linkage. " width="100%" />
<p class="caption">
Clustering of the proteins based on their profiles across sample pools. Similarity measure: correlation. Aggregation rule: complete linkage.
</p>
</div>
</div>
<div id="clustering-of-the-sample-pools" class="section level3">
<h3>Clustering of the sample pools</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co">## Clustering of the proteins</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">poolDist &lt;-<span class="st"> </span><span class="kw">as.dist</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">cor</span>(nona))</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">protTree &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="dt">d =</span> poolDist, <span class="dt">method =</span> <span class="st">&quot;complete&quot;</span>)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="kw">plot</span>(protTree, <span class="dt">cex =</span> <span class="fl">0.7</span>, </a>
<a class="sourceLine" id="cb22-5" data-line-number="5">     <span class="dt">main =</span> <span class="st">&quot;Clustering between sample pools</span><span class="ch">\n</span><span class="st">(correlation, complete)&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/data-structures_sample_tree-1.png" alt="Clustering of the sample pools based on their profiles across proteins. Similarity measure: correlation. Aggregation rule: complete linkage. " width="100%" />
<p class="caption">
Clustering of the sample pools based on their profiles across proteins. Similarity measure: correlation. Aggregation rule: complete linkage.
</p>
</div>
</div>
</div>
<div id="heatmap" class="section level2">
<h2>Heatmap</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">heatmap</span>(<span class="dt">x =</span> <span class="kw">as.matrix</span>(nona), </a>
<a class="sourceLine" id="cb23-2" data-line-number="2">        <span class="dt">Colv =</span> <span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb23-3" data-line-number="3">        <span class="dt">scale =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">cexRow =</span> <span class="fl">0.7</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/data-structures_heatmap-1.png" alt="Heatmap of log2-transformed values (NA filtered). " width="100%" />
<p class="caption">
Heatmap of log2-transformed values (NA filtered).
</p>
</div>
</div>
<div id="differential-analysis" class="section level2">
<h2>Differential analysis</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Define the two conditions to compare</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">testCondition &lt;-<span class="st"> &quot;NAHG_PVY&quot;</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">ctrlCondition &lt;-<span class="st"> &quot;WT_PVY&quot;</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">## Compute statistics per protein</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6">statPerProt &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">  <span class="dt">mean =</span> <span class="kw">apply</span>(nona, <span class="dv">1</span>, mean),</a>
<a class="sourceLine" id="cb24-8" data-line-number="8">  <span class="dt">sd =</span> <span class="kw">apply</span>(nona, <span class="dv">1</span>, sd),</a>
<a class="sourceLine" id="cb24-9" data-line-number="9">  <span class="dt">mean1 =</span> <span class="kw">apply</span>(nona[, poolDescriptions<span class="op">$</span>condition <span class="op">==</span><span class="st"> </span>testCondition], <span class="dv">1</span>, mean),</a>
<a class="sourceLine" id="cb24-10" data-line-number="10">  <span class="dt">mean2 =</span> <span class="kw">apply</span>(nona[, poolDescriptions<span class="op">$</span>condition <span class="op">==</span><span class="st"> </span>ctrlCondition], <span class="dv">1</span>, mean),</a>
<a class="sourceLine" id="cb24-11" data-line-number="11">  <span class="dt">s1 =</span> <span class="kw">apply</span>(nona[, poolDescriptions<span class="op">$</span>condition <span class="op">==</span><span class="st"> </span>testCondition], <span class="dv">1</span>, sd),</a>
<a class="sourceLine" id="cb24-12" data-line-number="12">  <span class="dt">s2 =</span> <span class="kw">apply</span>(nona[, poolDescriptions<span class="op">$</span>condition <span class="op">==</span><span class="st"> </span>ctrlCondition], <span class="dv">1</span>, sd)</a>
<a class="sourceLine" id="cb24-13" data-line-number="13">)</a>
<a class="sourceLine" id="cb24-14" data-line-number="14">statPerProt<span class="op">$</span>diff =<span class="st"> </span>statPerProt<span class="op">$</span>mean2 <span class="op">-</span><span class="st"> </span>statPerProt<span class="op">$</span>mean1</a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="co"># View(statPerProt)</span></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"></a>
<a class="sourceLine" id="cb24-17" data-line-number="17"><span class="co">## Run t.test on each protein</span></a>
<a class="sourceLine" id="cb24-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(nona)) {</a>
<a class="sourceLine" id="cb24-19" data-line-number="19">  test.result &lt;-<span class="st"> </span><span class="kw">t.test</span>(</a>
<a class="sourceLine" id="cb24-20" data-line-number="20">    <span class="dt">x =</span> nona[i, poolDescriptions<span class="op">$</span>condition <span class="op">==</span><span class="st"> </span>testCondition],</a>
<a class="sourceLine" id="cb24-21" data-line-number="21">    <span class="dt">y =</span> nona[i, poolDescriptions<span class="op">$</span>condition <span class="op">==</span><span class="st"> </span>ctrlCondition],</a>
<a class="sourceLine" id="cb24-22" data-line-number="22">    <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb24-23" data-line-number="23">  statPerProt[i, <span class="st">&quot;tStat&quot;</span>] &lt;-<span class="st"> </span>test.result<span class="op">$</span>statistic</a>
<a class="sourceLine" id="cb24-24" data-line-number="24">  statPerProt[i, <span class="st">&quot;df&quot;</span>] &lt;-<span class="st"> </span>test.result<span class="op">$</span>parameter</a>
<a class="sourceLine" id="cb24-25" data-line-number="25">  statPerProt[i, <span class="st">&quot;p.value&quot;</span>] &lt;-<span class="st"> </span>test.result<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb24-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb24-27" data-line-number="27"><span class="co"># View(statPerProt)</span></a></code></pre></div>
<div id="histogram-of-the-p-values" class="section level3">
<h3>Histogram of the p-values</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">hist</span>(statPerProt<span class="op">$</span>p.value, </a>
<a class="sourceLine" id="cb25-2" data-line-number="2">     <span class="dt">main =</span> <span class="st">&quot;P-value histogram&quot;</span>, </a>
<a class="sourceLine" id="cb25-3" data-line-number="3">     <span class="dt">xlab =</span> <span class="st">&quot;p-value&quot;</span>,</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">     <span class="dt">ylab =</span> <span class="st">&quot;number of proteins&quot;</span>, <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;#DDEEFF&quot;</span>,</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.05</span>))</a></code></pre></div>
<p><img src="figures/data-structures_pval_histo-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="volcano-plot" class="section level3">
<h3>Volcano plot</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">plot</span>(statPerProt<span class="op">$</span>diff, </a>
<a class="sourceLine" id="cb26-2" data-line-number="2">     <span class="op">-</span><span class="kw">log10</span>(statPerProt<span class="op">$</span>p.value), </a>
<a class="sourceLine" id="cb26-3" data-line-number="3">     <span class="dt">main =</span> <span class="st">&quot;Volcano plot&quot;</span>, </a>
<a class="sourceLine" id="cb26-4" data-line-number="4">     <span class="dt">xlab =</span> <span class="st">&quot;Diff&quot;</span>,</a>
<a class="sourceLine" id="cb26-5" data-line-number="5">     <span class="dt">ylab =</span> <span class="st">&quot;-log10(p-value)&quot;</span>, <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;#DDEEFF&quot;</span>,</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.05</span>))</a></code></pre></div>
<p><img src="figures/data-structures_volcano-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
