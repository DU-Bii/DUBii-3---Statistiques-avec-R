<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Prénom NOM" />

<meta name="date" content="2020-08-22" />

<title>Report: supervised classification of cancer data</title>

<script src="NOM-PRENOM_evaluation-m3-2020_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="NOM-PRENOM_evaluation-m3-2020_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="NOM-PRENOM_evaluation-m3-2020_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="NOM-PRENOM_evaluation-m3-2020_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="NOM-PRENOM_evaluation-m3-2020_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="NOM-PRENOM_evaluation-m3-2020_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="NOM-PRENOM_evaluation-m3-2020_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="NOM-PRENOM_evaluation-m3-2020_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="NOM-PRENOM_evaluation-m3-2020_files/navigation-1.1/tabsets.js"></script>
<script src="NOM-PRENOM_evaluation-m3-2020_files/navigation-1.1/codefolding.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Report: supervised classification of cancer data</h1>
<h3 class="subtitle">DUBii 2020 - Module 3 - Analyse statistique avec R - Evaluation</h3>
<h4 class="author">Prénom NOM</h4>
<h4 class="date">2020-08-22</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">#### Just for the trainer: if the solution file exists, load it ####</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">solutionFile &lt;-<span class="st"> &quot;van-Helden-Jacques_evlaluation-m3_solutions.R&quot;</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="cf">if</span> (<span class="kw">file.exists</span>(solutionFile)) {</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="co"># read_chunk(solutionFile)</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">}</a></code></pre></div>
<pre><code>NULL</code></pre>
<div id="principle-of-the-evaluation" class="section level2">
<h2>Principle of the evaluation</h2>
<p>We propose here a structure of scientific report for the final evaluation of the third module “Analyse statistique with R”.</p>
<p>The report is conceived in order to be compiled as is.</p>
<p>To ease your task and ensure everyone starts on the same basis,the notebook already inculdes the following basic tasks:</p>
<ul>
<li>data loading</li>
<li>pre-processing: normalisation, dimension reduction</li>
</ul>
<p>We ask everyone to fill in the missing parts with personnaly written code.</p>
<p>Each trainee will choose a given machine learning method (SVM, KNN, Random Forest, or any other one of your choice), tune its parameters and evaluate its performances. The results will be collected in a comparative table in order to gain a general insight on the respective merits of the methods, based on the individual results.</p>
<p>You will then use your model to assign each sample to one of the 4 cancer types: Basal.like, HER2pos, Luminal.A ou Luminal.B.</p>
<div id="evaluation-criteria" class="section level3">
<h3>Evaluation criteria</h3>
<ul>
<li><p><strong>Reusability of the code</strong>: the trainers should be able to run your R markdown on their instance of RStudio</p></li>
<li><p><strong>Clarity of the code</strong>: the code should be understandable for someone familiar with R programming. Variable names should indicate their content.</p></li>
<li><p><strong>Code structuration</strong>: the code should be well structured. For example, if a given piece of code has to run at several places in your script, try to encapsulate it in a function rather than duplicating the code.</p></li>
<li><p><strong>Code documentation</strong>: the code should be documented by explaining what each piece of code aims at. The implementation choices should be documented.</p></li>
<li><p><strong>Relevance of the statistical approaches</strong>: the markdown should explain why a given statistical method is appropriate to the addressed biological question. Don’t hesitate to comment the basic assumptions underlying the different methods, and the adequacy of your data to these assumption.</p></li>
<li><p><strong>Interpretation of the results</strong>: for each task, we will ask you to interpret the results and to highlight their biological relevance.</p></li>
</ul>
</div>
</div>
<div id="goals-of-the-analysis" class="section level2">
<h2>Goals of the analysis</h2>
<p>Your work will include the following tasks.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Data exploration</strong>: compute descriptive statistics and use different graphical representations to grab general properties of the data distribution.</p>
<ul>
<li>histogram of the data</li>
<li>dot plot of the gene-wise variance versus mean</li>
<li>PC plots</li>
</ul></li>
<li><p><strong>Gene clustering</strong>:</p>
<ul>
<li>run some clustering algorithm in order to identify groups of genes having similar expression profiles across the samples</li>
<li>cluster the samples in order to see if a non-supervised approach reveals subsets of cancer types, and compare the clusters with the annotated cancer types.</li>
</ul></li>
<li><p><strong>Supervised classification</strong></p>
<ul>
<li>choose a supervised classification method among KNN, SVM, Random Forest, or any other method if you feel adventurous.</li>
</ul></li>
</ol>
</div>
<div id="specification-of-the-working-directories" class="section level2">
<h2>Specification of the working directories</h2>
<p>We propose hereafter a piece of code to instantiate the working directories for this analysis in your account. In principle this code should work on any Unix-like operating system (Linux, Mac OX X), it might require some slight adaptation for Windows operating systems.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">## Create a vector with all the user-specific directories, which can be exported in the report afterwards</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">dir &lt;-<span class="st"> </span><span class="kw">vector</span>()</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">## Specify your home directory</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">dir[<span class="st">&quot;home&quot;</span>] &lt;-<span class="st"> &quot;~&quot;</span> <span class="co"># This should probably be modified for Windows OS. </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">## Specify the local directory for the personal work</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">## Don&#39;t hesitate to modify this according to your own file organisation</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">dir[<span class="st">&quot;base&quot;</span>] &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir[<span class="st">&quot;home&quot;</span>], <span class="st">&quot;DUBii&quot;</span>, <span class="st">&quot;m3-stat-R&quot;</span>, <span class="st">&quot;personal-work&quot;</span>)  </a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">## Directory with the results of all analyses</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">dir[<span class="st">&quot;results&quot;</span>] &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir[<span class="st">&quot;base&quot;</span>], <span class="st">&quot;results&quot;</span>)</a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="kw">dir.create</span>(dir[<span class="st">&quot;results&quot;</span>], <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">## Specify a local directory to download the data</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">dir[<span class="st">&quot;BICdata&quot;</span>] &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir[<span class="st">&quot;base&quot;</span>], <span class="st">&quot;data&quot;</span>, <span class="st">&quot;BIC&quot;</span>)</a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="kw">message</span>(<span class="st">&quot;Local data directory for BIC data</span><span class="ch">\t</span><span class="st">&quot;</span>, dir[<span class="st">&quot;BICdata&quot;</span>])</a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="kw">dir.create</span>(dir[<span class="st">&quot;BICdata&quot;</span>], <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-19" data-line-number="19"></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">## Print out a table with the working directories</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="kw">kable</span>(<span class="kw">data.frame</span>(dir), <span class="dt">col.names =</span> <span class="st">&quot;Directory&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Directories&quot;</span>)</a></code></pre></div>
<table>
<caption>Directories</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Directory</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">home</td>
<td align="left">~</td>
</tr>
<tr class="even">
<td align="left">base</td>
<td align="left">~/DUBii/m3-stat-R/personal-work</td>
</tr>
<tr class="odd">
<td align="left">results</td>
<td align="left">~/DUBii/m3-stat-R/personal-work/results</td>
</tr>
<tr class="even">
<td align="left">BICdata</td>
<td align="left">~/DUBii/m3-stat-R/personal-work/data/BIC</td>
</tr>
</tbody>
</table>
</div>
<div id="data-set" class="section level2">
<h2>Data set</h2>
<p>In this work we will develop statistical models to predict cancer types using data from the TCGA study (<em>The Cancer Genome Atlas</em>; <a href="https://cancergenome.nih.gov/" class="uri">https://cancergenome.nih.gov/</a>) which includes RNA-seq data from breast cancer patients (<strong>Breast Invasice Cancer</strong> or <strong>BIC</strong>). There are two invasive cancer types involved: ductal and lobular carcinomas.</p>
<p>Original papers for these studies are here:</p>
<ul>
<li><a href="https://www.nature.com/articles/nature11412" class="uri">https://www.nature.com/articles/nature11412</a></li>
<li><a href="https://www.cell.com/cell/fulltext/S0092-8674(15)01195-2" class="uri">https://www.cell.com/cell/fulltext/S0092-8674(15)01195-2</a></li>
</ul>
<p>We prepared the files containing the BIC transcriptome profiles, and selected a subset of 1000 genes to reduce the size of the data files.</p>
<ul>
<li>file <code>BIC_log2-norm-counts_edgeR_DEG_top_1000.tsv.gz</code> corresponds to the RNA quantification in 819 samples (columns), for the 1000 most significant genes (lines) returned by differential analysis.</li>
<li>file <code>BIC_sample-classes.tsv.gz</code> contains the tags of the 819 samples.</li>
<li>file <code>BIC_edgeR_DEG_table.tsv.gz</code> contains the edgeR results of differential expression analysis.</li>
</ul>
<p>The code below enables you to download the data and install it on your own computer. Note tht th data will be downloaded only once.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">## Files required for the analyses</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">message</span>(<span class="st">&quot;Downloading BIC data&quot;</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">dataFiles &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="st">&quot;expression&quot;</span> =<span class="st"> &quot;BIC_log2-norm-counts_edgeR_DEG_top_1000.tsv.gz&quot;</span>, <span class="co">## Expression values</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  <span class="st">&quot;sample classes&quot;</span> =<span class="st"> &quot;BIC_sample-classes.tsv.gz&quot;</span>, <span class="co">## Sample descriptions</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  <span class="st">&quot;DEG table&quot;</span>  =<span class="st"> &quot;BIC_edgeR_DEG_table.tsv.gz&quot;</span>  <span class="co">## edgeR results of differential expression analysis</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="cf">for</span> (dataFile <span class="cf">in</span> dataFiles) {</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  localFile &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir[<span class="st">&quot;BICdata&quot;</span>], dataFile)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  <span class="cf">if</span> (<span class="kw">file.exists</span>(localFile)) {</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">    <span class="kw">message</span>(<span class="st">&quot;File already here, not downloading</span><span class="ch">\n\t</span><span class="st">&quot;</span>, localFile, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">    githubURL &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;https://github.com/DU-Bii/module-3-Stat-R/raw/master/stat-R_2020/data/TCGA_BIC_subset/&quot;</span>, dataFile)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">    <span class="kw">message</span>(<span class="st">&quot;Downloading data file from github:</span><span class="ch">\n\t</span><span class="st">&quot;</span>, githubURL)</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">    <span class="kw">download.file</span>(<span class="dt">url =</span> githubURL, <span class="dt">destfile =</span> localFile)</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">  }</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">}</a></code></pre></div>
</div>
<div id="data-preprocessing" class="section level2">
<h2>Data preprocessing</h2>
<p>The data was pre-processed in order to provide you with a dataset ready-to-use for the multivariate analysis tasks.</p>
<p>In short, the pre-processing included the following steps.</p>
<ol style="list-style-type: decimal">
<li><p>Download of the raw counts per gene from the ReCount database</p></li>
<li><p>Selection of the subset of samples belonging to the <strong>Breast Invasive Cancer</strong> (<strong>BIC</strong>) study.</p></li>
<li><p>Assignment of a cancer type, based on three immuno markers (documented in the sample description table).</p></li>
<li><p>Filtering out of the “undetected” genes, i.e. genes having either zero counts in more than 95% of the samples, or a mean count <span class="math inline">\(\se 10\)</span> across all the BIC samples.</p></li>
<li><p>Count standardisation. To compensate for difference in sequencing depth, we applied a sample-wise standardisation with <code>DESeq2::estimateSizeFactors()</code>.</p></li>
<li><p>Log2 transformation. Standardised counts were log2-transformed in order to normalise the values. Log2-transformed data are more appropriate for clustering and supervised classification.</p></li>
<li><p>Feature selection. In order to select relevant subset of genes, we ran multi-group differential analysis with edgeR. Note that this analysis was led with the raw counts (edgeR and DESeq2 have their own built-in normalisation procedure, and should never be fed with normalised data).</p></li>
</ol>
<p>Additional details and the full code used for preprocessing can be found on the DUBii study case repository: <a href="https://du-bii.github.io/study-cases/Homo_sapiens/TCGA_study-case/import_TCGA_from_Recount.html" class="uri">https://du-bii.github.io/study-cases/Homo_sapiens/TCGA_study-case/import_TCGA_from_Recount.html</a></p>
</div>
<div id="data-loading" class="section level2">
<h2>Data loading</h2>
<p>The data were loaded from the folder ~/DUBii/m3-stat-R/personal-work/data/BIC.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">## Load expression data</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## Note: we use the option check.name=FALSE to avoid converting </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">## hyphens to dot in the sample IDs (column names)</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">BIC.expr &lt;-<span class="st"> </span><span class="kw">read.table</span>(</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="dt">file =</span> <span class="kw">file.path</span>(dir[<span class="st">&quot;BICdata&quot;</span>], dataFiles[<span class="st">&quot;expression&quot;</span>]), </a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="dt">check.names =</span> <span class="ot">FALSE</span>, <span class="co"># Added by JvH 2020-07-24</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">  <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co"># dim(BIC.expr)</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co"># colnames(BIC.expr)</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">## Load sample description table, whichb includes cancer class + immuno markers</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">## Note: we set the option stringsAsFactor=FALSE to facilitate </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">## subsequent use of the cancer.type column.</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">BIC.sample.classes &lt;-<span class="st"> </span><span class="kw">read.table</span>(</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  <span class="kw">file.path</span>(dir[<span class="st">&quot;BICdata&quot;</span>], dataFiles[<span class="st">&quot;sample classes&quot;</span>]), </a>
<a class="sourceLine" id="cb5-17" data-line-number="17">  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>, <span class="co"># Added by JvH 2020-07-24</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18">  <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co"># dim(BIC.sample.classes)</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co"># names(BIC.sample.classes)</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co"># head(BIC.sample.classes)</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co"># class(BIC.sample.classes$cancer.type)</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">## Define sample colors and 1-letter symbols</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">class.symbols &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb5-26" data-line-number="26">  <span class="st">&quot;Basal.like&quot;</span> =<span class="st"> &quot;L&quot;</span>,</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">  <span class="st">&quot;HER2pos&quot;</span> =<span class="st"> &quot;H&quot;</span>,</a>
<a class="sourceLine" id="cb5-28" data-line-number="28">  <span class="st">&quot;Luminal.A&quot;</span> =<span class="st"> &quot;A&quot;</span>,</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">  <span class="st">&quot;Luminal.B&quot;</span> =<span class="st"> &quot;B&quot;</span>,</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">  <span class="st">&quot;Unclassified&quot;</span> =<span class="st"> &quot;U&quot;</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31">)</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">BIC.sample.classes<span class="op">$</span>symbol &lt;-<span class="st"> </span>class.symbols[BIC.sample.classes<span class="op">$</span>cancer.type]</a>
<a class="sourceLine" id="cb5-33" data-line-number="33"><span class="kw">table</span>(BIC.sample.classes<span class="op">$</span>symbol)</a></code></pre></div>
<pre><code>
  A   B   H   L   U 
422 118  41 131 107 </code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">## Define a color for each cancer class and assign colors to samples accordingly.</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">class.colors &lt;-<span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="st">&quot;Basal.like&quot;</span> =<span class="st"> &quot;brown&quot;</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="st">&quot;HER2pos&quot;</span> =<span class="st"> &quot;darkgreen&quot;</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="st">&quot;Luminal.A&quot;</span> =<span class="st"> &quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  <span class="st">&quot;Luminal.B&quot;</span> =<span class="st"> &quot;violet&quot;</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  <span class="st">&quot;Unclassified&quot;</span> =<span class="st"> &quot;grey&quot;</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">BIC.sample.classes<span class="op">$</span>color &lt;-<span class="st"> </span>class.colors[BIC.sample.classes<span class="op">$</span>cancer.type]</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">## Load differential expression analysis results from DESeq2</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">BIC.deg &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="kw">file.path</span>(dir[<span class="st">&quot;BICdata&quot;</span>], dataFiles[<span class="st">&quot;DEG table&quot;</span>]),</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">                      <span class="dt">header =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co"># head(BIC.deg)</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">#### Reorder samples in order to group them by class ####</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">sampleNamesByClass &lt;-<span class="st"> </span><span class="kw">rownames</span>(BIC.sample.classes)[<span class="kw">order</span>(BIC.sample.classes<span class="op">$</span>cancer.type)]</a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="kw">length</span>(sampleNamesByClass)</a></code></pre></div>
<pre><code>[1] 819</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">BIC.expr &lt;-<span class="st"> </span>BIC.expr[, sampleNamesByClass]</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">BIC.sample.classes &lt;-<span class="st"> </span>BIC.sample.classes[sampleNamesByClass, ]</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">kable</span>(dataFiles, <span class="dt">col.names =</span> <span class="st">&quot;File&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Data files&quot;</span>)</a></code></pre></div>
<table>
<caption>Data files</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">expression</td>
<td align="left">BIC_log2-norm-counts_edgeR_DEG_top_1000.tsv.gz</td>
</tr>
<tr class="even">
<td align="left">sample classes</td>
<td align="left">BIC_sample-classes.tsv.gz</td>
</tr>
<tr class="odd">
<td align="left">DEG table</td>
<td align="left">BIC_edgeR_DEG_table.tsv.gz</td>
</tr>
</tbody>
</table>
<p>The expression file contains 1000 rows (genes) x 819 columns (samples).</p>
<p>The sample description table contains 819 rows (samples) x 6 columns (description fields). The first column indicates the cancer type, and the three following one indicate the values (positive/negative) for three marker genes used as diagnostic markers for the cancer type (<em>ER1</em>, <em>PR1</em> et <em>Her2</em>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">head</span>(BIC.sample.classes, <span class="dt">n =</span> <span class="dv">5</span>), <span class="dt">caption =</span> <span class="st">&quot;First rows of the sample description table. &quot;</span>)</a></code></pre></div>
<table>
<caption>First rows of the sample description table.</caption>
<colgroup>
<col width="41%" />
<col width="13%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="7%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">cancer.type</th>
<th align="left">ER1</th>
<th align="left">PR1</th>
<th align="left">Her2</th>
<th align="left">symbol</th>
<th align="left">color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">079EACA1-0319-4B54-B20B-673F4576C69D</td>
<td align="left">Basal.like</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">L</td>
<td align="left">brown</td>
</tr>
<tr class="even">
<td align="left">C392B91B-1F08-4E33-9AB7-42EC0FCE3B92</td>
<td align="left">Basal.like</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">L</td>
<td align="left">brown</td>
</tr>
<tr class="odd">
<td align="left">A451CA06-E1BF-478B-9A50-A0D8C3D4A2AC</td>
<td align="left">Basal.like</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">L</td>
<td align="left">brown</td>
</tr>
<tr class="even">
<td align="left">F53C3D33-7501-46E1-8125-56FB73083B65</td>
<td align="left">Basal.like</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">L</td>
<td align="left">brown</td>
</tr>
<tr class="odd">
<td align="left">22A5E04D-A9A8-4C13-8A13-9BDBEB357686</td>
<td align="left">Basal.like</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">Negative</td>
<td align="left">L</td>
<td align="left">brown</td>
</tr>
</tbody>
</table>
<p>We can count the number of samples per cancer type</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">sort</span>(<span class="kw">table</span>(BIC.sample.classes<span class="op">$</span>cancer.type), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb11-2" data-line-number="2">      <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Cancer type&quot;</span> , <span class="st">&quot;Nb samples&quot;</span>))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Cancer type</th>
<th align="right">Nb samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luminal.A</td>
<td align="right">422</td>
</tr>
<tr class="even">
<td align="left">Basal.like</td>
<td align="right">131</td>
</tr>
<tr class="odd">
<td align="left">Luminal.B</td>
<td align="right">118</td>
</tr>
<tr class="even">
<td align="left">Unclassified</td>
<td align="right">107</td>
</tr>
<tr class="odd">
<td align="left">HER2pos</td>
<td align="right">41</td>
</tr>
</tbody>
</table>
<p>There are 5 cancer types, including a “Unclassified”, for the samples having a combination of markers inconsistent with the defined subtypes. This might bias the result since this “class” is likely to contain a mixture of different cancer types. We will thus temporarily suppress these samples from the dataset, but we will come back to it at the end of the work, since they provide an excellent opportunity to run the classifier for predictive purpuses (assign unclassified samples to one of the training classes).</p>
<p>The code below creates a data set from which the <code>Unclassified</code> samples has been suppressed.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">## Generate a Boolean vector indicating which samples are unclassfied</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">unclassified &lt;-<span class="st"> </span>BIC.sample.classes<span class="op">$</span>cancer.type <span class="op">==</span><span class="st"> &quot;Unclassified&quot;</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">## Count the number of genes having or not the unclassified label</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co"># table(unclassified)</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">## Get the indices of the corresponding rowss</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">ind.uncl &lt;-<span class="st"> </span><span class="kw">which</span>(unclassified)</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">## Count the number of unclassified samples</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co"># length(ind.uncl)</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">## Create a separate data frame </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14">BIC.sample.classes.filtered &lt;-<span class="st"> </span>BIC.sample.classes[<span class="op">-</span>ind.uncl,]</a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co"># dim(BIC.sample.classes.filtered)</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"></a>
<a class="sourceLine" id="cb12-17" data-line-number="17">BIC.expr.filtered &lt;-<span class="st"> </span>BIC.expr[, <span class="op">-</span>ind.uncl] </a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co"># dim(BIC.expr.filtered)</span></a></code></pre></div>
</div>
<div id="data-reduction" class="section level2">
<h2>Data reduction</h2>
<p>We propose three methods to reduce the data dimensions.</p>
<ol style="list-style-type: lower-alpha">
<li><p><strong>Differentially Expressed Genes</strong> (<strong>DEG</strong>). Selection of the most signficant genes reported by DESeq2 (multi-group differential analysis). This has already been done for you, we provide the table with the 1000 top significant genes.</p></li>
<li><p><strong>Variance-ordered</strong>: genes were sorted by decreasing variance (unsupervised criterion). To avoid handling big files, we will apply a re-ordering of the 1000 top-ranking DEG genes, and see whether the genes wiht the highest variance provide good classifiers.</p></li>
<li><p><strong>PCs</strong> Principal components. We will use a restricted number of principal components and see if they capture a sufficient information to train a classifier.</p></li>
</ol>
<p>You will use these respective datasets at different stages of your report.</p>
<div id="deg-selection" class="section level3">
<h3>DEG selection</h3>
<p>The code below sorts the expression table by increasing values of the FDR (column <code>padj</code> of the table <code>BIC.deg</code>) found in the differential expression table (variable <code>BIC.deg</code>).</p>
<p>Note that DEG table contains 20249 genes, whereas the expression table was restricted to 1000 genes. We thus used a trick to select the right genes and sort them. The result is a table with 1000 rows (genes) and 712 columns (samples), sorted by increasing FDR (not in the table).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">## Select in the DEG table (that contains ~20,000 genes) the subset that is found in the expression table (1000 genes)</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">BIC.deg.filtered &lt;-<span class="st"> </span><span class="kw">subset</span>(</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">  BIC.deg, </a>
<a class="sourceLine" id="cb13-4" data-line-number="4">  <span class="kw">row.names</span>(BIC.deg) <span class="op">%in%</span><span class="st"> </span><span class="kw">row.names</span>(BIC.expr.filtered))</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co"># dim(BIC.deg.filtered)</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># View(BIC.deg.filtered)</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">## Sort gene names by increasing value of edgeR padj</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">geneOrder &lt;-<span class="st"> </span><span class="kw">rownames</span>(BIC.deg.filtered)[<span class="kw">order</span>(BIC.deg.filtered<span class="op">$</span>padj, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>)]</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co"># head(geneOrder)</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="co">## Sort the expression table according to the DEG gene order</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">BIC.expr.DEGsorted &lt;-<span class="st"> </span>BIC.expr.filtered[geneOrder, ]</a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co"># View(BIC.expr.DEGsorted)</span></a></code></pre></div>
</div>
<div id="variance-based-ordering" class="section level3">
<h3>Variance-based ordering</h3>
<p>It is now your turn to process the data. Create another table with the filtered expression table sorted by decreasing variance.</p>
</div>
<div id="principal-components" class="section level3">
<h3>Principal components</h3>
<p>Run principal component analysis on the filtered expression table and create a separate table named <code>BIC.expr.PCs</code> with the coordinates of each sample in the principal component space.</p>
</div>
</div>
<div id="pc-plots" class="section level2">
<h2>PC plots</h2>
<p>Generate PC plots with the following components. Label the samples according to their annotated class.</p>
<ul>
<li>PC2 vs PC1</li>
<li>PC4 vs PC3</li>
<li>PC6 vs PC5</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co">## YOUR CODE SHOULD COME HERE</span></a></code></pre></div>
<div id="your-interpretation" class="section level3">
<h3>Your interpretation</h3>
</div>
</div>
<div id="clustering" class="section level2">
<h2>Clustering</h2>
<div id="gene-clustering" class="section level3">
<h3>Gene clustering</h3>
<p>Select the 500 most significant genes based on the adjusted p-value and run hierarchical clustering using the following dissimilarity metrics</p>
<ul>
<li>Euclidian distance (<span class="math inline">\(d_E\)</span>)</li>
<li>Pearson’s correlation-derived (<span class="math inline">\(d_P = 1 - c_P\)</span>) where <span class="math inline">\(c_P\)</span> is Pearson’s correlation)</li>
<li>Spearman’s correlation-derived (<span class="math inline">\(d_S = 1 - c_S\)</span>) where <span class="math inline">\(c_S\)</span> is Spearman’s correlation)</li>
</ul>
<p>Draw the results in a heatmap, where the rows correspond to genes and colums to samples. Make sure that the heatmap reflects the gene tree, but leaves the samples in their original order (to keep together the samples of the same cancer type).</p>
<p>Tips: <code>cor()</code>, <code>hclust()</code>, <code>heatmap()</code>,<code>heatmap.2()</code> or the other heatmap functions seen in the practicals.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">## YOUR CODE SHOULD COME HERE</span></a></code></pre></div>
<div id="gene-clusètering-your-interpretation" class="section level4">
<h4>Gene clusètering: your interpretation</h4>
<p>Interpret the results (1 or 2 paragraphs): do you see a correspondence between the gene expression profiles and cancer classes?</p>
</div>
</div>
<div id="sample-clustering" class="section level3">
<h3>Sample clustering</h3>
<p>Apply the same 3 metrics to cluster samples based on the expression levels.</p>
<p>For each metrics, prune the tree to obtain 4 clusters, and compare them with the annotated cancer class (tips: <code>cutree()</code>, <code>table()</code>, <code>kable()</code>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">## YOUR CODE SHOULD COME HERE</span></a></code></pre></div>
<div id="sample-clustering-your-interpretation" class="section level4">
<h4>Sample clustering: your interpretation</h4>
<p>Is there a good correspondence between sample clusters and annotated cancer types? Is there a strong impact of the dissimilarity metrics? Which one performs best?</p>
</div>
</div>
</div>
<div id="supervised-classification" class="section level2">
<h2>Supervised classification</h2>
<div id="preparation-of-training-and-testing-subsets" class="section level3">
<h3>Preparation of training and testing subsets</h3>
<ul>
<li><p>The <strong>learning set</strong> is the set which will allow to train the models. It will be made of 2/3 of the samples randomly selected.</p></li>
<li><p>The <strong>testing set</strong> is the set which will allow to estimate the unbiased performances of the models. It will be made of the remaining 1/3 of the samples.</p></li>
</ul>
<p>Split the filtered data set into training (2/3) and a testing (1/3) subsets with a balanced representation of the cancer types (stratified subsampling).</p>
</div>
<div id="evaluation-of-the-performances" class="section level3">
<h3>Evaluation of the performances</h3>
<p>In this section, we will perform here a manual evaluation of the classifier in order to make sure we master the different steps. In the next section we will use the <code>tune()</code> utilities in order to identify the optimal parameter values.</p>
<ol style="list-style-type: decimal">
<li><p>Use the training subset to train a classifier of your choice (KNN, SVM, Random Forest or an other one if you feel adventurous).</p></li>
<li><p>Use the resulting model to predict the cancer type for the samples of the testing set.</p></li>
<li><p>Build a confusion matrix to compare the predicted classes and annotated classes for the testing set.</p></li>
<li><p>Compute the misclassification error rate (MER).</p></li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">## YOUR CODE SHOULD COME HERE</span></a></code></pre></div>
<div id="your-interpretation-1" class="section level4">
<h4>Your interpretation</h4>
<p>Interpret the results: how well does the classifier perform? Is there a bias towards some cancer types?</p>
</div>
</div>
<div id="tuning-of-the-parameters" class="section level3">
<h3>Tuning of the parameters</h3>
<p>Test the impact of a parameter on the performances by repeating the steps above with different values of this parameter. The parameter to be tested will depend on the algorithm you chose.</p>
<ul>
<li><code>svm()</code>: test each one of the 4 supported kernels</li>
<li><code>knn()</code>: test the impact of the number of neighbors</li>
<li><code>randomForest()</code>: test the impact of the <code>mtry</code>parameter</li>
</ul>
<p>Tips: <code>tuneRF()</code> or <code>tune.randomForest()</code>, <code>tune.knn()</code>, <code>tune.svm()</code></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">## YOUR CODE SHOULD COME HERE</span></a></code></pre></div>
<div id="your-interpretation-2" class="section level4">
<h4>Your interpretation</h4>
<p>Interpret the results: do the tested parameters affect a lot the performances (are the results robust or sensitive to the choice of the parmeter value)? Do you see a rationale for the optimal values returned by the tune functions?</p>
</div>
</div>
<div id="prediction" class="section level3">
<h3>Prediction</h3>
<ol style="list-style-type: decimal">
<li>Train the classifier with all the samples of the filtered data set</li>
<li>Use the resulting model to predict the cancer type for the unclassified samples.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">## YOUR CODE SHOULD COME HERE</span></a></code></pre></div>
<div id="your-interpretation-3" class="section level4">
<h4>Your interpretation</h4>
<p>Comment the general assignment of the unclassified samples to the different classes. Analyse the relationship between the immuno markers and the predicted classes.</p>
<hr />
</div>
</div>
</div>
<div id="general-conclusion-and-perspectives" class="section level2">
<h2>General conclusion and perspectives</h2>
<p>(a few sentences, no more)</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
