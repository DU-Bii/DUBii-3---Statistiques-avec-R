<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Claire Vandiedonck, Jacques van Helden, Anne Badel &amp; Olivier Sand" />

<meta name="date" content="2021-04-22" />

<title>Mini-projet 2021 - Exploration des données de Pavkovic</title>

<script src="solutions_m3-stat-R_mini-projet_files/header-attrs-2.5/header-attrs.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/jquery-3.5.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="solutions_m3-stat-R_mini-projet_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="solutions_m3-stat-R_mini-projet_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="solutions_m3-stat-R_mini-projet_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="solutions_m3-stat-R_mini-projet_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/navigation-1.1/tabsets.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/navigation-1.1/codefolding.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/navigation-1.1/sourceembed.js"></script>
<link href="solutions_m3-stat-R_mini-projet_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="solutions_m3-stat-R_mini-projet_files/anchor-sections-1.0/anchor-sections.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/plotly-binding-4.9.3/plotly.js"></script>
<script src="solutions_m3-stat-R_mini-projet_files/typedarray-0.1/typedarray.min.js"></script>
<link href="solutions_m3-stat-R_mini-projet_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="solutions_m3-stat-R_mini-projet_files/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="solutions_m3-stat-R_mini-projet_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="solutions_m3-stat-R_mini-projet_files/plotly-main-1.57.1/plotly-latest.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Mini-projet 2021 - Exploration des données de Pavkovic</h1>
<h4 class="author">Claire Vandiedonck, Jacques van Helden, Anne Badel &amp; Olivier Sand</h4>
<h4 class="date">2021-04-22</h4>

</div>


<table>
<caption>Loaded required libraries</caption>
<thead>
<tr class="header">
<th align="left">libraries</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">knitr</td>
</tr>
<tr class="even">
<td align="left">FactoMineR</td>
</tr>
<tr class="odd">
<td align="left">factoextra</td>
</tr>
<tr class="even">
<td align="left">gprofiler2</td>
</tr>
<tr class="odd">
<td align="left">pheatmap</td>
</tr>
<tr class="even">
<td align="left">biomaRt</td>
</tr>
</tbody>
</table>
<div id="synopsis-du-projet" class="section level2">
<h2>Synopsis du projet</h2>
<div id="travail-demandé" class="section level3">
<h3>Travail demandé</h3>
<p>Le but de ce travail est de mettre en oeuvre les méthodes vues dans le module 3 “R et statistiques” pour explorer le jeu de données de Pavkovic, et de rendre un rapport d’analyse au format <code>.Rmd</code>.</p>
<p>Nous fournissons ci-dessous une trame avec les principales sections attendues. Certaines contiennent déjà du code. Vous devrez en compléter d’autres. Sentez-vous libres d’adapter cette trame ou d’y ajouter des analyses complémentaires si elles vous aident à interpréter vos résultats.</p>
</div>
<div id="remise-du-rapport" class="section level3">
<h3>Remise du rapport</h3>
<p>Date: <strong>le 22 mai 2021 à minuit</strong>. Si vous anticipez un problème pour remettre le rapport à cette date contactez-nous aussi rapidement que possible pour que nous puissions prévoir une remise plus tardive.</p>
<ul>
<li><p>Commencez par renommer le fichier .Rmd en remplaçant Prenom-NOM par vos nom et prénom.</p></li>
<li><p>Le rapport est attendu en formats .Rmd + .HTML (en gardant l’option self_contained de l’en-tête activée).</p></li>
<li><p>Déposez les fichiers dans un sous-dossier de vote compte du cluster. Attention, veillez à respecter précisément cette structure de chemin car nous nous baserons dessus pour récupérer vos résultats.</p>
<p><code>/shared/projects/dubii2021/[login]/m3-stat-R/mini-projet</code></p></li>
</ul>
</div>
<div id="critères-dévaluation" class="section level3">
<h3>Critères d’évaluation</h3>
<ul>
<li>Reproductibilité des analyses: nous tenterons de regénérer le rapport HTML à partir de votre Rmd, en partant de notre compte sur le serveur IFB.</li>
<li>Manipulation des objets R</li>
<li>Mobilisation des méthodes statistiques vues au cours</li>
<li>Pertinence des interprétations statistiques</li>
<li>Pertinence des interprétations biologiques</li>
<li>Clarté de la rédaction</li>
<li>Clarté des illustrations (figures et tableaux): graphismes, légendes …</li>
</ul>
<p>Nous vous encourageons à assurer la lisibilité de votre code (syntaxe, nommage des variables, commentaires de code)</p>
</div>
<div id="objectifs-scientifiques" class="section level3">
<h3>Objectifs scientifiques</h3>
<p>Nous partons du même jeu de données <em>Fil Rouge</em> de ce module issues de la publication Pavkovic, M., Pantano, L., Gerlach, C.V. et al. Multi omics analysis of fibrotic kidneys in two mouse models. Sci Data 6, 92 (2019). <a href="https://doi.org/10.1038/s41597-019-0095-5" class="uri">https://doi.org/10.1038/s41597-019-0095-5</a></p>
<p><strong>Rappel sur les échantillons:</strong></p>
<p>Deux modèles de fibrose rénale chez la souris sont étudiés:</p>
<ol style="list-style-type: decimal">
<li><p>Le premier est un modèle de néphropathie réversible induite par l’acide folique (folic acid (FA)). Les souris ont été sacrifiées avant le traitement (normal), puis à jour 1, 2, 7 et 14 (day1,…) après une seule injection d’acide folique.</p></li>
<li><p>Le second est un modèle irréversible induit chrirurgicalement (unilateral ureteral obstruction (UUO)). les souris ont été sacrifiées avant obstruction (day 0) et à 3, 7 et 14 jours après obstruction par ligation de l’uretère du rein gauche.</p></li>
</ol>
<p>A partir de ces extraits de rein, l’ARN messager total et les petits ARNs ont été séquencés et les protéines caratérisées par spectrométrie de masse en tandem (TMT).</p>
<p><strong>But scientifique:</strong> Dans le tutoriel sur les dataframes, vous avez travaillé sur les données de <strong><em>transcriptome du modèle UUO</em></strong>. Dans ce mini-projet, vous allez travailler sur les données du <strong><em>transcriptome du modèle FA</em></strong> afin de regrouper les observations (échantillon) et les gènes selon des profils d’expression similaires.</p>
<p><strong>Votre projet se décompose en 5 parties dont 3 seront à réaliser par:</strong></p>
<ol style="list-style-type: decimal">
<li>Statitiques descriptives des données brutes: commandes fournies</li>
<li>Normalisation des données : commandes fournies</li>
<li>Statistiques descriptives des données normalisées: à vous de jouer</li>
<li>Analyse de regroupement des données: à vous de jouer</li>
<li>Analyse d’enrichissement fonctionnel: à vous de jouer</li>
</ol>
</div>
</div>
<div id="les-données-brutes" class="section level2">
<h2>1. Les données brutes</h2>
<p><strong><em>Vous n’avez rien à coder ici. Le code est fourni.</em></strong></p>
<div id="chargement-des-données-brutes" class="section level3">
<h3>Chargement des données brutes</h3>
<p>Le bloc suivant contient une fonction qui permet de télécharger un fichier dans l’espace de travail, sauf s’il est déjà présent. Nous l’utiliserons ensuite pour télécharger les données à analyser en évitant de refaire le transfert à chaque exécution de l’analyse.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @title Download a file only if it is not yet here</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @author Jacques van Helden email{Jacques.van-Helden@@france-bioinformatique.fr}</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param url_base base of the URL, that will be prepended to the file name</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param file_name name of the file (should not contain any path)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param local_folder path of a local folder where the file should be stored</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return the function returns the path of the local file, built from local_folder and file_name</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @export©</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>download_only_once <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  url_base, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  file_name,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  local_folder) {</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Define the source URL  </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> <span class="fu">file.path</span>(url_base, file_name)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;Source URL</span><span class="sc">\n\t</span><span class="st">&quot;</span>,  url)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Define the local file</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  local_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(local_folder, file_name)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create the local data folder if it does not exist</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dir.create</span>(local_folder, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Download the file ONLY if it is not already there</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(local_file)) {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;Downloading file from source URL to local file</span><span class="sc">\n\t</span><span class="st">&quot;</span>, </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            local_file)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(<span class="at">url =</span> url, <span class="at">destfile =</span> local_file)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;Local file already exists, no need to download</span><span class="sc">\n\t</span><span class="st">&quot;</span>, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            local_file)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(local_file)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nous téléchargeons deux fichiers dans un dossier local <code>~/m3-stat-R/pavkovic_analysis</code> <strong>(vous pouvez changer le nom ou chemin dans le chunk ci-dessous)</strong>, et les chargeons dans les data.frames suivants:</p>
<ul>
<li>Données brutes de transcriptome: <code>fa_expr_raw</code></li>
<li>Métadonnées: <code>fa_meta</code></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the remote URL and local folder</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>pavkovic_url <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/DU-Bii/module-3-Stat-R/raw/master/stat-R_2021/data/pavkovic_2019/&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Define the local folder for this analysis (where the data will be downloaded and the results generated)</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>pavkovic_folder <span class="ot">&lt;-</span> <span class="st">&quot;~/m3-stat-R/pavkovic_analysis&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Define a sub-folder for the data</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>pavkovic_data_folder <span class="ot">&lt;-</span> <span class="fu">file.path</span>(pavkovic_folder, <span class="st">&quot;data&quot;</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Download and load the expression data table</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Note: we use check.names=FALSE to avoid replacing hyphens by dots</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="do">## in sample names, because we want to keep them as in the </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="do">## original data files. </span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Downloading FA transcriptome file</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="st">&quot;fa_raw_counts.tsv.gz&quot;</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;</span><span class="sc">\n\t</span><span class="st">from</span><span class="sc">\t</span><span class="st">&quot;</span>, pavkovic_url)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>fa_expr_file <span class="ot">&lt;-</span> <span class="fu">download_only_once</span>(</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">url_base =</span> pavkovic_url, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_name =</span> <span class="st">&quot;fa_raw_counts.tsv.gz&quot;</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">local_folder =</span> pavkovic_data_folder)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the expresdsion table</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Loading FA transcriptome data from</span><span class="sc">\n\t</span><span class="st">&quot;</span>, fa_expr_file)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>fa_expr_raw <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="at">file =</span> fa_expr_file, </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">header =</span> <span class="cn">TRUE</span>, </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Download the metadata file</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Downloading FA metadata file</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="st">&quot;fa_transcriptome_metadata.tsv&quot;</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;</span><span class="sc">\n\t</span><span class="st">from</span><span class="sc">\t</span><span class="st">&quot;</span>, pavkovic_url)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>fa_meta_file <span class="ot">&lt;-</span> <span class="fu">download_only_once</span>(</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">url_base =</span> pavkovic_url, </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">file_name =</span> <span class="st">&quot;fa_transcriptome_metadata.tsv&quot;</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">local_folder =</span> pavkovic_data_folder)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Load the metadata</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Loading FA metadata from</span><span class="sc">\n\t</span><span class="st">&quot;</span>, fa_meta_file)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>fa_meta <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="at">file =</span> fa_meta_file, </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">header =</span> <span class="cn">TRUE</span>, </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">row.names =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Nous regardons la structure de chaque dataframe.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fa_expr_raw)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   46679 obs. of  18 variables:
 $ day1_1  : num  2278.8 0 36.3 13.2 0 ...
 $ day1_2  : num  1786.5 0 22.15 7.15 27.9 ...
 $ day1_3  : num  2368.62 0 39.48 1.12 6.9 ...
 $ day14_1 : num  627.758 0 14.471 0.867 5.692 ...
 $ day14_2 : num  559.2 0 10.2 0 1.9 ...
 $ day14_3 : num  611.434 0 31.691 0 0.655 ...
 $ day2_1  : num  2145.22 0 300.56 1.71 57.38 ...
 $ day2_2  : num  262.45 0 4.77 0 0 ...
 $ day2_3  : num  745.84 0 123.9 5.26 38.9 ...
 $ day3_1  : num  987.185 0 51.856 0.802 8.931 ...
 $ day3_2  : num  1077.65 0 8.43 0 6.97 ...
 $ day3_3  : num  1335.1 0 69.9 0 0 ...
 $ day7_1  : num  1096.08 0 6.67 0 7.94 ...
 $ day7_2  : num  1035.846 0 6.955 0.849 101.648 ...
 $ day7_3  : num  1090.04 0 42.58 1.71 0.65 ...
 $ normal_1: num  483.23 0 7.35 0.86 32.06 ...
 $ normal_2: num  1842.1 0 11.2 0 10.4 ...
 $ normal_3: num  475.7 0 1.03 0 0 ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fa_meta)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   18 obs. of  5 variables:
 $ dataType    : chr  &quot;transcriptome&quot; &quot;transcriptome&quot; &quot;transcriptome&quot; &quot;transcriptome&quot; ...
 $ sampleName  : chr  &quot;day14_1&quot; &quot;day14_2&quot; &quot;day14_3&quot; &quot;day1_1&quot; ...
 $ condition   : chr  &quot;day14&quot; &quot;day14&quot; &quot;day14&quot; &quot;day1&quot; ...
 $ sampleNumber: int  1 2 3 1 2 3 1 2 3 1 ...
 $ color       : chr  &quot;#FF4400&quot; &quot;#FF4400&quot; &quot;#FF4400&quot; &quot;#BBD7FF&quot; ...</code></pre>
<p>Les deux fichiers ne donnent pas les observations de l’échantillon dans le même ordre:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fa_meta<span class="sc">$</span>sampleName <span class="sc">==</span> <span class="fu">names</span>(fa_expr_raw)</span></code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>Nous les réorganisons les échantillons dans l’ordre de l’expérience: condition normale, puis day 1 à 14 avec les 3 réplicats.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sample_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>, <span class="st">&quot;day1&quot;</span>, <span class="st">&quot;day2&quot;</span>, <span class="st">&quot;day3&quot;</span>, <span class="st">&quot;day7&quot;</span>, <span class="st">&quot;day14&quot;</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fa_expr_raw <span class="ot">&lt;-</span> fa_expr_raw[,sample_order]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>fa_meta <span class="ot">&lt;-</span> fa_meta[<span class="fu">match</span>(sample_order, fa_meta<span class="sc">$</span>sampleName),]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View(fa_meta)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fa_meta, <span class="at">caption =</span> <span class="st">&quot;Metdata for Pavkovoc FA transcriptome&quot;</span>)</span></code></pre></div>
<table>
<caption>Metdata for Pavkovoc FA transcriptome</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">dataType</th>
<th align="left">sampleName</th>
<th align="left">condition</th>
<th align="right">sampleNumber</th>
<th align="left">color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">16</td>
<td align="left">transcriptome</td>
<td align="left">normal_1</td>
<td align="left">normal</td>
<td align="right">1</td>
<td align="left">#BBFFBB</td>
</tr>
<tr class="even">
<td align="left">17</td>
<td align="left">transcriptome</td>
<td align="left">normal_2</td>
<td align="left">normal</td>
<td align="right">2</td>
<td align="left">#BBFFBB</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="left">transcriptome</td>
<td align="left">normal_3</td>
<td align="left">normal</td>
<td align="right">3</td>
<td align="left">#BBFFBB</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">transcriptome</td>
<td align="left">day1_1</td>
<td align="left">day1</td>
<td align="right">1</td>
<td align="left">#BBD7FF</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">transcriptome</td>
<td align="left">day1_2</td>
<td align="left">day1</td>
<td align="right">2</td>
<td align="left">#BBD7FF</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">transcriptome</td>
<td align="left">day1_3</td>
<td align="left">day1</td>
<td align="right">3</td>
<td align="left">#BBD7FF</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">transcriptome</td>
<td align="left">day2_1</td>
<td align="left">day2</td>
<td align="right">1</td>
<td align="left">#F0BBFF</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">transcriptome</td>
<td align="left">day2_2</td>
<td align="left">day2</td>
<td align="right">2</td>
<td align="left">#F0BBFF</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">transcriptome</td>
<td align="left">day2_3</td>
<td align="left">day2</td>
<td align="right">3</td>
<td align="left">#F0BBFF</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">transcriptome</td>
<td align="left">day3_1</td>
<td align="left">day3</td>
<td align="right">1</td>
<td align="left">#FFFFDD</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">transcriptome</td>
<td align="left">day3_2</td>
<td align="left">day3</td>
<td align="right">2</td>
<td align="left">#FFFFDD</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">transcriptome</td>
<td align="left">day3_3</td>
<td align="left">day3</td>
<td align="right">3</td>
<td align="left">#FFFFDD</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">transcriptome</td>
<td align="left">day7_1</td>
<td align="left">day7</td>
<td align="right">1</td>
<td align="left">#FFDD88</td>
</tr>
<tr class="even">
<td align="left">14</td>
<td align="left">transcriptome</td>
<td align="left">day7_2</td>
<td align="left">day7</td>
<td align="right">2</td>
<td align="left">#FFDD88</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">transcriptome</td>
<td align="left">day7_3</td>
<td align="left">day7</td>
<td align="right">3</td>
<td align="left">#FFDD88</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">transcriptome</td>
<td align="left">day14_1</td>
<td align="left">day14</td>
<td align="right">1</td>
<td align="left">#FF4400</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">transcriptome</td>
<td align="left">day14_2</td>
<td align="left">day14</td>
<td align="right">2</td>
<td align="left">#FF4400</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">transcriptome</td>
<td align="left">day14_3</td>
<td align="left">day14</td>
<td align="right">3</td>
<td align="left">#FF4400</td>
</tr>
</tbody>
</table>
<p>=&gt; Ainsi, nous avons un jeu de données avec un échantillon de 18 observations et des données d’expression de 46679 gènes.</p>
</div>
<div id="statistiques-descriptives" class="section level3">
<h3>Statistiques descriptives</h3>
<p>Dans le tutorial sur les dataframes sur le jeu de données “uuo” (relisez le corrigé), nous vous avons demandé de créer un data.frame qui collecte les statistiques par gène et par échantillon. Nous vous demandons de réaliser une étude similaire sur les données “FA” avant et après normalisation inter-échantillons des données. Le code de la partie avant normalisation est donné.</p>
<div id="par-échantillon-avant-normalisation" class="section level4">
<h4>Par échantillon avant normalisation</h4>
<p>Nous créons un data.frame nommé <code>sample_stat_prenorm</code> qui comporte une ligne par échantillon et une colonne par statistique. Nous calculons les statistiques suivantes sur les valeurs log2 d’expression de chaque échantillon:</p>
<ul>
<li>moyenne</li>
<li>écart-type</li>
<li>intervalle inter-quartiles</li>
<li>premier quartile</li>
<li>médiane</li>
<li>troisième quartile</li>
<li>maximum</li>
<li>nombre de valeurs nulles</li>
</ul>
<p>Il est affiché avec la fonction <code>kable()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Computing sample-wise statistics on raw counts&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sample_stat_prenorm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">2</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">2</span>, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iqr =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">2</span>, IQR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q1 =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">2</span>, quantile, <span class="at">p =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">2</span>, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q3 =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">2</span>, quantile, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">2</span>, max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">null =</span> <span class="fu">apply</span>(fa_expr_raw <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">2</span>, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(sample_stat_prenorm, <span class="at">caption =</span> <span class="st">&quot;Sample-wise statistics before normalisation.&quot;</span>)</span></code></pre></div>
<table>
<caption>Sample-wise statistics before normalisation.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">iqr</th>
<th align="right">Q1</th>
<th align="right">median</th>
<th align="right">Q3</th>
<th align="right">max</th>
<th align="right">null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">normal_1</td>
<td align="right">576.2992</td>
<td align="right">57643.81</td>
<td align="right">46.38417</td>
<td align="right">0</td>
<td align="right">1.166694</td>
<td align="right">46.38417</td>
<td align="right">11777395</td>
<td align="right">21415</td>
</tr>
<tr class="even">
<td align="left">normal_2</td>
<td align="right">1172.5615</td>
<td align="right">111509.82</td>
<td align="right">103.13749</td>
<td align="right">0</td>
<td align="right">2.975840</td>
<td align="right">103.13749</td>
<td align="right">22658521</td>
<td align="right">20203</td>
</tr>
<tr class="odd">
<td align="left">normal_3</td>
<td align="right">531.8620</td>
<td align="right">57203.96</td>
<td align="right">41.80724</td>
<td align="right">0</td>
<td align="right">1.081680</td>
<td align="right">41.80724</td>
<td align="right">11636735</td>
<td align="right">21660</td>
</tr>
<tr class="even">
<td align="left">day1_1</td>
<td align="right">663.0580</td>
<td align="right">65219.36</td>
<td align="right">58.76393</td>
<td align="right">0</td>
<td align="right">1.105540</td>
<td align="right">58.76393</td>
<td align="right">13174979</td>
<td align="right">21700</td>
</tr>
<tr class="odd">
<td align="left">day1_2</td>
<td align="right">1224.5149</td>
<td align="right">123140.72</td>
<td align="right">111.71166</td>
<td align="right">0</td>
<td align="right">3.053561</td>
<td align="right">111.71166</td>
<td align="right">25118595</td>
<td align="right">20152</td>
</tr>
<tr class="even">
<td align="left">day1_3</td>
<td align="right">1368.6144</td>
<td align="right">133450.04</td>
<td align="right">122.38187</td>
<td align="right">0</td>
<td align="right">3.766666</td>
<td align="right">122.38187</td>
<td align="right">27255572</td>
<td align="right">19621</td>
</tr>
<tr class="odd">
<td align="left">day2_1</td>
<td align="right">1161.7628</td>
<td align="right">103598.87</td>
<td align="right">127.04744</td>
<td align="right">0</td>
<td align="right">3.501480</td>
<td align="right">127.04744</td>
<td align="right">21036079</td>
<td align="right">19978</td>
</tr>
<tr class="even">
<td align="left">day2_2</td>
<td align="right">223.8844</td>
<td align="right">20431.97</td>
<td align="right">14.54242</td>
<td align="right">0</td>
<td align="right">0.000000</td>
<td align="right">14.54242</td>
<td align="right">4037963</td>
<td align="right">24446</td>
</tr>
<tr class="odd">
<td align="left">day2_3</td>
<td align="right">628.4406</td>
<td align="right">57480.66</td>
<td align="right">63.36112</td>
<td align="right">0</td>
<td align="right">1.478198</td>
<td align="right">63.36112</td>
<td align="right">11662570</td>
<td align="right">21455</td>
</tr>
<tr class="even">
<td align="left">day3_1</td>
<td align="right">649.8389</td>
<td align="right">55210.88</td>
<td align="right">77.84371</td>
<td align="right">0</td>
<td align="right">2.076066</td>
<td align="right">77.84371</td>
<td align="right">11170233</td>
<td align="right">20772</td>
</tr>
<tr class="odd">
<td align="left">day3_2</td>
<td align="right">514.8649</td>
<td align="right">42768.34</td>
<td align="right">74.16479</td>
<td align="right">0</td>
<td align="right">1.941705</td>
<td align="right">74.16479</td>
<td align="right">8612320</td>
<td align="right">21142</td>
</tr>
<tr class="even">
<td align="left">day3_3</td>
<td align="right">854.0997</td>
<td align="right">80565.29</td>
<td align="right">104.95124</td>
<td align="right">0</td>
<td align="right">2.975772</td>
<td align="right">104.95124</td>
<td align="right">16484449</td>
<td align="right">20287</td>
</tr>
<tr class="odd">
<td align="left">day7_1</td>
<td align="right">576.2437</td>
<td align="right">53112.82</td>
<td align="right">90.51017</td>
<td align="right">0</td>
<td align="right">2.256164</td>
<td align="right">90.51017</td>
<td align="right">10690493</td>
<td align="right">20865</td>
</tr>
<tr class="even">
<td align="left">day7_2</td>
<td align="right">510.2741</td>
<td align="right">47373.18</td>
<td align="right">80.57478</td>
<td align="right">0</td>
<td align="right">2.537673</td>
<td align="right">80.57478</td>
<td align="right">9682527</td>
<td align="right">20467</td>
</tr>
<tr class="odd">
<td align="left">day7_3</td>
<td align="right">604.9701</td>
<td align="right">59072.56</td>
<td align="right">83.50019</td>
<td align="right">0</td>
<td align="right">2.874706</td>
<td align="right">83.50019</td>
<td align="right">12164986</td>
<td align="right">20045</td>
</tr>
<tr class="even">
<td align="left">day14_1</td>
<td align="right">540.2640</td>
<td align="right">54481.09</td>
<td align="right">65.01270</td>
<td align="right">0</td>
<td align="right">2.025707</td>
<td align="right">65.01270</td>
<td align="right">11178198</td>
<td align="right">20496</td>
</tr>
<tr class="odd">
<td align="left">day14_2</td>
<td align="right">681.9987</td>
<td align="right">74825.35</td>
<td align="right">69.05744</td>
<td align="right">0</td>
<td align="right">2.032894</td>
<td align="right">69.05744</td>
<td align="right">15430799</td>
<td align="right">20870</td>
</tr>
<tr class="even">
<td align="left">day14_3</td>
<td align="right">562.5697</td>
<td align="right">56026.62</td>
<td align="right">75.11681</td>
<td align="right">0</td>
<td align="right">2.247271</td>
<td align="right">75.11681</td>
<td align="right">11575718</td>
<td align="right">20396</td>
</tr>
</tbody>
</table>
</div>
<div id="par-gène-avant-normalisation" class="section level4">
<h4>Par gène avant normalisation</h4>
<p>Nous créons ci-dessous un data.frame nommé <code>gene_stat_prenorm</code> qui comporte une ligne par gène et une colonne par statistique. Nous calculons les statistiques suivantes sur les valeurs log2 de chaque gène.</p>
<ul>
<li>moyenne</li>
<li>médiane</li>
<li>écart-type</li>
<li>premier quartile</li>
<li>troisième quartile</li>
<li>maximum</li>
<li>nombre de valeurs nulles</li>
<li>intervalle inter-quartiles</li>
</ul>
<p>Ces résultats sont stockés dans un data.frame avec 1 ligne par échantillon et 1 colonne par statistique. Nous affichons les lignes 100 à 109 de ce tableau de statistiques avec la fonction <code>kable()</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gene-wise statistics for the raw counts (will be used for normalisation)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Computing gene-wise statistics on raw counts&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>gene_stat_prenorm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">1</span>, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">1</span>, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">iqr =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">1</span>, IQR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q1 =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">1</span>, quantile, <span class="at">p =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">1</span>, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q3 =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">1</span>, quantile, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fu">apply</span>(fa_expr_raw, <span class="dv">1</span>, max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">null =</span> <span class="fu">apply</span>(fa_expr_raw <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(gene_stat_prenorm[<span class="dv">100</span><span class="sc">:</span><span class="dv">109</span>, ], <span class="at">caption =</span> <span class="st">&quot;Gene-wise statistics before normalisation&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption>Gene-wise statistics before normalisation</caption>
<colgroup>
<col width="17%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="10%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">iqr</th>
<th align="right">Q1</th>
<th align="right">median</th>
<th align="right">Q3</th>
<th align="right">max</th>
<th align="right">null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSMUSG00000000567</td>
<td align="right">320.336744</td>
<td align="right">286.399084</td>
<td align="right">364.362298</td>
<td align="right">91.046357</td>
<td align="right">261.659973</td>
<td align="right">455.40866</td>
<td align="right">1052.68945</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000568</td>
<td align="right">857.348825</td>
<td align="right">694.432189</td>
<td align="right">282.978949</td>
<td align="right">575.571199</td>
<td align="right">711.096105</td>
<td align="right">858.55015</td>
<td align="right">3406.45030</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000579</td>
<td align="right">422.075702</td>
<td align="right">162.290415</td>
<td align="right">157.732606</td>
<td align="right">340.417017</td>
<td align="right">447.572742</td>
<td align="right">498.14962</td>
<td align="right">728.51737</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000581</td>
<td align="right">498.978227</td>
<td align="right">248.612029</td>
<td align="right">259.324338</td>
<td align="right">320.599085</td>
<td align="right">471.269224</td>
<td align="right">579.92342</td>
<td align="right">942.51104</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000594</td>
<td align="right">2113.558334</td>
<td align="right">1237.521694</td>
<td align="right">937.571105</td>
<td align="right">1400.226182</td>
<td align="right">1868.718762</td>
<td align="right">2337.79729</td>
<td align="right">6408.96044</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000600</td>
<td align="right">2299.978163</td>
<td align="right">911.222891</td>
<td align="right">1480.192582</td>
<td align="right">1719.874980</td>
<td align="right">2093.572929</td>
<td align="right">3200.06756</td>
<td align="right">3674.18811</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000605</td>
<td align="right">325.552118</td>
<td align="right">169.456624</td>
<td align="right">195.879561</td>
<td align="right">221.735904</td>
<td align="right">282.608205</td>
<td align="right">417.61546</td>
<td align="right">791.31256</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000606</td>
<td align="right">9.929258</td>
<td align="right">32.151350</td>
<td align="right">2.736779</td>
<td align="right">1.178311</td>
<td align="right">1.934744</td>
<td align="right">3.91509</td>
<td align="right">138.48677</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000617</td>
<td align="right">18.804116</td>
<td align="right">9.470819</td>
<td align="right">13.654701</td>
<td align="right">12.188276</td>
<td align="right">18.150391</td>
<td align="right">25.84298</td>
<td align="right">36.00235</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000627</td>
<td align="right">15.623306</td>
<td align="right">14.341852</td>
<td align="right">12.308127</td>
<td align="right">4.780913</td>
<td align="right">10.064895</td>
<td align="right">17.08904</td>
<td align="right">46.29752</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="filtrage-et-normalisation-des-données" class="section level2">
<h2>2. Filtrage et normalisation des données</h2>
<p><strong><em>Vous n’avez rien à coder ici. Le code est fourni.</em></strong></p>
<p>Il existe plusieurs façons de normaliser les données de transcriptome vues dans les modules 4 et 5 (cf. total counts, quantiles, TMM, RLE, limma voom,…), mais nous avons choisi ici une solution simple tout en étant robuste pour normaliser les données en standardisant le 3ème quantile.</p>
<p>La méthode choisie ici consiste à :</p>
<ol style="list-style-type: decimal">
<li><p><strong>Ecarter les gènes “non-détectés”</strong>, c’est-à-dire ceux ayant des valeurs nulles dans au moins 90% des échantillons.</p></li>
<li><p><strong>Ecarter les gènes à peine exprimés</strong>, c’est-à-dire ceux ayant une valeur moyenne &lt; 10 (arbitrairement).</p></li>
<li><p><strong>Standardiser les échantillons </strong>sur le 3ème quartile des gènes restants: on divise les comptages bruts par le 3ème quartile de l’échantillon et on multiplie par le 3ème quartile de l’ensemble des échantillons.</p></li>
<li><p><strong>Normaliser les comptages</strong> (au sens propre, c’est-à-dire rapprocher leur distribution de la distribution gaussienne) par une transformation logarithmique (log2).</p></li>
</ol>
<p>Nous fournissons ci-dessous le code.</p>
<div id="filtrage-élimination-des-gènes-non-détectés-ou-à-peine-exprimés" class="section level3">
<h3>Filtrage : élimination des gènes non détectés ou à peine exprimés</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data filtering: genes having at least 90% null values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Filtering undetected genes&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>undetected_genes <span class="ot">&lt;-</span> gene_stat_prenorm<span class="sc">$</span>null <span class="sc">&gt;=</span> <span class="fu">ncol</span>(fa_expr_raw) <span class="sc">*</span> <span class="fl">0.9</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Undetected genes (null in &gt;= 90% samples): &quot;</span>, <span class="fu">sum</span>(undetected_genes)))</span></code></pre></div>
<pre><code>[1] &quot;Undetected genes (null in &gt;= 90% samples): 14380&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data filtering: genes having a mean expression &lt; 10</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Filtering barely expressed genes&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>barely_expressed_genes <span class="ot">&lt;-</span> gene_stat_prenorm<span class="sc">$</span>mean <span class="sc">&lt;</span> <span class="dv">10</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Barely expressed genes (mean &lt; 10): &quot;</span>, <span class="fu">sum</span>(barely_expressed_genes)))</span></code></pre></div>
<pre><code>[1] &quot;Barely expressed genes (mean &lt; 10): 26286&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Apply filtering on both criteria</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>discarded_genes <span class="ot">&lt;-</span> undetected_genes <span class="sc">|</span> barely_expressed_genes</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Discarded genes: &quot;</span>, <span class="fu">sum</span>(discarded_genes)))</span></code></pre></div>
<pre><code>[1] &quot;Discarded genes: 26288&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>kept_genes <span class="ot">&lt;-</span> <span class="sc">!</span>discarded_genes</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Kept genes: &quot;</span>, <span class="fu">sum</span>(kept_genes)))</span></code></pre></div>
<pre><code>[1] &quot;Kept genes: 20391&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Genes after filtering</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fa_expr_filtered <span class="ot">&lt;-</span> fa_expr_raw[kept_genes, ]</span></code></pre></div>
</div>
<div id="standardisation-entre-échantillons" class="section level3">
<h3>Standardisation entre échantillons</h3>
<p>Nous appliquons ici une méthode simple mais efficace de standardisation</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Inter-sample standardisation on the Q3 of raw counts ####</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>total_q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">unlist</span>(fa_expr_filtered), <span class="at">probs =</span> <span class="fl">0.75</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>sample_stat_prenorm<span class="sc">$</span>Q3_filterd <span class="ot">&lt;-</span> <span class="fu">apply</span>(fa_expr_filtered, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fl">0.75</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>sample_stat_prenorm<span class="sc">$</span>scale_factor <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> sample_stat_prenorm<span class="sc">$</span>Q3_filterd <span class="sc">*</span> total_q3</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Apply standardisation</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>fa_expr_standard <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(fa_expr_filtered) <span class="sc">*</span> <span class="fu">unlist</span>(sample_stat_prenorm<span class="sc">$</span>scale_factor))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Check 3rd quantile after standardisation</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">apply</span>(fa_expr_standard, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fl">0.75</span>), </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="st">&quot;Q3_standardised&quot;</span>, </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Third quartile of the filtered counts after inter-sample standardisation of the third quartiles. &quot;</span>)</span></code></pre></div>
<table>
<caption>Third quartile of the filtered counts after inter-sample standardisation of the third quartiles.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Q3_standardised</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">normal_1</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">normal_2</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">normal_3</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day1_1</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">day1_2</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day1_3</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">day2_1</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day2_2</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">day2_3</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day3_1</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">day3_2</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day3_3</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">day7_1</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day7_2</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">day7_3</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day14_1</td>
<td align="right">364.9332</td>
</tr>
<tr class="odd">
<td align="left">day14_2</td>
<td align="right">364.9332</td>
</tr>
<tr class="even">
<td align="left">day14_3</td>
<td align="right">364.9332</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot(fa_expr_standard, horizontal = TRUE)</span></span></code></pre></div>
</div>
<div id="transformation-log2" class="section level3">
<h3>Transformation log2</h3>
<p>Nous appliquons une transformation en log2 des données brutes, après avoir ajouté un epsilon <span class="math inline">\(\epsilon = 1\)</span> (les valeurs nulles seront donc représentées par un log2(counts) valant <span class="math inline">\(0\)</span>. Nous stockons le résultat dans un data.frame nommé <code>fa_expr_log2</code>.</p>
<p>Nous affichons un fragment des tableaux <code>fa_expr_raw</code> et <code>fa_expr_log2</code> en sélectionnant les lignes 100 à 109 et les colonnes 5 à 10, afin de nous assurer que la transformation en log2 a bien fonctionné.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Log2 transformation of the transcriptome data</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>fa_expr_log2 <span class="ot">&lt;-</span> <span class="fu">log2</span>(fa_expr_standard <span class="sc">+</span> epsilon)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(fa_expr_log2)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View(head(fa_expr_log2))</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Display of a fragment of the data before and after log2 transformation</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fa_expr_raw[<span class="dv">100</span><span class="sc">:</span><span class="dv">109</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">caption =</span> <span class="st">&quot;Fragment des données transcriptomiques brutes&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption>Fragment des données transcriptomiques brutes</caption>
<colgroup>
<col width="21%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">day1_2</th>
<th align="right">day1_3</th>
<th align="right">day2_1</th>
<th align="right">day2_2</th>
<th align="right">day2_3</th>
<th align="right">day3_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSMUSG00000000567</td>
<td align="right">599.648075</td>
<td align="right">304.093177</td>
<td align="right">1052.689447</td>
<td align="right">106.995584</td>
<td align="right">347.13842</td>
<td align="right">479.59911</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000568</td>
<td align="right">1008.026306</td>
<td align="right">1349.126716</td>
<td align="right">818.257157</td>
<td align="right">116.136417</td>
<td align="right">3406.45030</td>
<td align="right">766.09722</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000579</td>
<td align="right">599.832586</td>
<td align="right">500.735597</td>
<td align="right">473.399472</td>
<td align="right">36.258005</td>
<td align="right">410.57787</td>
<td align="right">347.05054</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000581</td>
<td align="right">942.511039</td>
<td align="right">744.646735</td>
<td align="right">546.260344</td>
<td align="right">87.788535</td>
<td align="right">319.12679</td>
<td align="right">461.45732</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000594</td>
<td align="right">3063.845705</td>
<td align="right">2743.404374</td>
<td align="right">2283.051270</td>
<td align="right">1115.588250</td>
<td align="right">1491.61384</td>
<td align="right">1576.68451</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000600</td>
<td align="right">3341.854530</td>
<td align="right">3561.805180</td>
<td align="right">3674.188108</td>
<td align="right">589.840068</td>
<td align="right">1399.10751</td>
<td align="right">3446.01856</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000605</td>
<td align="right">791.312561</td>
<td align="right">558.710943</td>
<td align="right">489.579657</td>
<td align="right">77.008213</td>
<td align="right">256.00200</td>
<td align="right">282.80077</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000606</td>
<td align="right">4.785252</td>
<td align="right">6.566374</td>
<td align="right">3.970399</td>
<td align="right">0.000000</td>
<td align="right">138.48677</td>
<td align="right">0.00000</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000617</td>
<td align="right">15.839486</td>
<td align="right">29.138902</td>
<td align="right">30.228506</td>
<td align="right">6.670500</td>
<td align="right">18.27493</td>
<td align="right">13.41152</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000627</td>
<td align="right">36.673777</td>
<td align="right">35.967747</td>
<td align="right">46.297517</td>
<td align="right">2.878275</td>
<td align="right">17.03638</td>
<td align="right">15.45854</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fa_expr_log2[<span class="dv">100</span><span class="sc">:</span><span class="dv">109</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">caption =</span> <span class="st">&quot;Fragment des données transcriptomiques après transformation log2&quot;</span>)</span></code></pre></div>
<table>
<caption>Fragment des données transcriptomiques après transformation log2</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">day1_2</th>
<th align="right">day1_3</th>
<th align="right">day2_1</th>
<th align="right">day2_2</th>
<th align="right">day2_3</th>
<th align="right">day3_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSMUSG00000000711</td>
<td align="right">9.709367</td>
<td align="right">9.861557</td>
<td align="right">9.287726</td>
<td align="right">12.335149</td>
<td align="right">9.755002</td>
<td align="right">10.013232</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000724</td>
<td align="right">5.904466</td>
<td align="right">6.218882</td>
<td align="right">4.464461</td>
<td align="right">5.782181</td>
<td align="right">5.701477</td>
<td align="right">5.803482</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000731</td>
<td align="right">5.203571</td>
<td align="right">5.404039</td>
<td align="right">4.963615</td>
<td align="right">5.970908</td>
<td align="right">4.299021</td>
<td align="right">4.505637</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000732</td>
<td align="right">5.398925</td>
<td align="right">8.209062</td>
<td align="right">2.126857</td>
<td align="right">3.751910</td>
<td align="right">6.948597</td>
<td align="right">4.970987</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000738</td>
<td align="right">8.520431</td>
<td align="right">8.430289</td>
<td align="right">8.263532</td>
<td align="right">7.909466</td>
<td align="right">8.250468</td>
<td align="right">7.455809</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000740</td>
<td align="right">11.228789</td>
<td align="right">11.320488</td>
<td align="right">11.117466</td>
<td align="right">10.630164</td>
<td align="right">11.595716</td>
<td align="right">10.156658</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000743</td>
<td align="right">7.882486</td>
<td align="right">7.268069</td>
<td align="right">8.646853</td>
<td align="right">10.469226</td>
<td align="right">6.135917</td>
<td align="right">7.385994</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000751</td>
<td align="right">7.302103</td>
<td align="right">8.404643</td>
<td align="right">7.851161</td>
<td align="right">6.677037</td>
<td align="right">8.189071</td>
<td align="right">7.123055</td>
</tr>
<tr class="odd">
<td align="left">ENSMUSG00000000753</td>
<td align="right">0.000000</td>
<td align="right">2.885227</td>
<td align="right">2.310527</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">4.605696</td>
</tr>
<tr class="even">
<td align="left">ENSMUSG00000000759</td>
<td align="right">8.296064</td>
<td align="right">8.620921</td>
<td align="right">7.830522</td>
<td align="right">9.377892</td>
<td align="right">9.333861</td>
<td align="right">10.038888</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="statistiques-descriptives-sur-les-données-normalisées" class="section level2">
<h2>3. Statistiques descriptives sur les données normalisées</h2>
<p><strong><em>A vous de jouer!</em></strong></p>
<div id="statistiques-par-gène-après-normalisation" class="section level3">
<h3>Statistiques par gène après normalisation</h3>
<p>Générez un data.frame nommée <code>gene_stat_norm</code> avec une ligne par gène à partir du tableau de données normalisées, avec les statistiques suivantes (une statistique par colonne):</p>
<ul>
<li>moyenne</li>
<li>variance</li>
<li>écart-type</li>
<li>coefficient de variation (écart-type divisé par la moyenne)</li>
<li>intervalle inter-quartiles</li>
<li>minimum</li>
<li>médiane</li>
<li>maximum</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Gene-wise statistics after normalisation</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Computing gene-wise statistics on log2-transformed and normalised counts&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>gene_stat_norm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, mean, <span class="at">na.rm =</span> F),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, var, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, sd, <span class="at">na.rm =</span> F),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">CV =</span> <span class="cn">NA</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">min =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q1 =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, quantile, <span class="at">p =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q3 =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, quantile, <span class="at">p =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">max =</span> <span class="fu">apply</span>(fa_expr_log2, <span class="dv">1</span>, max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">null =</span> <span class="fu">apply</span>(fa_expr_log2 <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>gene_stat_norm<span class="sc">$</span>CV <span class="ot">&lt;-</span> gene_stat_norm<span class="sc">$</span>sd <span class="sc">/</span> gene_stat_norm<span class="sc">$</span>mean</span></code></pre></div>
</div>
<div id="annotation-des-gènes" class="section level3">
<h3>Annotation des gènes</h3>
<p>Chaque gène étant donné par son identifiant dans la base de données ENSEMBL vous utiliserez le <code>paquet biomaRt de bioconductor</code> pour ajouter des annotations : symbole, chromosome, coordonnées génomiques, brin. Suivez pas à pas la méthode proposée (<strong><em>certaines étapes peuvent prendre quelques minutes</em></strong>):</p>
<ul>
<li><p>chargez le paquet biomaRt, voire installer-le uniquement si nécessaire. Indiquez le code à l’emplacement adéquat dans de .Rmd.</p></li>
<li><p>sélectionnez la base de données ENSEMBL avec la fonction <code>useMart()</code>. Attention à choisir le bon génome avec l’agument <code>dataset</code>: <code>mmusculus_gene_ensembl</code></p></li>
<li><p>avec la fonction <code>getBM()</code> récupérez de la base de données ENSEMBL les champs demandés (<strong><em>pour symbole utilisez external_gene_name</em></strong>) en appliquant “ensembl_geneid” pour l’agument <code>filter</code> et en indiquant pour l’argument <code>values</code> le vecteur des identifiants des gènes présents dans le dataframe <code>gene_stat_norm</code>. Vous obtenez un dataframe.</p></li>
</ul>
<p>A présent, ajoutez au dataframe <code>gene_stat_norm</code> en 1ères colonnes les annotations retrouvées grâce à biomaRt. Attention, certains gènes ne sont pas retrouvés dans la version d’ENSEMBL sur biomaRt donc laissez des NA comme données manquantes dans ce cas. Nous vous recommandons d’utiliser la function <code>merge()</code> de R base ou bien <code>left_join()</code> de <code>dplyr</code> pour fusionner les deux dataframes en un seul.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Gene annotations ####</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Getting gene annotations&quot;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Open a connection to Ensembl MART</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Opening connection to Ensembl MART&quot;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ensembl <span class="ot">&lt;-</span> <span class="fu">useMart</span>(<span class="st">&quot;ENSEMBL_MART_ENSEMBL&quot;</span>, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">host =</span> <span class="st">&quot;www.ensembl.org&quot;</span>, </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dataset =</span> <span class="st">&quot;mmusculus_gene_ensembl&quot;</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Get gene annotations</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Getting gene annotations&quot;</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">getBM</span>(<span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>, </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;external_gene_name&quot;</span>, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;chromosome_name&quot;</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;start_position&quot;</span>, </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;end_position&quot;</span>, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&quot;strand&quot;</span>), </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">filter =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>,</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">values =</span> <span class="fu">row.names</span>(gene_stat_norm),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">mart =</span> ensembl)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Merge gene annotations and expression statistics</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>gene_stat_norm <span class="ot">&lt;-</span> <span class="fu">merge</span>(genes, gene_stat_norm, <span class="at">by.x =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="at">by.y =</span> <span class="dv">0</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(gene_stat_norm[<span class="dv">100</span><span class="sc">:</span><span class="dv">109</span>, ], <span class="at">caption =</span> <span class="st">&quot;Gene-wise statistics after normalisation&quot;</span>)</span></code></pre></div>
<table>
<caption>Gene-wise statistics after normalisation</caption>
<colgroup>
<col width="2%" />
<col width="10%" />
<col width="10%" />
<col width="8%" />
<col width="7%" />
<col width="6%" />
<col width="3%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="2%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">ensembl_gene_id</th>
<th align="left">external_gene_name</th>
<th align="left">chromosome_name</th>
<th align="right">start_position</th>
<th align="right">end_position</th>
<th align="right">strand</th>
<th align="right">mean</th>
<th align="right">var</th>
<th align="right">sd</th>
<th align="right">CV</th>
<th align="right">min</th>
<th align="right">Q1</th>
<th align="right">median</th>
<th align="right">Q3</th>
<th align="right">max</th>
<th align="right">null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">100</td>
<td align="left">ENSMUSG00000000724</td>
<td align="left">Cryba1</td>
<td align="left">11</td>
<td align="right">77609441</td>
<td align="right">77616109</td>
<td align="right">-1</td>
<td align="right">5.626582</td>
<td align="right">0.1705859</td>
<td align="right">0.4130204</td>
<td align="right">0.0734052</td>
<td align="right">4.464461</td>
<td align="right">5.538287</td>
<td align="right">5.727916</td>
<td align="right">5.811976</td>
<td align="right">6.218882</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">101</td>
<td align="left">ENSMUSG00000000731</td>
<td align="left">Aire</td>
<td align="left">10</td>
<td align="right">77865856</td>
<td align="right">77879444</td>
<td align="right">-1</td>
<td align="right">4.971927</td>
<td align="right">0.5455394</td>
<td align="right">0.7386064</td>
<td align="right">0.1485554</td>
<td align="right">3.683158</td>
<td align="right">4.408713</td>
<td align="right">4.824454</td>
<td align="right">5.544155</td>
<td align="right">6.203856</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">102</td>
<td align="left">ENSMUSG00000000732</td>
<td align="left">Icosl</td>
<td align="left">10</td>
<td align="right">77905136</td>
<td align="right">77919747</td>
<td align="right">1</td>
<td align="right">5.590982</td>
<td align="right">2.3882878</td>
<td align="right">1.5454086</td>
<td align="right">0.2764109</td>
<td align="right">2.126857</td>
<td align="right">4.481178</td>
<td align="right">5.661715</td>
<td align="right">6.873853</td>
<td align="right">8.209062</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">103</td>
<td align="left">ENSMUSG00000000738</td>
<td align="left">Spg7</td>
<td align="left">8</td>
<td align="right">123789681</td>
<td align="right">123824499</td>
<td align="right">1</td>
<td align="right">8.442163</td>
<td align="right">0.2524164</td>
<td align="right">0.5024106</td>
<td align="right">0.0595121</td>
<td align="right">7.455809</td>
<td align="right">8.253734</td>
<td align="right">8.329340</td>
<td align="right">8.688826</td>
<td align="right">9.540606</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">104</td>
<td align="left">ENSMUSG00000000740</td>
<td align="left">Rpl13</td>
<td align="left">8</td>
<td align="right">123829089</td>
<td align="right">123831983</td>
<td align="right">1</td>
<td align="right">10.803785</td>
<td align="right">0.1537509</td>
<td align="right">0.3921108</td>
<td align="right">0.0362938</td>
<td align="right">10.156658</td>
<td align="right">10.482694</td>
<td align="right">10.757275</td>
<td align="right">11.102106</td>
<td align="right">11.595716</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">105</td>
<td align="left">ENSMUSG00000000743</td>
<td align="left">Chmp1a</td>
<td align="left">8</td>
<td align="right">123931003</td>
<td align="right">123939502</td>
<td align="right">-1</td>
<td align="right">7.595448</td>
<td align="right">1.0151685</td>
<td align="right">1.0075557</td>
<td align="right">0.1326526</td>
<td align="right">6.135917</td>
<td align="right">7.082244</td>
<td align="right">7.327031</td>
<td align="right">7.869670</td>
<td align="right">10.469226</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">106</td>
<td align="left">ENSMUSG00000000751</td>
<td align="left">Rpa1</td>
<td align="left">11</td>
<td align="right">75188992</td>
<td align="right">75239150</td>
<td align="right">-1</td>
<td align="right">7.397915</td>
<td align="right">0.4442613</td>
<td align="right">0.6665293</td>
<td align="right">0.0900969</td>
<td align="right">6.387679</td>
<td align="right">7.090223</td>
<td align="right">7.283686</td>
<td align="right">7.678846</td>
<td align="right">9.002489</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">107</td>
<td align="left">ENSMUSG00000000753</td>
<td align="left">Serpinf1</td>
<td align="left">11</td>
<td align="right">75300595</td>
<td align="right">75313527</td>
<td align="right">-1</td>
<td align="right">2.836140</td>
<td align="right">2.9644420</td>
<td align="right">1.7217555</td>
<td align="right">0.6070771</td>
<td align="right">0.000000</td>
<td align="right">2.396876</td>
<td align="right">3.152627</td>
<td align="right">3.911941</td>
<td align="right">5.192750</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">108</td>
<td align="left">ENSMUSG00000000759</td>
<td align="left">Tubgcp3</td>
<td align="left">8</td>
<td align="right">12664277</td>
<td align="right">12722248</td>
<td align="right">-1</td>
<td align="right">8.601708</td>
<td align="right">0.3046843</td>
<td align="right">0.5519821</td>
<td align="right">0.0641712</td>
<td align="right">7.830522</td>
<td align="right">8.295299</td>
<td align="right">8.491647</td>
<td align="right">8.777671</td>
<td align="right">10.038888</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">109</td>
<td align="left">ENSMUSG00000000766</td>
<td align="left">Oprm1</td>
<td align="left">10</td>
<td align="right">6708506</td>
<td align="right">6988198</td>
<td align="right">1</td>
<td align="right">5.394596</td>
<td align="right">0.4730648</td>
<td align="right">0.6877970</td>
<td align="right">0.1274974</td>
<td align="right">4.274766</td>
<td align="right">4.970935</td>
<td align="right">5.482138</td>
<td align="right">5.823714</td>
<td align="right">6.423173</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Challenge falcultatif:</strong></p>
<p>Réordonnez les gènes par position génomique et affichez les lignes 5 premières et 5 dernières lignes de ce tableau de statistiques.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Sorting genes by chromosome ####</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Sorting genes by chromosome&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>gene_stat_norm <span class="ot">&lt;-</span> gene_stat_norm[<span class="fu">order</span>(gene_stat_norm<span class="sc">$</span>chromosome_name, gene_stat_norm<span class="sc">$</span>start_position),]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(gene_stat_norm[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, (<span class="fu">nrow</span>(gene_stat_norm) <span class="sc">-</span> <span class="dv">4</span>)<span class="sc">:</span><span class="fu">nrow</span>(gene_stat_norm)), ], </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Gene-wise statistics after normalisation.&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption>Gene-wise statistics after normalisation.</caption>
<colgroup>
<col width="3%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="7%" />
<col width="6%" />
<col width="3%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="2%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">ensembl_gene_id</th>
<th align="left">external_gene_name</th>
<th align="left">chromosome_name</th>
<th align="right">start_position</th>
<th align="right">end_position</th>
<th align="right">strand</th>
<th align="right">mean</th>
<th align="right">var</th>
<th align="right">sd</th>
<th align="right">CV</th>
<th align="right">min</th>
<th align="right">Q1</th>
<th align="right">median</th>
<th align="right">Q3</th>
<th align="right">max</th>
<th align="right">null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">11991</td>
<td align="left">ENSMUSG00000051951</td>
<td align="left">Xkr4</td>
<td align="left">1</td>
<td align="right">3276124</td>
<td align="right">3741721</td>
<td align="right">-1</td>
<td align="right">4.816674</td>
<td align="right">1.3797317</td>
<td align="right">1.1746198</td>
<td align="right">0.2438653</td>
<td align="right">3.050184</td>
<td align="right">3.8778311</td>
<td align="right">4.595623</td>
<td align="right">5.920481</td>
<td align="right">6.681809</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">17939</td>
<td align="left">ENSMUSG00000103377</td>
<td align="left">Gm37180</td>
<td align="left">1</td>
<td align="right">3435954</td>
<td align="right">3438772</td>
<td align="right">-1</td>
<td align="right">2.314986</td>
<td align="right">3.8640118</td>
<td align="right">1.9657090</td>
<td align="right">0.8491235</td>
<td align="right">0.000000</td>
<td align="right">0.2545978</td>
<td align="right">1.867157</td>
<td align="right">3.944995</td>
<td align="right">5.763218</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">17870</td>
<td align="left">ENSMUSG00000103161</td>
<td align="left">Gm38148</td>
<td align="left">1</td>
<td align="right">3663115</td>
<td align="right">3666126</td>
<td align="right">-1</td>
<td align="right">7.001132</td>
<td align="right">0.2888639</td>
<td align="right">0.5374606</td>
<td align="right">0.0767677</td>
<td align="right">6.205841</td>
<td align="right">6.7474277</td>
<td align="right">6.968085</td>
<td align="right">7.099971</td>
<td align="right">8.836822</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">17551</td>
<td align="left">ENSMUSG00000102331</td>
<td align="left">Gm19938</td>
<td align="left">1</td>
<td align="right">3717532</td>
<td align="right">3729127</td>
<td align="right">-1</td>
<td align="right">4.758114</td>
<td align="right">0.5164249</td>
<td align="right">0.7186271</td>
<td align="right">0.1510319</td>
<td align="right">3.148896</td>
<td align="right">4.5492517</td>
<td align="right">4.705953</td>
<td align="right">4.958899</td>
<td align="right">6.622021</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">17647</td>
<td align="left">ENSMUSG00000102592</td>
<td align="left">Gm38385</td>
<td align="left">1</td>
<td align="right">3822233</td>
<td align="right">3824583</td>
<td align="right">1</td>
<td align="right">5.857219</td>
<td align="right">0.6559678</td>
<td align="right">0.8099184</td>
<td align="right">0.1382770</td>
<td align="right">4.936802</td>
<td align="right">5.4431809</td>
<td align="right">5.660493</td>
<td align="right">6.090937</td>
<td align="right">8.419961</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">17896</td>
<td align="left">ENSMUSG00000103234</td>
<td align="left">Gm37158</td>
<td align="left">Y</td>
<td align="right">16691330</td>
<td align="right">16697033</td>
<td align="right">-1</td>
<td align="right">11.614954</td>
<td align="right">0.0684014</td>
<td align="right">0.2615367</td>
<td align="right">0.0225172</td>
<td align="right">11.177028</td>
<td align="right">11.4540325</td>
<td align="right">11.578340</td>
<td align="right">11.809875</td>
<td align="right">12.029098</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">18295</td>
<td align="left">ENSMUSG00000104381</td>
<td align="left">Gm37032</td>
<td align="left">Y</td>
<td align="right">40144240</td>
<td align="right">40147214</td>
<td align="right">1</td>
<td align="right">2.843634</td>
<td align="right">3.3954691</td>
<td align="right">1.8426799</td>
<td align="right">0.6480018</td>
<td align="right">0.000000</td>
<td align="right">2.5433175</td>
<td align="right">2.750084</td>
<td align="right">3.709229</td>
<td align="right">7.490303</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">17372</td>
<td align="left">ENSMUSG00000101106</td>
<td align="left">Gm28819</td>
<td align="left">Y</td>
<td align="right">68997874</td>
<td align="right">69008469</td>
<td align="right">1</td>
<td align="right">2.632011</td>
<td align="right">2.8214389</td>
<td align="right">1.6797139</td>
<td align="right">0.6381865</td>
<td align="right">0.000000</td>
<td align="right">1.9046191</td>
<td align="right">2.541555</td>
<td align="right">3.459880</td>
<td align="right">6.808471</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">16671</td>
<td align="left">ENSMUSG00000096768</td>
<td align="left">Gm47283</td>
<td align="left">Y</td>
<td align="right">90796007</td>
<td align="right">90827734</td>
<td align="right">1</td>
<td align="right">8.521675</td>
<td align="right">0.7498239</td>
<td align="right">0.8659237</td>
<td align="right">0.1016143</td>
<td align="right">7.233887</td>
<td align="right">7.7544241</td>
<td align="right">8.522473</td>
<td align="right">9.115546</td>
<td align="right">10.184191</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">17213</td>
<td align="left">ENSMUSG00000099871</td>
<td align="left">Gm21742</td>
<td align="left">Y</td>
<td align="right">90848682</td>
<td align="right">90855309</td>
<td align="right">1</td>
<td align="right">2.180831</td>
<td align="right">3.7461715</td>
<td align="right">1.9355029</td>
<td align="right">0.8875070</td>
<td align="right">0.000000</td>
<td align="right">0.9486068</td>
<td align="right">1.718208</td>
<td align="right">3.165230</td>
<td align="right">6.461436</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
<div id="distribution-des-données" class="section level3">
<h3>Distribution des données</h3>
<ul>
<li>Dessinez sous forme d’un histogramme la distribution des valeurs après normalisation (tous échantillons confondus)</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">unlist</span>(fa_expr_log2), </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fu">max</span>(fa_expr_log2) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.25</span>),</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;log2(counts) after standardisation&quot;</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;number of genes after filtering&quot;</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#BBDDFF&quot;</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">las =</span> <span class="dv">1</span>, <span class="at">cex.axis =</span> <span class="fl">0.8</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;distribution after standardisation&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(fa_expr_log2), <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_fa_expr_norm_distrib-1.png" alt="Distribution of expression values (log2 counts) after gene filtering and standardisation on the sample-wise third-quartile of non-null values. The vertical line highlights the mean value. " width="70%" />
<p class="caption">
Distribution of expression values (log2 counts) after gene filtering and standardisation on the sample-wise third-quartile of non-null values. The vertical line highlights the mean value.
</p>
</div>
<ul>
<li>Dessinez un box plot par échantillon avant et après normalisation, et commentez la façon dont l’effet de la normalisation apparaît sur ces graphiques.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Box plots to show normalisation impact ####</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">1</span>)) <span class="do">## Set the margins</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fa_expr_raw, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;counts&quot;</span>, </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> fa_meta<span class="sc">$</span>color, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Raw counts, all genes&quot;</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fa_expr_filtered, </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;counts&quot;</span>, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> fa_meta<span class="sc">$</span>color, </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Raw counts, filtered genes&quot;</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fa_expr_standard, </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;counts&quot;</span>, </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> fa_meta<span class="sc">$</span>color, </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Standardised counts (sample Q3)&quot;</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fa_expr_log2, </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;log2(counts)&quot;</span>, </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> fa_meta<span class="sc">$</span>color, </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Normalised counts&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_boxplots_normalisation_impact-1.png" alt="Box plots showing the impact of normalisation" width="100%" />
<p class="caption">
Box plots showing the impact of normalisation
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
</div>
<div id="analyse-de-regroupement-des-données" class="section level2">
<h2>4. Analyse de regroupement des données</h2>
<p><strong><em>A vous de jouer!</em></strong></p>
<div id="sélection-de-gènes-dexpression-élevée-et-variable" class="section level3">
<h3>Sélection de gènes d’expression élevée et variable</h3>
<p>Pour réduire le nombre de gènes, nous allons écarter les gènes faiblement exprimés (log2 moyen inférieur à 4), et ne retenir que ceux qui montrent des variations importantes entre échantillons. Pour ce dernier critère, nous nous basons sur la variance.</p>
<!-- Sélectionnez les gènes ayant un niveau log2 moyen minimal supérieur à 3 ($m > 3$) et un coefficient de variation supérieur à 0.5 ($CV > 0.5$). Note: ces valeurs sont parfaitement arbitraires, elles ont été choisies pour obtenir un nombre raisonnable de gènes.  -->
<p>Sélectionnez les gènes ayant un niveau log2 moyen minimal supérieur à 5 (<span class="math inline">\(m &gt; 5\)</span>) et une variance supérieure à 2 (<span class="math inline">\(s^2 &gt; 2\)</span>). Note: ces valeurs sont parfaitement arbitraires, elles ont été choisies pour obtenir un nombre raisonnable de gènes.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Selection of a subset of genes with igh expression and variance ####</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Selecting genes with high expression and variance&quot;</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute a Boolean vector indicating whether each gene passes or not the expression level threshold</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>high_expression <span class="ot">&lt;-</span> gene_stat_norm<span class="sc">$</span>mean <span class="sc">&gt;</span> <span class="dv">5</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># table(high_expression) # count number of genes with high/weak expression</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute a Boolean vector indicating whether each gene passes or not the variance threshold</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>high_variance <span class="ot">&lt;-</span> gene_stat_norm<span class="sc">$</span>var <span class="sc">&gt;</span> <span class="dv">2</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># table(high_variance) # count number of genes with weak high variance</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Select genes having both a high mean expression and a high variance</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>selected_genes <span class="ot">&lt;-</span> high_variance <span class="sc">&amp;</span> high_expression</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table(selected_genes) # count number of genes with weak high coeffficient of variation</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Selected genes: &quot;</span>, <span class="fu">sum</span>(selected_genes)))</span></code></pre></div>
<pre><code>[1] &quot;Selected genes: 675&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Create a data frame with the expression of the selected genes</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fa_expr_selected <span class="ot">&lt;-</span> fa_expr_log2[selected_genes, ]</span></code></pre></div>
<p>Dessinez des histogrammes des valeurs d’expression avant et après cette sélection de gènes, et commentez les différences.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Histograms of expression before and after gene selection ####</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">unlist</span>(fa_expr_log2), </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fu">max</span>(fa_expr_log2) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.25</span>),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Standardized values before gene selection&quot;</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span>  <span class="st">&quot;#DDBBFF&quot;</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">unlist</span>(fa_expr_selected), </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fu">max</span>(fa_expr_log2) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.25</span>),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">0.8</span>, </span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Standardized values after gene selection&quot;</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span>  <span class="st">&quot;#FFDDBB&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_hist_expr_selected_genes-1.png" alt="Distribution of expression values before and after gene selection" width="100%" />
<p class="caption">
Distribution of expression values before and after gene selection
</p>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Dessinez un box plot par échantillon des valeurs d’expression avant et après sélection des gènes, et commentez le résultat.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Boxplots of expression before and after gene selection ####</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fa_expr_log2, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;log2(counts)&quot;</span>, </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> fa_meta<span class="sc">$</span>color, </span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Before gene selection&quot;</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fa_expr_selected, </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">horizontal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;log2(counts)&quot;</span>, </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> fa_meta<span class="sc">$</span>color, </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;After gene selection&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_boxplots_expr_selected_genes-1.png" alt="Box plots of standardised expression values before and after gene selection. " width="60%" />
<p class="caption">
Box plots of standardised expression values before and after gene selection.
</p>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="acp" class="section level3">
<h3>ACP</h3>
<p>Dessinez un plot ACP des échantillons en les colorant par condition avant et après normalisation.</p>
<ul>
<li>avec les comptages bruts de la matrice d’expression initiale (<span class="math inline">\(fa_expr\)</span>)</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### PCA from raw counts, all genes ####</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Running PCA with raw counts, all genes&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Raw expression values, all genes</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>ma_pca_raw_tt <span class="ot">&lt;-</span> <span class="fu">PCA</span>(<span class="fu">t</span>(fa_expr_raw), </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scale.unit =</span> <span class="cn">FALSE</span>, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(ma_pca_raw_tt, choix = &quot;ind&quot;)</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(ma_pca_raw_tt, <span class="at">col.ind =</span> fa_meta[,<span class="st">&quot;condition&quot;</span>])</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_acp_raw_all_genes-1.png" alt="PC plot of the samples from the raw expression values of all genes. " width="60%" />
<p class="caption">
PC plot of the samples from the raw expression values of all genes.
</p>
</div>
<ul>
<li>avec la matrice de valeurs normalisées des gènes filtrés</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### PCA from normalised counts, all genes ####</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Running PCA with normalised counts, all genes&quot;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>ma_pca_filtered <span class="ot">&lt;-</span> <span class="fu">PCA</span>(<span class="fu">t</span>(fa_expr_log2), <span class="at">scale.unit =</span> <span class="cn">FALSE</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(ma_pca_filtered, choix = &quot;var&quot;)</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(ma_pca_sel, choix = &quot;ind&quot;)</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(ma_pca_filtered, <span class="at">col.ind =</span> fa_meta[, <span class="st">&quot;condition&quot;</span>])</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_acp_norm_filtered_genes-1.png" alt="PC plot of the samples from normalised counts, before gene selection. " width="60%" />
<p class="caption">
PC plot of the samples from normalised counts, before gene selection.
</p>
</div>
<ul>
<li>avec la matrice finale (transformation log2, filtre des gènes non-détectés, standardisation et sélection des gènes fortement exprimés et à haut coefficient de variation)</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### PCA from normalised counts, selected genes ####</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Running PCA with normalised counts, selected genes&quot;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>ma_pca_sel <span class="ot">&lt;-</span> <span class="fu">PCA</span>(<span class="fu">t</span>(fa_expr_selected), <span class="at">scale.unit =</span> <span class="cn">FALSE</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(ma_pca_sel, choix = &quot;var&quot;)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(ma_pca_sel, choix = &quot;ind&quot;)</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(ma_pca_sel, <span class="at">col.ind =</span> fa_meta[, <span class="st">&quot;condition&quot;</span>])</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_acp_norm_selected_genes-1.png" alt="PC plot of the samples from normalised values, after gene selection. " width="60%" />
<p class="caption">
PC plot of the samples from normalised values, after gene selection.
</p>
</div>
</div>
<div id="clustering" class="section level3">
<h3>Clustering</h3>
<ul>
<li>Calculez les matrices de distance entre échantillons, en utilisant respectivement les distances euclidienne (<code>dist()</code>), coefficient de Pearson (<code>cor(, method = "pearson")</code>) et de Spearman (<code>cor(, method = "spearman")</code>).</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Sample distances ####</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Computing inter-sample distances&quot;</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>dist_euc_samples <span class="ot">&lt;-</span> <span class="fu">dist</span>(<span class="fu">t</span>(fa_expr_selected))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>cor_pearson_samples <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(fa_expr_selected))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>cor_spearman_samples <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(fa_expr_selected, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span></code></pre></div>
<ul>
<li>Effectuez un clustering hiérarchique des échantillons, en utilisant le critère “complete” pour l’agglomération. Comparez les arbres d’échantillons obtenus avec ces trois métriques et choisissez celle qui vous paraît la plus pertinente.</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Sample clustering ####</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Sample clustering&quot;</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(dist_euc_samples), <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;euclidean distance&quot;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(cor_pearson_samples), <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">hclust</span>(cor_spearman_samples), <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_sample_clustering-1.png" alt="Sample tree with three alternative distance metrics: Euclidiant distance (left), Pearson correlation (center), Spearman correlation (right).? " width="100%" />
<p class="caption">
Sample tree with three alternative distance metrics: Euclidiant distance (left), Pearson correlation (center), Spearman correlation (right).?
</p>
</div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<ul>
<li>Effectuez un clustering hiérarchique des gènes en utilisant la distance basée sur le coefficient de Pearson et la règle d’agglomération complète</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Gene tree with Pearson correlation ####</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Drawing gene tree&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>clustering_method <span class="ot">&lt;-</span> <span class="st">&quot;complete&quot;</span> <span class="do">## Choose a clustering method</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>cor_pearson_genes <span class="ot">&lt;-</span>  <span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(<span class="fu">t</span>(fa_expr_selected)))</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Build a gene tree</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>gene_tree_pearson <span class="ot">&lt;-</span> <span class="fu">hclust</span>(cor_pearson_genes, <span class="at">method =</span> clustering_method)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot the gene tree</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gene_tree_pearson, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">las =</span> <span class="dv">1</span>, </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Gene tree; Pearson coefficient; &quot;</span>, clustering_method, <span class="st">&quot; clustering&quot;</span>), </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="figures/mini-projet_gene_tree-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Dessinez un arbre avec le résultat du clustering des gènes et commentez sa structure. Si vous deviez choisir de façon arbitraire un nombre de clusters, que choisiriez-vous ? Pourquoi ? Pas de panique, nous pouvons assumer ici que la réponse comporte une part de subjectivité.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Plot the gene tree with boxes to denote the clusters ####</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Plotting gene tree&quot;</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gene_tree_pearson, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Gene tree with 7 clusters; Pearson coefficient; &quot;</span>, clustering_method, <span class="st">&quot; clustering&quot;</span>), </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(gene_tree_pearson, <span class="at">k =</span> <span class="dv">7</span>)</span></code></pre></div>
<p><img src="figures/mini-projet_gene_tree_with_boxes-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Dessinez une heatmap du résultat, en sélectionnant les deux résultats de clustering ci-dessus pour les gènes et les échantillons.</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Heatmap with biclustering ####</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;heatmap with biclustering&quot;</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="fu">t</span>(fa_expr_selected), </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Biclustering; &quot;</span>, <span class="st">&quot;Pearson correlation; &quot;</span>, clustering_method, <span class="st">&quot; clustering&quot;</span>),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">clustering_method =</span> clustering_method, </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">clustering_distance_cols =</span> <span class="st">&quot;correlation&quot;</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">clustering_distance_rows =</span> <span class="st">&quot;correlation&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_heatmap_biclustering-1.png" alt="Heatmap showing the biclustering of genes and samples. " width="90%" />
<p class="caption">
Heatmap showing the biclustering of genes and samples.
</p>
</div>
<ul>
<li>Dessinez une heatmap du résultat, en affichant un arbre sur les gènes mais pas sur les échantillons</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Heatmap with clustering on genes only ####</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Heatmap with gene clustering&quot;</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="fu">t</span>(fa_expr_selected), </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Gene clustering; &quot;</span>, <span class="st">&quot;Pearson correlation; &quot;</span>, clustering_method, <span class="st">&quot; clustering&quot;</span>),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">show_colnames =</span> <span class="cn">FALSE</span>, <span class="at">scale =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">clustering_method =</span> clustering_method, </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">clustering_distance_cols =</span> <span class="st">&quot;correlation&quot;</span>, </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="figures/mini-projet_heatmap_gene_clustering-1.png" alt="Heatmap with gene clustering. " width="90%" />
<p class="caption">
Heatmap with gene clustering.
</p>
</div>
<p>Interprétez les résultats en quelques phrases.</p>
</div>
</div>
<div id="enrichissement-fonctionnel" class="section level2">
<h2>5. Enrichissement fonctionnel</h2>
<p><strong><em>A vous de jouer!</em></strong></p>
<p>Effectuez une analyse d’enrichissement fonctionnel avec les principaux clusters obtenus dans la section précédente.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Run enrichment analysis with gost() ####</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Running enrichment analysis for &quot;</span>, <span class="fu">sum</span>(selected_genes) , <span class="st">&quot; selected genes&quot;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Get the list of IDs for the selected genes ##</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>gene_ids <span class="ot">&lt;-</span> <span class="fu">rownames</span>(gene_stat_norm)[selected_genes]</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute enrichment</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>gostres <span class="ot">&lt;-</span> <span class="fu">gost</span>(<span class="at">query =</span> gene_ids, </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">organism =</span> <span class="st">&quot;mmusculus&quot;</span>, </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">ordered_query =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">multi_query =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">significant =</span> <span class="cn">TRUE</span>, </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">exclude_iea =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure_underrepresentation =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">evcodes =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">user_threshold =</span> <span class="fl">0.05</span>, </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction_method =</span> <span class="st">&quot;fdr&quot;</span>, </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">domain_scope =</span> <span class="st">&quot;annotated&quot;</span>, </span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">custom_bg =</span> <span class="cn">NULL</span>, </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">numeric_ns =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">sources =</span> <span class="cn">NULL</span>, </span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">as_short_link =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Check the structure of the result</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gostres)</span></code></pre></div>
<pre><code>[1] &quot;result&quot; &quot;meta&quot;  </code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gostres<span class="sc">$</span>result)</span></code></pre></div>
<pre><code> [1] &quot;query&quot;                 &quot;significant&quot;           &quot;p_value&quot;               &quot;term_size&quot;             &quot;query_size&quot;            &quot;intersection_size&quot;     &quot;precision&quot;             &quot;recall&quot;                &quot;term_id&quot;               &quot;source&quot;                &quot;term_name&quot;             &quot;effective_domain_size&quot;
[13] &quot;source_order&quot;          &quot;parents&quot;              </code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(gostres))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Length</th>
<th align="left">Class</th>
<th align="left">Mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">result</td>
<td align="left">14</td>
<td align="left">data.frame</td>
<td align="left">list</td>
</tr>
<tr class="even">
<td align="left">meta</td>
<td align="left">5</td>
<td align="left">-none-</td>
<td align="left">list</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gostplot</span>(gostres, <span class="at">capped =</span> <span class="cn">TRUE</span>, <span class="at">interactive =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<div id="htmlwidget-8cb473a18e960f717cc0" style="width:80%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8cb473a18e960f717cc0">{"x":{"data":[{"x":[6.28549790489981],"y":[1.6284455188121],"text":"GO:0005242 (15) <br> inward rectifier potassium channel activity <br> 2.353e-02","key":["GO:0005242"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(220,57,18,1)","opacity":0.8,"size":12.2880498208862,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(220,57,18,1)"}},"hoveron":"points","set":"SharedDatad8f48c7d","name":"GO:MF","legendgroup":"GO:MF","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[188.037032959354,161.058875675868,181.790238790009,166.676549579343,161.002131495025,176.530299939676,161.103284165224,186.559217119134,179.409450332893,163.597560984026,172.121523801991,180.606012407195,164.544942090277],"y":[2.56965062067031,1.62399596760947,1.62399596760947,1.57208351132691,1.47399533910142,1.4322758121348,1.41195212517384,1.41195212517384,1.41195212517384,1.34728570895772,1.34728570895772,1.34728570895772,1.34728570895772],"text":["HP:0032180 (1098) <br> Abnormal circulating metabolite concentration <br> 2.694e-03","HP:0001678 (68) <br> Atrioventricular block <br> 2.377e-02","HP:0025142 (942) <br> Constitutional symptom <br> 2.377e-02","HP:0005150 (73) <br> Abnormal atrioventricular conduction <br> 2.679e-02","HP:0001645 (79) <br> Sudden cardiac death <br> 3.357e-02","HP:0011042 (83) <br> Abnormal blood potassium concentration <br> 3.696e-02","HP:0001699 (90) <br> Sudden death <br> 3.873e-02","HP:0031547 (55) <br> Abnormal QT interval <br> 3.873e-02","HP:0012232 (12) <br> Shortened QT interval <br> 3.873e-02","HP:0003115 (98) <br> Abnormal EKG <br> 4.495e-02","HP:0009124 (187) <br> Abnormal adipose tissue morphology <br> 4.495e-02","HP:0012722 (98) <br> Heart block <br> 4.495e-02","HP:0003704 (3) <br> Scapuloperoneal weakness <br> 4.495e-02"],"key":["HP:0032180","HP:0001678","HP:0025142","HP:0005150","HP:0001645","HP:0011042","HP:0001699","HP:0031547","HP:0012232","HP:0003115","HP:0009124","HP:0012722","HP:0003704"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(153,0,153,1)","opacity":0.8,"size":[20.0739859191857,15.6278436937191,19.8610819208385,15.76176906904,15.9091248231997,16.0003659352217,16.1484806873478,15.2180005546655,11.6762114647282,16.3023678312932,17.4135267511053,16.3023678312932,3.77952755905512],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(153,0,153,1)"}},"hoveron":"points","set":"SharedDatad8f48c7d","name":"HP","legendgroup":"HP","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[137.491882928103,141.272208773866,141.274676349483],"y":[2.20988981947429,2.20988981947429,1.6202005986677],"text":["TF:M01175 (6334) <br> Factor: CKROX; motif: SCCCTCCCC <br> 6.168e-03","TF:M00649 (8416) <br> Factor: MAZ; motif: GGGGAGGG <br> 6.168e-03","TF:M00649_1 (3022) <br> Factor: MAZ; motif: GGGGAGGG; match class: 1 <br> 2.398e-02"],"key":["TF:M01175","TF:M00649","TF:M00649_1"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(85,116,166,1)","opacity":0.8,"size":[22.335843105845,22.6771653543307,21.4161354840516],"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(85,116,166,1)"}},"hoveron":"points","set":"SharedDatad8f48c7d","name":"TF","legendgroup":"TF","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[2,32.2378021430351],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(220,57,18,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[34.7047844505358,45.714926488911],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(16,150,24,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[48.1819087964117,123.397732369798],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(255,153,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[125.864714677299,127.206753052579],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(221,68,119,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[129.67373536008,133.857737353601],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(51,102,204,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[136.324719661101,146.584899077997],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(85,116,166,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[149.051881385497,151.422651383005],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(34,170,153,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[153.889633690506,155.564714677299],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(102,170,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[158.031696984799,197.049489160229],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(153,0,153,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[199.51647146773,200.002466982307],"y":[-1,-1],"text":"","type":"scatter","mode":"lines","line":{"width":11.3385826771654,"color":"rgba(0,153,198,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[180],"y":[16.2],"text":"values above this threshold are capped","hovertext":"","textfont":{"size":7.55905511811024,"color":"rgba(190,190,190,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,210],"y":[16,16],"text":"","type":"scatter","mode":"lines","line":{"width":0.755905511811024,"color":"rgba(190,190,190,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":29.2835201328352,"r":6.6417600664176,"b":55.8781661388202,"l":61.0377750103778},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0,210],"tickmode":"array","ticktext":["GO:MF","GO:CC","GO:BP","KEGG","REAC","TF","MIRNA","CORUM","HP","WP"],"tickvals":[17.1189010715176,40.2098554697234,85.7898205831049,126.535733864939,131.76573635684,141.454809369549,150.237266384251,154.727174183902,177.540593072514,199.759469225019],"categoryorder":"array","categoryarray":["GO:MF","GO:CC","GO:BP","KEGG","REAC","TF","MIRNA","CORUM","HP","WP"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.6268161062682},"tickangle":-45,"showline":true,"linecolor":"rgba(190,190,190,1)","linewidth":0.132835201328352,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1,18.5],"tickmode":"array","ticktext":["0","2","4","6","8","10","12","14",">16"],"tickvals":[0,2,4,6,8,10,12,14,16],"categoryorder":"array","categoryarray":["0","2","4","6","8","10","12","14",">16"],"nticks":null,"ticks":"outside","tickcolor":"rgba(190,190,190,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(190,190,190,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"-log10(p-adj)","x":-0.0155295617624385,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"query_1","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(169,169,169,1)","family":"","size":13.2835201328352},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":24.9730178497302,"yanchor":1,"ysizemode":"pixel"}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative","dragmode":"zoom"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"585f73987712":{"colour":{},"size":{},"alpha":{},"key":{},"x":{},"y":{},"text":{},"type":"scatter"},"585f26f56c17":{"x":{},"xend":{},"y":{},"yend":{}},"585f16ec23db":{"x":{},"xend":{},"y":{},"yend":{}},"585f395cba0e":{"x":{},"xend":{},"y":{},"yend":{}},"585f747ab6d3":{"x":{},"xend":{},"y":{},"yend":{}},"585f2fe1f3fb":{"x":{},"xend":{},"y":{},"yend":{}},"585f885d017":{"x":{},"xend":{},"y":{},"yend":{}},"585f605eaa76":{"x":{},"xend":{},"y":{},"yend":{}},"585f6f52402a":{"x":{},"xend":{},"y":{},"yend":{}},"585f7d286eb":{"x":{},"xend":{},"y":{},"yend":{}},"585f32e18129":{"x":{},"xend":{},"y":{},"yend":{}},"585f4c6436e":{"x":{},"y":{}},"585f5712348c":{"yintercept":{}}},"cur_data":"585f73987712","visdat":{"585f73987712":["function (y) ","x"],"585f26f56c17":["function (y) ","x"],"585f16ec23db":["function (y) ","x"],"585f395cba0e":["function (y) ","x"],"585f747ab6d3":["function (y) ","x"],"585f2fe1f3fb":["function (y) ","x"],"585f885d017":["function (y) ","x"],"585f605eaa76":["function (y) ","x"],"585f6f52402a":["function (y) ","x"],"585f7d286eb":["function (y) ","x"],"585f32e18129":["function (y) ","x"],"585f4c6436e":["function (y) ","x"],"585f5712348c":["function (y) ","x"]},"highlight":{"on":"plotly_click","off":"plotly_doubleclick","persistent":false,"dynamic":false,"color":null,"selectize":false,"defaultValues":null,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedDatad8f48c7d"]},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Dynamic map of the enrichment analysis for the selected genes. Position the cursor on a circle to see the enriched term.
</p>
</div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Check the most significant results, formating for kable</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>enrich_order <span class="ot">&lt;-</span> <span class="fu">order</span>(gostres<span class="sc">$</span>result<span class="sc">$</span>p_value, <span class="at">decreasing =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>sorted_result <span class="ot">&lt;-</span> gostres<span class="sc">$</span>result[enrich_order, ]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(sorted_result, <span class="at">n =</span> <span class="dv">10</span>), </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Top 10 most significant enriched functional classes&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption>Top 10 most significant enriched functional classes</caption>
<colgroup>
<col width="1%" />
<col width="3%" />
<col width="5%" />
<col width="5%" />
<col width="4%" />
<col width="5%" />
<col width="8%" />
<col width="4%" />
<col width="3%" />
<col width="5%" />
<col width="3%" />
<col width="21%" />
<col width="10%" />
<col width="6%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">query</th>
<th align="left">significant</th>
<th align="right">p_value</th>
<th align="right">term_size</th>
<th align="right">query_size</th>
<th align="right">intersection_size</th>
<th align="right">precision</th>
<th align="right">recall</th>
<th align="left">term_id</th>
<th align="left">source</th>
<th align="left">term_name</th>
<th align="right">effective_domain_size</th>
<th align="right">source_order</th>
<th align="left">parents</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.002693701</td>
<td align="right">1098</td>
<td align="right">43</td>
<td align="right">25</td>
<td align="right">0.581</td>
<td align="right">0.023</td>
<td align="left">HP:0032180</td>
<td align="left">HP</td>
<td align="left">Abnormal circulating metabolite concentration</td>
<td align="right">4637</td>
<td align="right">12163</td>
<td align="left">HP:0001939</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.006167515</td>
<td align="right">6334</td>
<td align="right">110</td>
<td align="right">55</td>
<td align="right">0.500</td>
<td align="right">0.009</td>
<td align="left">TF:M01175</td>
<td align="left">TF</td>
<td align="left">Factor: CKROX; motif: SCCCTCCCC</td>
<td align="right">21837</td>
<td align="right">474</td>
<td align="left">TF:M00000</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.006167515</td>
<td align="right">8416</td>
<td align="right">110</td>
<td align="right">66</td>
<td align="right">0.600</td>
<td align="right">0.008</td>
<td align="left">TF:M00649</td>
<td align="left">TF</td>
<td align="left">Factor: MAZ; motif: GGGGAGGG</td>
<td align="right">21837</td>
<td align="right">2006</td>
<td align="left">TF:M00000</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.023526346</td>
<td align="right">15</td>
<td align="right">81</td>
<td align="right">3</td>
<td align="right">0.037</td>
<td align="right">0.200</td>
<td align="left"><a href="GO:0005242" class="uri">GO:0005242</a></td>
<td align="left"><a href="GO:MF" class="uri">GO:MF</a></td>
<td align="left">inward rectifier potassium channel activity</td>
<td align="right">13399</td>
<td align="right">1738</td>
<td align="left"><a href="GO:0005249" class="uri">GO:0005249</a>, <a href="GO:0099094" class="uri">GO:0099094</a></td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.023768624</td>
<td align="right">68</td>
<td align="right">43</td>
<td align="right">6</td>
<td align="right">0.140</td>
<td align="right">0.088</td>
<td align="left">HP:0001678</td>
<td align="left">HP</td>
<td align="left">Atrioventricular block</td>
<td align="right">4637</td>
<td align="right">1228</td>
<td align="left">HP:0005150, HP:0012722</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.023768624</td>
<td align="right">942</td>
<td align="right">43</td>
<td align="right">21</td>
<td align="right">0.488</td>
<td align="right">0.022</td>
<td align="left">HP:0025142</td>
<td align="left">HP</td>
<td align="left">Constitutional symptom</td>
<td align="right">4637</td>
<td align="right">9631</td>
<td align="left">HP:0000118</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.023977252</td>
<td align="right">3022</td>
<td align="right">110</td>
<td align="right">32</td>
<td align="right">0.291</td>
<td align="right">0.011</td>
<td align="left">TF:M00649_1</td>
<td align="left">TF</td>
<td align="left">Factor: MAZ; motif: GGGGAGGG; match class: 1</td>
<td align="right">21837</td>
<td align="right">2007</td>
<td align="left">TF:M00649</td>
</tr>
<tr class="even">
<td align="left">5</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.026786532</td>
<td align="right">73</td>
<td align="right">43</td>
<td align="right">6</td>
<td align="right">0.140</td>
<td align="right">0.082</td>
<td align="left">HP:0005150</td>
<td align="left">HP</td>
<td align="left">Abnormal atrioventricular conduction</td>
<td align="right">4637</td>
<td align="right">3505</td>
<td align="left">HP:0031546</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.033574122</td>
<td align="right">79</td>
<td align="right">43</td>
<td align="right">6</td>
<td align="right">0.140</td>
<td align="right">0.076</td>
<td align="left">HP:0001645</td>
<td align="left">HP</td>
<td align="left">Sudden cardiac death</td>
<td align="right">4637</td>
<td align="right">1205</td>
<td align="left">HP:0001695, HP:0001699</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">query_1</td>
<td align="left">TRUE</td>
<td align="right">0.036959338</td>
<td align="right">83</td>
<td align="right">43</td>
<td align="right">6</td>
<td align="right">0.140</td>
<td align="right">0.072</td>
<td align="left">HP:0011042</td>
<td align="left">HP</td>
<td align="left">Abnormal blood potassium concentration</td>
<td align="right">4637</td>
<td align="right">7499</td>
<td align="left">HP:0010930</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(gostres<span class="sc">$</span>meta)</span></code></pre></div>
<pre><code>[1] &quot;query_metadata&quot;  &quot;result_metadata&quot; &quot;genes_metadata&quot;  &quot;timestamp&quot;       &quot;version&quot;        </code></pre>
<p><strong>Challenge falcultatif:</strong></p>
<p>Effectuez une analyse d’enrichissement sur chacun des clusters obtenus à partir de l’arbre des gènes.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Enrichment by cluster ####</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Enrichment analysis by clusters&quot;</span>)</span></code></pre></div>
</div>
<div id="conclusions-générales" class="section level2">
<h2>Conclusions générales</h2>
<p>Résumez en quelques phrases vos conclusions à partir des résultats obtenus.</p>
</div>
<div id="session-info" class="section level2">
<h2>Session info</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Session info ####</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-conda_cos6-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /shared/ifbstor1/software/miniconda/envs/r-4.0.2/lib/libopenblasp-r0.3.10.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] biomaRt_2.46.3   pheatmap_1.0.12  gprofiler2_0.2.0 factoextra_1.0.7 ggplot2_3.3.3    FactoMineR_2.3   knitr_1.30      

loaded via a namespace (and not attached):
  [1] bitops_1.0-6         bit64_4.0.5          RColorBrewer_1.1-2   progress_1.2.2       httr_1.4.2           tools_4.0.2          backports_1.2.1      utf8_1.2.1           R6_2.5.0             DBI_1.1.1            lazyeval_0.2.2       BiocGenerics_0.36.0  colorspace_2.0-0     withr_2.4.1         
 [15] tidyselect_1.1.0     prettyunits_1.1.1    bit_4.0.4            curl_4.3             compiler_4.0.2       Biobase_2.50.0       flashClust_1.01-2    xml2_1.3.2           plotly_4.9.3         labeling_0.4.2       scales_1.1.1         askpass_1.1          rappdirs_0.3.3       stringr_1.4.0       
 [29] digest_0.6.27        foreign_0.8-80       rmarkdown_2.5        rio_0.5.16           pkgconfig_2.0.3      htmltools_0.5.1.1    dbplyr_2.0.0         fastmap_1.1.0        highr_0.8            htmlwidgets_1.5.3    rlang_0.4.10         readxl_1.3.1         RSQLite_2.2.3        shiny_1.5.0         
 [43] farver_2.1.0         generics_0.1.0       jsonlite_1.7.2       crosstalk_1.1.1      dplyr_1.0.5          zip_2.1.1            car_3.0-10           RCurl_1.98-1.3       magrittr_2.0.1       leaps_3.1            Rcpp_1.0.6           munsell_0.5.0        S4Vectors_0.28.1     fansi_0.4.2         
 [57] abind_1.4-5          lifecycle_1.0.0      scatterplot3d_0.3-41 stringi_1.5.3        yaml_2.2.1           carData_3.0-4        debugme_1.1.0        MASS_7.3-53          BiocFileCache_1.14.0 grid_4.0.2           blob_1.2.1           promises_1.2.0.1     parallel_4.0.2       ggrepel_0.9.1       
 [71] forcats_0.5.1        crayon_1.4.1         lattice_0.20-41      haven_2.3.1          hms_1.0.0            pillar_1.5.1         ggpubr_0.4.0         ggsignif_0.6.0       stats4_4.0.2         XML_3.99-0.5         glue_1.4.2           evaluate_0.14        data.table_1.14.0    httpuv_1.5.5        
 [85] vctrs_0.3.6          cellranger_1.1.0     gtable_0.3.0         openssl_1.4.3        purrr_0.3.4          tidyr_1.1.3          assertthat_0.2.1     cachem_1.0.4         xfun_0.20            openxlsx_4.2.3       mime_0.10            xtable_1.8-4         broom_0.7.2          later_1.1.0.1       
 [99] rstatix_0.6.0        viridisLite_0.3.0    tibble_3.1.0         AnnotationDbi_1.52.0 memoise_2.0.0        IRanges_2.24.1       cluster_2.1.0        ellipsis_0.3.1      </code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTWluaS1wcm9qZXQgMjAyMSAtIEV4cGxvcmF0aW9uIGRlcyBkb25uw6llcyBkZSBQYXZrb3ZpYyIKYXV0aG9yOiAiQ2xhaXJlIFZhbmRpZWRvbmNrLCBKYWNxdWVzIHZhbiBIZWxkZW4sIEFubmUgQmFkZWwgJiBPbGl2aWVyIFNhbmQiCmRhdGU6ICdgciBTeXMuRGF0ZSgpYCcKb3V0cHV0OgogIGh0bWxfZG9jdW1lbnQ6CiAgICBzZWxmX2NvbnRhaW5lZDogbm8KICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKICAgIGZpZ19jYXB0aW9uOiB5ZXMKICAgIGhpZ2hsaWdodDogemVuYnVybgogICAgdGhlbWU6IGNlcnVsZWFuCiAgICB0b2M6IHllcwogICAgdG9jX2RlcHRoOiAzCiAgICB0b2NfZmxvYXQ6IHllcwogICAgY29kZV9mb2xkaW5nOiAiaGlkZSIKICBwZGZfZG9jdW1lbnQ6CiAgICBmaWdfY2FwdGlvbjogeWVzCiAgICBoaWdobGlnaHQ6IHplbmJ1cm4KICAgIHRvYzogeWVzCiAgICB0b2NfZGVwdGg6IDMKZWRpdG9yX29wdGlvbnM6IAogIGNodW5rX291dHB1dF90eXBlOiBjb25zb2xlCi0tLQoKCmBgYHtyIHNldHRpbmdzLCBpbmNsdWRlPUZBTFNFLCBlY2hvPUZBTFNFLCBldmFsPVRSVUV9Cm9wdGlvbnMod2lkdGggPSAzMDApCiMgb3B0aW9ucyhlbmNvZGluZyA9ICdVVEYtOCcpCmtuaXRyOjpvcHRzX2NodW5rJHNldCgKICBmaWcud2lkdGggPSA3LCBmaWcuaGVpZ2h0ID0gNSwgCiAgZmlnLnBhdGggPSAnZmlndXJlcy9taW5pLXByb2pldF8nLAogIGZpZy5hbGlnbiA9ICJjZW50ZXIiLCAKICBzaXplID0gInRpbnkiLCAKICBlY2hvID0gVFJVRSwgCiAgZXZhbCA9IFRSVUUsIAogIHdhcm5pbmcgPSBGQUxTRSwgCiAgbWVzc2FnZSA9IEZBTFNFLCAKICByZXN1bHRzID0gVFJVRSwgCiAgY29tbWVudCA9ICIiKQoKb3B0aW9ucyhzY2lwZW4gPSAxMikgIyMgTWF4IG51bWJlciBvZiBkaWdpdHMgZm9yIG5vbi1zY2llbnRpZmljIG5vdGF0aW9uCiMga25pdHI6OmFzaXNfb3V0cHV0KCJcXGZvb3Rub3Rlc2l6ZSIpCmBgYAoKYGBge3IgbGlicmFyaWVzLCBlY2hvPUZBTFNFLCBldmFsPVRSVUV9CiMjIyMgUmVxdWlyZWQgbGlicmFyaWVzICMjIyMKCiMgTG9hZCByZXF1aXJlZCBDUkFOIFIgbGlicmFyaWVzCnJlcXVpcmVkX2NyYW5MaWIgPC0gYygia25pdHIiLCAKICAgICAgICAgICAgICAgICAgICAgICJGYWN0b01pbmVSIiwgCiAgICAgICAgICAgICAgICAgICAgICAiZmFjdG9leHRyYSIsIAogICAgICAgICAgICAgICAgICAgICAgImdwcm9maWxlcjIiLAogICAgICAgICAgICAgICAgICAgICAgInBoZWF0bWFwIikKZm9yIChsaWIgaW4gcmVxdWlyZWRfY3JhbkxpYikgewogIGlmICghcmVxdWlyZShsaWIsIGNoYXJhY3Rlci5vbmx5ID0gVFJVRSkpIHsKICAgIGluc3RhbGwucGFja2FnZXMobGliKQogIH0KICByZXF1aXJlKGxpYiwgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKQp9CgpyZXF1aXJlZF9iaW9jTGliIDwtIGMoImJpb21hUnQiKQpmb3IgKGxpYiBpbiByZXF1aXJlZF9iaW9jTGliKSB7CiAgaWYgKCFyZXF1aXJlKGxpYiwgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKSkgewogICAgQmlvY01hbmFnZXI6Omluc3RhbGwobGliKQogIH0KICByZXF1aXJlKGxpYiwgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKQp9CgprYWJsZShhcy5kYXRhLmZyYW1lKGMocmVxdWlyZWRfY3JhbkxpYiwgcmVxdWlyZWRfYmlvY0xpYikpLAogICAgICBjb2wubmFtZXMgPSAibGlicmFyaWVzIiwKICAgICAgY2FwdGlvbiA9ICJMb2FkZWQgcmVxdWlyZWQgbGlicmFyaWVzIgogICAgKQoKYGBgCgojIyBTeW5vcHNpcyBkdSBwcm9qZXQKCiMjIyBUcmF2YWlsIGRlbWFuZMOpCgpMZSBidXQgZGUgY2UgdHJhdmFpbCBlc3QgZGUgbWV0dHJlIGVuIG9ldXZyZSBsZXMgbcOpdGhvZGVzIHZ1ZXMgZGFucyBsZSBtb2R1bGUgMyAiUiBldCBzdGF0aXN0aXF1ZXMiIHBvdXIgZXhwbG9yZXIgbGUgamV1IGRlIGRvbm7DqWVzIGRlIFBhdmtvdmljLCBldCBkZSByZW5kcmUgdW4gcmFwcG9ydCBkJ2FuYWx5c2UgYXUgZm9ybWF0IGAuUm1kYC4gCgpOb3VzIGZvdXJuaXNzb25zIGNpLWRlc3NvdXMgdW5lIHRyYW1lIGF2ZWMgbGVzIHByaW5jaXBhbGVzIHNlY3Rpb25zIGF0dGVuZHVlcy4gQ2VydGFpbmVzIGNvbnRpZW5uZW50IGTDqWrDoCBkdSBjb2RlLiBWb3VzIGRldnJleiBlbiBjb21wbMOpdGVyIGQnYXV0cmVzLiBTZW50ZXotdm91cyBsaWJyZXMgZCdhZGFwdGVyIGNldHRlIHRyYW1lIG91IGQneSBham91dGVyIGRlcyBhbmFseXNlcyBjb21wbMOpbWVudGFpcmVzIHNpIGVsbGVzIHZvdXMgYWlkZW50IMOgIGludGVycHLDqXRlciB2b3MgcsOpc3VsdGF0cy4gCgojIyMgUmVtaXNlIGR1IHJhcHBvcnQKCkRhdGU6ICoqbGUgMjIgbWFpIDIwMjEgw6AgbWludWl0KiouICBTaSB2b3VzIGFudGljaXBleiB1biBwcm9ibMOobWUgcG91ciByZW1ldHRyZSBsZSByYXBwb3J0IMOgIGNldHRlIGRhdGUgY29udGFjdGV6LW5vdXMgYXVzc2kgcmFwaWRlbWVudCBxdWUgcG9zc2libGUgcG91ciBxdWUgbm91cyBwdWlzc2lvbnMgcHLDqXZvaXIgdW5lIHJlbWlzZSBwbHVzIHRhcmRpdmUuIAoKLSBDb21tZW5jZXogcGFyIHJlbm9tbWVyIGxlIGZpY2hpZXIgLlJtZCBlbiByZW1wbGHDp2FudCBQcmVub20tTk9NIHBhciB2b3Mgbm9tIGV0IHByw6lub20uIAotIExlIHJhcHBvcnQgZXN0IGF0dGVuZHUgZW4gZm9ybWF0cyAuUm1kICsgLkhUTUwgKGVuIGdhcmRhbnQgbCdvcHRpb24gc2VsZl9jb250YWluZWQgZGUgbCdlbi10w6p0ZSBhY3RpdsOpZSkuIAotIETDqXBvc2V6IGxlcyBmaWNoaWVycyBkYW5zIHVuIHNvdXMtZG9zc2llciBkZSB2b3RlIGNvbXB0ZSBkdSBjbHVzdGVyLiBBdHRlbnRpb24sIHZlaWxsZXogw6AgcmVzcGVjdGVyIHByw6ljaXPDqW1lbnQgY2V0dGUgc3RydWN0dXJlIGRlIGNoZW1pbiBjYXIgbm91cyBub3VzIGJhc2Vyb25zIGRlc3N1cyBwb3VyIHLDqWN1cMOpcmVyIHZvcyByw6lzdWx0YXRzLiAKCiAgICBgL3NoYXJlZC9wcm9qZWN0cy9kdWJpaTIwMjEvW2xvZ2luXS9tMy1zdGF0LVIvbWluaS1wcm9qZXRgIAoKIyMjIENyaXTDqHJlcyBkJ8OpdmFsdWF0aW9uCgotIFJlcHJvZHVjdGliaWxpdMOpIGRlcyBhbmFseXNlczogbm91cyB0ZW50ZXJvbnMgZGUgcmVnw6luw6lyZXIgbGUgcmFwcG9ydCBIVE1MIMOgIHBhcnRpciBkZSB2b3RyZSBSbWQsIGVuIHBhcnRhbnQgZGUgbm90cmUgY29tcHRlIHN1ciBsZSBzZXJ2ZXVyIElGQi4gCi0gTWFuaXB1bGF0aW9uIGRlcyBvYmpldHMgUgotIE1vYmlsaXNhdGlvbiBkZXMgbcOpdGhvZGVzIHN0YXRpc3RpcXVlcyB2dWVzIGF1IGNvdXJzCi0gUGVydGluZW5jZSBkZXMgaW50ZXJwcsOpdGF0aW9ucyBzdGF0aXN0aXF1ZXMKLSBQZXJ0aW5lbmNlIGRlcyBpbnRlcnByw6l0YXRpb25zIGJpb2xvZ2lxdWVzCi0gQ2xhcnTDqSBkZSBsYSByw6lkYWN0aW9uCi0gQ2xhcnTDqSBkZXMgaWxsdXN0cmF0aW9ucyAoZmlndXJlcyBldCB0YWJsZWF1eCk6IGdyYXBoaXNtZXMsIGzDqWdlbmRlcyAuLi4KCk5vdXMgdm91cyBlbmNvdXJhZ2VvbnMgw6AgYXNzdXJlciBsYSBsaXNpYmlsaXTDqSBkZSB2b3RyZSBjb2RlIChzeW50YXhlLCBub21tYWdlIGRlcyB2YXJpYWJsZXMsIGNvbW1lbnRhaXJlcyBkZSBjb2RlKQoKIyMjIE9iamVjdGlmcyBzY2llbnRpZmlxdWVzCgpOb3VzIHBhcnRvbnMgZHUgbcOqbWUgamV1IGRlIGRvbm7DqWVzICpGaWwgUm91Z2UqIGRlIGNlIG1vZHVsZSBpc3N1ZXMgZGUgbGEgcHVibGljYXRpb24gUGF2a292aWMsIE0uLCBQYW50YW5vLCBMLiwgR2VybGFjaCwgQy5WLiBldCBhbC4gTXVsdGkgb21pY3MgYW5hbHlzaXMgb2YgZmlicm90aWMga2lkbmV5cyBpbiB0d28gbW91c2UgbW9kZWxzLiBTY2kgRGF0YSA2LCA5MiAoMjAxOSkuIGh0dHBzOi8vZG9pLm9yZy8xMC4xMDM4L3M0MTU5Ny0wMTktMDA5NS01CgoqKlJhcHBlbCBzdXIgbGVzIMOpY2hhbnRpbGxvbnM6KioKCkRldXggbW9kw6hsZXMgZGUgZmlicm9zZSByw6luYWxlIGNoZXogbGEgc291cmlzIHNvbnQgw6l0dWRpw6lzOgoKMS4gTGUgcHJlbWllciBlc3QgdW4gbW9kw6hsZSBkZSBuw6lwaHJvcGF0aGllIHLDqXZlcnNpYmxlIGluZHVpdGUgcGFyIGwnYWNpZGUgZm9saXF1ZSAoZm9saWMgYWNpZCAoRkEpKS4gTGVzIHNvdXJpcyBvbnQgw6l0w6kgc2FjcmlmacOpZXMgYXZhbnQgbGUgdHJhaXRlbWVudCAobm9ybWFsKSwgcHVpcyDDoCBqb3VyIDEsIDIsIDcgZXQgMTQgKGRheTEsLi4uKSBhcHLDqHMgdW5lIHNldWxlIGluamVjdGlvbiBkJ2FjaWRlIGZvbGlxdWUuCgoyLiBMZSBzZWNvbmQgZXN0IHVuIG1vZMOobGUgaXJyw6l2ZXJzaWJsZSBpbmR1aXQgY2hyaXJ1cmdpY2FsZW1lbnQgKHVuaWxhdGVyYWwgdXJldGVyYWwgb2JzdHJ1Y3Rpb24gKFVVTykpLiBsZXMgc291cmlzIG9udCDDqXTDqSBzYWNyaWZpw6llcyBhdmFudCBvYnN0cnVjdGlvbiAoZGF5IDApIGV0IMOgIDMsIDcgZXQgMTQgam91cnMgYXByw6hzIG9ic3RydWN0aW9uIHBhciBsaWdhdGlvbiBkZSBsJ3VyZXTDqHJlIGR1IHJlaW4gZ2F1Y2hlLgoKQSBwYXJ0aXIgZGUgY2VzIGV4dHJhaXRzIGRlIHJlaW4sIGwnQVJOIG1lc3NhZ2VyIHRvdGFsIGV0IGxlcyBwZXRpdHMgQVJOcyBvbnQgw6l0w6kgc8OpcXVlbmPDqXMgZXQgbGVzIHByb3TDqWluZXMgY2FyYXTDqXJpc8OpZXMgcGFyIHNwZWN0cm9tw6l0cmllIGRlIG1hc3NlIGVuIHRhbmRlbSAoVE1UKS4KCioqQnV0IHNjaWVudGlmaXF1ZToqKiBEYW5zIGxlIHR1dG9yaWVsIHN1ciBsZXMgZGF0YWZyYW1lcywgdm91cyBhdmV6IHRyYXZhaWxsw6kgc3VyIGxlcyBkb25uw6llcyBkZSAqKip0cmFuc2NyaXB0b21lIGR1IG1vZMOobGUgVVVPKioqLiBEYW5zIGNlIG1pbmktcHJvamV0LCB2b3VzIGFsbGV6IHRyYXZhaWxsZXIgc3VyIGxlcyBkb25uw6llcyBkdSAqKip0cmFuc2NyaXB0b21lIGR1IG1vZMOobGUgRkEqKiogYWZpbiBkZSByZWdyb3VwZXIgbGVzIG9ic2VydmF0aW9ucyAow6ljaGFudGlsbG9uKSBldCBsZXMgZ8OobmVzIHNlbG9uIGRlcyBwcm9maWxzIGQnZXhwcmVzc2lvbiBzaW1pbGFpcmVzLgoKKipWb3RyZSBwcm9qZXQgc2UgZMOpY29tcG9zZSBlbiA1IHBhcnRpZXMgZG9udCAzIHNlcm9udCDDoCByw6lhbGlzZXIgcGFyOioqCgoxLiBTdGF0aXRpcXVlcyBkZXNjcmlwdGl2ZXMgZGVzIGRvbm7DqWVzIGJydXRlczogY29tbWFuZGVzIGZvdXJuaWVzCjIuIE5vcm1hbGlzYXRpb24gZGVzIGRvbm7DqWVzIDogY29tbWFuZGVzIGZvdXJuaWVzCjMuIFN0YXRpc3RpcXVlcyBkZXNjcmlwdGl2ZXMgZGVzIGRvbm7DqWVzIG5vcm1hbGlzw6llczogw6Agdm91cyBkZSBqb3Vlcgo0LiBBbmFseXNlIGRlIHJlZ3JvdXBlbWVudCBkZXMgZG9ubsOpZXM6IMOgIHZvdXMgZGUgam91ZXIKNS4gQW5hbHlzZSBkJ2VucmljaGlzc2VtZW50IGZvbmN0aW9ubmVsOiDDoCB2b3VzIGRlIGpvdWVyCgojIyAxLiBMZXMgZG9ubsOpZXMgYnJ1dGVzCgoqKipWb3VzIG4nYXZleiByaWVuIMOgIGNvZGVyIGljaS4gTGUgY29kZSBlc3QgZm91cm5pLioqKgoKIyMjIENoYXJnZW1lbnQgZGVzIGRvbm7DqWVzIGJydXRlcwoKTGUgYmxvYyBzdWl2YW50IGNvbnRpZW50IHVuZSBmb25jdGlvbiBxdWkgcGVybWV0IGRlIHTDqWzDqWNoYXJnZXIgdW4gZmljaGllciBkYW5zIGwnZXNwYWNlIGRlIHRyYXZhaWwsIHNhdWYgcydpbCBlc3QgZMOpasOgIHByw6lzZW50LiBOb3VzIGwndXRpbGlzZXJvbnMgZW5zdWl0ZSBwb3VyIHTDqWzDqWNoYXJnZXIgbGVzIGRvbm7DqWVzIMOgIGFuYWx5c2VyIGVuIMOpdml0YW50IGRlIHJlZmFpcmUgbGUgdHJhbnNmZXJ0IMOgIGNoYXF1ZSBleMOpY3V0aW9uIGRlIGwnYW5hbHlzZS4gCgpgYGB7ciBmdW5jdGlvbl9kb3dubG9hZF9vbmx5X29uY2V9CiMnIEB0aXRsZSBEb3dubG9hZCBhIGZpbGUgb25seSBpZiBpdCBpcyBub3QgeWV0IGhlcmUKIycgQGF1dGhvciBKYWNxdWVzIHZhbiBIZWxkZW4gZW1haWx7SmFjcXVlcy52YW4tSGVsZGVuQEBmcmFuY2UtYmlvaW5mb3JtYXRpcXVlLmZyfQojJyBAcGFyYW0gdXJsX2Jhc2UgYmFzZSBvZiB0aGUgVVJMLCB0aGF0IHdpbGwgYmUgcHJlcGVuZGVkIHRvIHRoZSBmaWxlIG5hbWUKIycgQHBhcmFtIGZpbGVfbmFtZSBuYW1lIG9mIHRoZSBmaWxlIChzaG91bGQgbm90IGNvbnRhaW4gYW55IHBhdGgpCiMnIEBwYXJhbSBsb2NhbF9mb2xkZXIgcGF0aCBvZiBhIGxvY2FsIGZvbGRlciB3aGVyZSB0aGUgZmlsZSBzaG91bGQgYmUgc3RvcmVkCiMnIEByZXR1cm4gdGhlIGZ1bmN0aW9uIHJldHVybnMgdGhlIHBhdGggb2YgdGhlIGxvY2FsIGZpbGUsIGJ1aWx0IGZyb20gbG9jYWxfZm9sZGVyIGFuZCBmaWxlX25hbWUKIycgQGV4cG9ydMKpCmRvd25sb2FkX29ubHlfb25jZSA8LSBmdW5jdGlvbigKICB1cmxfYmFzZSwgCiAgZmlsZV9uYW1lLAogIGxvY2FsX2ZvbGRlcikgewoKICAjIyBEZWZpbmUgdGhlIHNvdXJjZSBVUkwgIAogIHVybCA8LSBmaWxlLnBhdGgodXJsX2Jhc2UsIGZpbGVfbmFtZSkKICBtZXNzYWdlKCJTb3VyY2UgVVJMXG5cdCIsICB1cmwpCgogICMjIERlZmluZSB0aGUgbG9jYWwgZmlsZQogIGxvY2FsX2ZpbGUgPC0gZmlsZS5wYXRoKGxvY2FsX2ZvbGRlciwgZmlsZV9uYW1lKQogIAogICMjIENyZWF0ZSB0aGUgbG9jYWwgZGF0YSBmb2xkZXIgaWYgaXQgZG9lcyBub3QgZXhpc3QKICBkaXIuY3JlYXRlKGxvY2FsX2ZvbGRlciwgc2hvd1dhcm5pbmdzID0gRkFMU0UsIHJlY3Vyc2l2ZSA9IFRSVUUpCiAgCiAgIyMgRG93bmxvYWQgdGhlIGZpbGUgT05MWSBpZiBpdCBpcyBub3QgYWxyZWFkeSB0aGVyZQogIGlmICghZmlsZS5leGlzdHMobG9jYWxfZmlsZSkpIHsKICAgIG1lc3NhZ2UoIkRvd25sb2FkaW5nIGZpbGUgZnJvbSBzb3VyY2UgVVJMIHRvIGxvY2FsIGZpbGVcblx0IiwgCiAgICAgICAgICAgIGxvY2FsX2ZpbGUpCiAgICBkb3dubG9hZC5maWxlKHVybCA9IHVybCwgZGVzdGZpbGUgPSBsb2NhbF9maWxlKQogIH0gZWxzZSB7CiAgICBtZXNzYWdlKCJMb2NhbCBmaWxlIGFscmVhZHkgZXhpc3RzLCBubyBuZWVkIHRvIGRvd25sb2FkXG5cdCIsIAogICAgICAgICAgICBsb2NhbF9maWxlKQogIH0KICAKICByZXR1cm4obG9jYWxfZmlsZSkKfQpgYGAKCk5vdXMgdMOpbMOpY2hhcmdlb25zIGRldXggZmljaGllcnMgZGFucyB1biBkb3NzaWVyIGxvY2FsIGB+L20zLXN0YXQtUi9wYXZrb3ZpY19hbmFseXNpc2AgKioodm91cyBwb3V2ZXogY2hhbmdlciBsZSBub20gb3UgY2hlbWluIGRhbnMgbGUgY2h1bmsgY2ktZGVzc291cykqKiwgZXQgbGVzIGNoYXJnZW9ucyBkYW5zIGxlcyBkYXRhLmZyYW1lcyBzdWl2YW50czogCgotIERvbm7DqWVzIGJydXRlcyBkZSB0cmFuc2NyaXB0b21lOiBgZmFfZXhwcl9yYXdgCi0gTcOpdGFkb25uw6llczogYGZhX21ldGFgCgpgYGB7ciBkb3dubG9hZF9hbmRfbG9hZH0KIyMgRGVmaW5lIHRoZSByZW1vdGUgVVJMIGFuZCBsb2NhbCBmb2xkZXIKcGF2a292aWNfdXJsIDwtICJodHRwczovL2dpdGh1Yi5jb20vRFUtQmlpL21vZHVsZS0zLVN0YXQtUi9yYXcvbWFzdGVyL3N0YXQtUl8yMDIxL2RhdGEvcGF2a292aWNfMjAxOS8iCgojIyBEZWZpbmUgdGhlIGxvY2FsIGZvbGRlciBmb3IgdGhpcyBhbmFseXNpcyAod2hlcmUgdGhlIGRhdGEgd2lsbCBiZSBkb3dubG9hZGVkIGFuZCB0aGUgcmVzdWx0cyBnZW5lcmF0ZWQpCnBhdmtvdmljX2ZvbGRlciA8LSAifi9tMy1zdGF0LVIvcGF2a292aWNfYW5hbHlzaXMiCgojIyBEZWZpbmUgYSBzdWItZm9sZGVyIGZvciB0aGUgZGF0YQpwYXZrb3ZpY19kYXRhX2ZvbGRlciA8LSBmaWxlLnBhdGgocGF2a292aWNfZm9sZGVyLCAiZGF0YSIpCgojIyBEb3dubG9hZCBhbmQgbG9hZCB0aGUgZXhwcmVzc2lvbiBkYXRhIHRhYmxlCiMjIE5vdGU6IHdlIHVzZSBjaGVjay5uYW1lcz1GQUxTRSB0byBhdm9pZCByZXBsYWNpbmcgaHlwaGVucyBieSBkb3RzCiMjIGluIHNhbXBsZSBuYW1lcywgYmVjYXVzZSB3ZSB3YW50IHRvIGtlZXAgdGhlbSBhcyBpbiB0aGUgCiMjIG9yaWdpbmFsIGRhdGEgZmlsZXMuIAptZXNzYWdlKCJEb3dubG9hZGluZyBGQSB0cmFuc2NyaXB0b21lIGZpbGVcdCIsICJmYV9yYXdfY291bnRzLnRzdi5neiIsCiAgIlxuXHRmcm9tXHQiLCBwYXZrb3ZpY191cmwpCmZhX2V4cHJfZmlsZSA8LSBkb3dubG9hZF9vbmx5X29uY2UoCiAgdXJsX2Jhc2UgPSBwYXZrb3ZpY191cmwsIAogIGZpbGVfbmFtZSA9ICJmYV9yYXdfY291bnRzLnRzdi5neiIsCiAgbG9jYWxfZm9sZGVyID0gcGF2a292aWNfZGF0YV9mb2xkZXIpCgojIyBMb2FkIHRoZSBleHByZXNkc2lvbiB0YWJsZQptZXNzYWdlKCJMb2FkaW5nIEZBIHRyYW5zY3JpcHRvbWUgZGF0YSBmcm9tXG5cdCIsIGZhX2V4cHJfZmlsZSkKZmFfZXhwcl9yYXcgPC0gcmVhZC5kZWxpbShmaWxlID0gZmFfZXhwcl9maWxlLCAKICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBUUlVFLCAKICAgICAgICAgICAgICAgICAgICAgICByb3cubmFtZXMgPSAxKQoKIyMgRG93bmxvYWQgdGhlIG1ldGFkYXRhIGZpbGUKbWVzc2FnZSgiRG93bmxvYWRpbmcgRkEgbWV0YWRhdGEgZmlsZVx0IiwgImZhX3RyYW5zY3JpcHRvbWVfbWV0YWRhdGEudHN2IiwKICAiXG5cdGZyb21cdCIsIHBhdmtvdmljX3VybCkKZmFfbWV0YV9maWxlIDwtIGRvd25sb2FkX29ubHlfb25jZSgKICB1cmxfYmFzZSA9IHBhdmtvdmljX3VybCwgCiAgZmlsZV9uYW1lID0gImZhX3RyYW5zY3JpcHRvbWVfbWV0YWRhdGEudHN2IiwKICBsb2NhbF9mb2xkZXIgPSBwYXZrb3ZpY19kYXRhX2ZvbGRlcikKCiMjIExvYWQgdGhlIG1ldGFkYXRhCm1lc3NhZ2UoIkxvYWRpbmcgRkEgbWV0YWRhdGEgZnJvbVxuXHQiLCBmYV9tZXRhX2ZpbGUpCmZhX21ldGEgPC0gcmVhZC5kZWxpbShmaWxlID0gZmFfbWV0YV9maWxlLCAKICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXIgPSBUUlVFLCAKICAgICAgICAgICAgICAgICAgICAgICByb3cubmFtZXMgPSAxKQpgYGAKCk5vdXMgcmVnYXJkb25zIGxhIHN0cnVjdHVyZSBkZSBjaGFxdWUgZGF0YWZyYW1lLgoKYGBge3IgaW5zZXBjdCBkYXRhfQpzdHIoZmFfZXhwcl9yYXcpCnN0cihmYV9tZXRhKQpgYGAKCkxlcyBkZXV4IGZpY2hpZXJzIG5lIGRvbm5lbnQgcGFzIGxlcyBvYnNlcnZhdGlvbnMgZGUgbCfDqWNoYW50aWxsb24gZGFucyBsZSBtw6ptZSBvcmRyZToKCmBgYHtyIGNoZWNrIGRhdGEgb3JkZXJ9CmZhX21ldGEkc2FtcGxlTmFtZSA9PSBuYW1lcyhmYV9leHByX3JhdykKYGBgCgpOb3VzIGxlcyByw6lvcmdhbmlzb25zIGxlcyDDqWNoYW50aWxsb25zIGRhbnMgbCdvcmRyZSBkZSBsJ2V4cMOpcmllbmNlOiBjb25kaXRpb24gbm9ybWFsZSwgcHVpcyBkYXkgMSDDoCAxNCBhdmVjIGxlcyAzIHLDqXBsaWNhdHMuCgpgYGB7ciByZW9kZXIgZGF0YX0Kc2FtcGxlX29yZGVyIDwtIGMocGFzdGUocmVwKGMoIm5vcm1hbCIsICJkYXkxIiwgImRheTIiLCAiZGF5MyIsICJkYXk3IiwgImRheTE0IiksIGVhY2ggPSAzKSwKICAgICAgICAgICAgICAgICAgICAgICAgMTozLCBzZXAgPSAiXyIpKQoKZmFfZXhwcl9yYXcgPC0gZmFfZXhwcl9yYXdbLHNhbXBsZV9vcmRlcl0KZmFfbWV0YSA8LSBmYV9tZXRhW21hdGNoKHNhbXBsZV9vcmRlciwgZmFfbWV0YSRzYW1wbGVOYW1lKSxdCgojIFZpZXcoZmFfbWV0YSkKa2FibGUoZmFfbWV0YSwgY2FwdGlvbiA9ICJNZXRkYXRhIGZvciBQYXZrb3ZvYyBGQSB0cmFuc2NyaXB0b21lIikKYGBgCgo9PiBBaW5zaSwgbm91cyBhdm9ucyB1biBqZXUgZGUgZG9ubsOpZXMgYXZlYyB1biDDqWNoYW50aWxsb24gZGUgYHIgbnJvdyhmYV9tZXRhKWAgb2JzZXJ2YXRpb25zIGV0IGRlcyBkb25uw6llcyBkJ2V4cHJlc3Npb24gZGUgYHIgbnJvdyhmYV9leHByX3JhdylgIGfDqG5lcy4KCgojIyMgU3RhdGlzdGlxdWVzIGRlc2NyaXB0aXZlcwoKRGFucyBsZSB0dXRvcmlhbCBzdXIgbGVzIGRhdGFmcmFtZXMgc3VyIGxlIGpldSBkZSBkb25uw6llcyAidXVvIiAocmVsaXNleiBsZSBjb3JyaWfDqSksIG5vdXMgdm91cyBhdm9ucyBkZW1hbmTDqSBkZSBjcsOpZXIgdW4gZGF0YS5mcmFtZSBxdWkgY29sbGVjdGUgbGVzIHN0YXRpc3RpcXVlcyBwYXIgZ8OobmUgZXQgcGFyIMOpY2hhbnRpbGxvbi4gTm91cyB2b3VzIGRlbWFuZG9ucyBkZSByw6lhbGlzZXIgdW5lIMOpdHVkZSBzaW1pbGFpcmUgc3VyIGxlcyBkb25uw6llcyAiRkEiIGF2YW50IGV0IGFwcsOocyBub3JtYWxpc2F0aW9uIGludGVyLcOpY2hhbnRpbGxvbnMgZGVzIGRvbm7DqWVzLiBMZSBjb2RlIGRlIGxhIHBhcnRpZSBhdmFudCBub3JtYWxpc2F0aW9uIGVzdCBkb25uw6kuCgojIyMjIFBhciDDqWNoYW50aWxsb24gYXZhbnQgbm9ybWFsaXNhdGlvbgoKTm91cyBjcsOpb25zIHVuIGRhdGEuZnJhbWUgbm9tbcOpIGBzYW1wbGVfc3RhdF9wcmVub3JtYCBxdWkgY29tcG9ydGUgdW5lIGxpZ25lIHBhciDDqWNoYW50aWxsb24gZXQgdW5lIGNvbG9ubmUgcGFyIHN0YXRpc3RpcXVlLiBOb3VzIGNhbGN1bG9ucyBsZXMgc3RhdGlzdGlxdWVzIHN1aXZhbnRlcyBzdXIgbGVzIHZhbGV1cnMgbG9nMiBkJ2V4cHJlc3Npb24gZGUgY2hhcXVlIMOpY2hhbnRpbGxvbjoKCi0gbW95ZW5uZQotIMOpY2FydC10eXBlCi0gaW50ZXJ2YWxsZSBpbnRlci1xdWFydGlsZXMKLSBwcmVtaWVyIHF1YXJ0aWxlCi0gbcOpZGlhbmUKLSB0cm9pc2nDqG1lIHF1YXJ0aWxlCi0gbWF4aW11bQotIG5vbWJyZSBkZSB2YWxldXJzIG51bGxlcwoKSWwgZXN0IGFmZmljaMOpIGF2ZWMgbGEgZm9uY3Rpb24gYGthYmxlKClgLiAKCmBgYHtyIHNhbXBsZV9zdGF0X3ByZV9ub3JtfQptZXNzYWdlKCJDb21wdXRpbmcgc2FtcGxlLXdpc2Ugc3RhdGlzdGljcyBvbiByYXcgY291bnRzIikKc2FtcGxlX3N0YXRfcHJlbm9ybSA8LSBkYXRhLmZyYW1lKAogIG1lYW4gPSBhcHBseShmYV9leHByX3JhdywgMiwgbWVhbiwgbmEucm0gPSBUUlVFKSwKICBzZCA9IGFwcGx5KGZhX2V4cHJfcmF3LCAyLCBzZCwgbmEucm0gPSBUUlVFKSwKICBpcXIgPSBhcHBseShmYV9leHByX3JhdywgMiwgSVFSLCBuYS5ybSA9IFRSVUUpLAogIFExID0gYXBwbHkoZmFfZXhwcl9yYXcsIDIsIHF1YW50aWxlLCBwID0gMC4yNSwgbmEucm0gPSBUUlVFKSwKICBtZWRpYW4gPSBhcHBseShmYV9leHByX3JhdywgMiwgbWVkaWFuLCBuYS5ybSA9IFRSVUUpLAogIFEzID0gYXBwbHkoZmFfZXhwcl9yYXcsIDIsIHF1YW50aWxlLCBwID0gMC43NSwgbmEucm0gPSBUUlVFKSwKICBtYXggPSBhcHBseShmYV9leHByX3JhdywgMiwgbWF4LCBuYS5ybSA9IFRSVUUpLAogIG51bGwgPSBhcHBseShmYV9leHByX3JhdyA9PSAwLCAyLCBzdW0sIG5hLnJtID0gVFJVRSkKKQoKa2FibGUoc2FtcGxlX3N0YXRfcHJlbm9ybSwgY2FwdGlvbiA9ICJTYW1wbGUtd2lzZSBzdGF0aXN0aWNzIGJlZm9yZSBub3JtYWxpc2F0aW9uLiIpCmBgYAoKIyMjIyBQYXIgZ8OobmUgYXZhbnQgbm9ybWFsaXNhdGlvbgoKTm91cyBjcsOpb25zIGNpLWRlc3NvdXMgdW4gZGF0YS5mcmFtZSBub21tw6kgYGdlbmVfc3RhdF9wcmVub3JtYCBxdWkgY29tcG9ydGUgdW5lIGxpZ25lIHBhciBnw6huZSBldCB1bmUgY29sb25uZSBwYXIgc3RhdGlzdGlxdWUuIE5vdXMgY2FsY3Vsb25zIGxlcyBzdGF0aXN0aXF1ZXMgc3VpdmFudGVzIHN1ciBsZXMgdmFsZXVycyBsb2cyIGRlIGNoYXF1ZSBnw6huZS4KCi0gbW95ZW5uZQotIG3DqWRpYW5lCi0gw6ljYXJ0LXR5cGUKLSBwcmVtaWVyIHF1YXJ0aWxlCi0gdHJvaXNpw6htZSBxdWFydGlsZQotIG1heGltdW0KLSBub21icmUgZGUgdmFsZXVycyBudWxsZXMKLSBpbnRlcnZhbGxlIGludGVyLXF1YXJ0aWxlcwoKQ2VzIHLDqXN1bHRhdHMgc29udCBzdG9ja8OpcyBkYW5zIHVuIGRhdGEuZnJhbWUgYXZlYyAxIGxpZ25lIHBhciDDqWNoYW50aWxsb24gZXQgMSBjb2xvbm5lIHBhciBzdGF0aXN0aXF1ZS4gTm91cyBhZmZpY2hvbnMgbGVzIGxpZ25lcyAxMDAgw6AgMTA5IGRlIGNlIHRhYmxlYXUgZGUgc3RhdGlzdGlxdWVzIGF2ZWMgbGEgZm9uY3Rpb24gYGthYmxlKClgLgoKYGBge3IgZ2VuZV9zdGF0X3ByZV9ub3JtfQojIyBHZW5lLXdpc2Ugc3RhdGlzdGljcyBmb3IgdGhlIHJhdyBjb3VudHMgKHdpbGwgYmUgdXNlZCBmb3Igbm9ybWFsaXNhdGlvbikKbWVzc2FnZSgiQ29tcHV0aW5nIGdlbmUtd2lzZSBzdGF0aXN0aWNzIG9uIHJhdyBjb3VudHMiKQpnZW5lX3N0YXRfcHJlbm9ybSA8LSBkYXRhLmZyYW1lKAogIG1lYW4gPSBhcHBseShmYV9leHByX3JhdywgMSwgbWVhbiwgbmEucm0gPSBUUlVFKSwKICBzZCA9IGFwcGx5KGZhX2V4cHJfcmF3LCAxLCBzZCwgbmEucm0gPSBUUlVFKSwKICBpcXIgPSBhcHBseShmYV9leHByX3JhdywgMSwgSVFSLCBuYS5ybSA9IFRSVUUpLAogIFExID0gYXBwbHkoZmFfZXhwcl9yYXcsIDEsIHF1YW50aWxlLCBwID0gMC4yNSwgbmEucm0gPSBUUlVFKSwKICBtZWRpYW4gPSBhcHBseShmYV9leHByX3JhdywgMSwgbWVkaWFuLCBuYS5ybSA9IFRSVUUpLAogIFEzID0gYXBwbHkoZmFfZXhwcl9yYXcsIDEsIHF1YW50aWxlLCBwID0gMC43NSwgbmEucm0gPSBUUlVFKSwKICBtYXggPSBhcHBseShmYV9leHByX3JhdywgMSwgbWF4LCBuYS5ybSA9IFRSVUUpLAogIG51bGwgPSBhcHBseShmYV9leHByX3JhdyA9PSAwLCAxLCBzdW0sIG5hLnJtID0gVFJVRSkKKQoKa2FibGUoZ2VuZV9zdGF0X3ByZW5vcm1bMTAwOjEwOSwgXSwgY2FwdGlvbiA9ICJHZW5lLXdpc2Ugc3RhdGlzdGljcyBiZWZvcmUgbm9ybWFsaXNhdGlvbiIpCmBgYAoKIyMgMi4gRmlsdHJhZ2UgZXQgbm9ybWFsaXNhdGlvbiBkZXMgZG9ubsOpZXMKCioqKlZvdXMgbidhdmV6IHJpZW4gw6AgY29kZXIgaWNpLiBMZSBjb2RlIGVzdCBmb3VybmkuKioqCgpJbCBleGlzdGUgcGx1c2lldXJzIGZhw6dvbnMgZGUgbm9ybWFsaXNlciBsZXMgZG9ubsOpZXMgZGUgdHJhbnNjcmlwdG9tZSAgdnVlcyBkYW5zIGxlcyBtb2R1bGVzIDQgZXQgNSAoY2YuIHRvdGFsIGNvdW50cywgcXVhbnRpbGVzLCBUTU0sIFJMRSwgbGltbWEgdm9vbSwuLi4pLCBtYWlzIG5vdXMgYXZvbnMgY2hvaXNpIGljaSB1bmUgc29sdXRpb24gc2ltcGxlIHRvdXQgZW4gw6l0YW50IHJvYnVzdGUgcG91ciBub3JtYWxpc2VyIGxlcyBkb25uw6llcyBlbiBzdGFuZGFyZGlzYW50IGxlIDPDqG1lIHF1YW50aWxlLiAKCkxhIG3DqXRob2RlIGNob2lzaWUgaWNpIGNvbnNpc3RlIMOgIDoKCjEuICoqRWNhcnRlciBsZXMgZ8OobmVzICJub24tZMOpdGVjdMOpcyIqKiwgYydlc3Qtw6AtZGlyZSBjZXV4IGF5YW50IGRlcyB2YWxldXJzIG51bGxlcyBkYW5zIGF1IG1vaW5zIDkwJSBkZXMgw6ljaGFudGlsbG9ucy4KCjIuICoqRWNhcnRlciBsZXMgZ8OobmVzIMOgIHBlaW5lIGV4cHJpbcOpcyoqLCBjJ2VzdC3DoC1kaXJlIGNldXggYXlhbnQgdW5lIHZhbGV1ciBtb3llbm5lIDwgMTAgKGFyYml0cmFpcmVtZW50KS4KCjMuICoqU3RhbmRhcmRpc2VyIGxlcyDDqWNoYW50aWxsb25zICoqc3VyIGxlIDPDqG1lIHF1YXJ0aWxlIGRlcyBnw6huZXMgcmVzdGFudHM6IG9uIGRpdmlzZSBsZXMgY29tcHRhZ2VzIGJydXRzIHBhciBsZSAzw6htZSBxdWFydGlsZSBkZSBsJ8OpY2hhbnRpbGxvbiBldCBvbiBtdWx0aXBsaWUgcGFyIGxlIDPDqG1lIHF1YXJ0aWxlIGRlIGwnZW5zZW1ibGUgZGVzIMOpY2hhbnRpbGxvbnMuCgo0LiAqKk5vcm1hbGlzZXIgbGVzIGNvbXB0YWdlcyoqIChhdSBzZW5zIHByb3ByZSwgYydlc3Qtw6AtZGlyZSByYXBwcm9jaGVyIGxldXIgZGlzdHJpYnV0aW9uIGRlIGxhIGRpc3RyaWJ1dGlvbiBnYXVzc2llbm5lKSBwYXIgdW5lIHRyYW5zZm9ybWF0aW9uIGxvZ2FyaXRobWlxdWUgKGxvZzIpLiAKCk5vdXMgZm91cm5pc3NvbnMgY2ktZGVzc291cyBsZSBjb2RlLgoKIyMjIEZpbHRyYWdlIDogw6lsaW1pbmF0aW9uIGRlcyBnw6huZXMgbm9uIGTDqXRlY3TDqXMgb3Ugw6AgcGVpbmUgZXhwcmltw6lzCgpgYGB7ciBnZW5lX2ZpbHRlcmluZ30KIyMgRGF0YSBmaWx0ZXJpbmc6IGdlbmVzIGhhdmluZyBhdCBsZWFzdCA5MCUgbnVsbCB2YWx1ZXMKbWVzc2FnZSgiRmlsdGVyaW5nIHVuZGV0ZWN0ZWQgZ2VuZXMiKQp1bmRldGVjdGVkX2dlbmVzIDwtIGdlbmVfc3RhdF9wcmVub3JtJG51bGwgPj0gbmNvbChmYV9leHByX3JhdykgKiAwLjkKcHJpbnQocGFzdGUwKCJVbmRldGVjdGVkIGdlbmVzIChudWxsIGluID49IDkwJSBzYW1wbGVzKTogIiwgc3VtKHVuZGV0ZWN0ZWRfZ2VuZXMpKSkKCiMjIERhdGEgZmlsdGVyaW5nOiBnZW5lcyBoYXZpbmcgYSBtZWFuIGV4cHJlc3Npb24gPCAxMAptZXNzYWdlKCJGaWx0ZXJpbmcgYmFyZWx5IGV4cHJlc3NlZCBnZW5lcyIpCmJhcmVseV9leHByZXNzZWRfZ2VuZXMgPC0gZ2VuZV9zdGF0X3ByZW5vcm0kbWVhbiA8IDEwCnByaW50KHBhc3RlMCgiQmFyZWx5IGV4cHJlc3NlZCBnZW5lcyAobWVhbiA8IDEwKTogIiwgc3VtKGJhcmVseV9leHByZXNzZWRfZ2VuZXMpKSkKCiMjIEFwcGx5IGZpbHRlcmluZyBvbiBib3RoIGNyaXRlcmlhCmRpc2NhcmRlZF9nZW5lcyA8LSB1bmRldGVjdGVkX2dlbmVzIHwgYmFyZWx5X2V4cHJlc3NlZF9nZW5lcwpwcmludChwYXN0ZTAoIkRpc2NhcmRlZCBnZW5lczogIiwgc3VtKGRpc2NhcmRlZF9nZW5lcykpKQprZXB0X2dlbmVzIDwtICFkaXNjYXJkZWRfZ2VuZXMKcHJpbnQocGFzdGUwKCJLZXB0IGdlbmVzOiAiLCBzdW0oa2VwdF9nZW5lcykpKQoKIyMgR2VuZXMgYWZ0ZXIgZmlsdGVyaW5nCmZhX2V4cHJfZmlsdGVyZWQgPC0gZmFfZXhwcl9yYXdba2VwdF9nZW5lcywgXQoKYGBgCgoKCgoKIyMjIFN0YW5kYXJkaXNhdGlvbiBlbnRyZSDDqWNoYW50aWxsb25zCgpOb3VzIGFwcGxpcXVvbnMgaWNpIHVuZSBtw6l0aG9kZSBzaW1wbGUgbWFpcyBlZmZpY2FjZSBkZSBzdGFuZGFyZGlzYXRpb24KCmBgYHtyIG5vcm1hbGlzYXRpb25fcTN9CiMjIyMgSW50ZXItc2FtcGxlIHN0YW5kYXJkaXNhdGlvbiBvbiB0aGUgUTMgb2YgcmF3IGNvdW50cyAjIyMjCnRvdGFsX3EzIDwtIHF1YW50aWxlKHVubGlzdChmYV9leHByX2ZpbHRlcmVkKSwgcHJvYnMgPSAwLjc1KQpzYW1wbGVfc3RhdF9wcmVub3JtJFEzX2ZpbHRlcmQgPC0gYXBwbHkoZmFfZXhwcl9maWx0ZXJlZCwgMiwgcXVhbnRpbGUsIHByb2JzID0gMC43NSkKc2FtcGxlX3N0YXRfcHJlbm9ybSRzY2FsZV9mYWN0b3IgPC0gMSAvIHNhbXBsZV9zdGF0X3ByZW5vcm0kUTNfZmlsdGVyZCAqIHRvdGFsX3EzCgojIyBBcHBseSBzdGFuZGFyZGlzYXRpb24KZmFfZXhwcl9zdGFuZGFyZCA8LSB0KHQoZmFfZXhwcl9maWx0ZXJlZCkgKiB1bmxpc3Qoc2FtcGxlX3N0YXRfcHJlbm9ybSRzY2FsZV9mYWN0b3IpKQojIyBDaGVjayAzcmQgcXVhbnRpbGUgYWZ0ZXIgc3RhbmRhcmRpc2F0aW9uCmthYmxlKGFwcGx5KGZhX2V4cHJfc3RhbmRhcmQsIDIsIHF1YW50aWxlLCBwcm9icyA9IDAuNzUpLCAKICAgICAgY29sLm5hbWVzID0gIlEzX3N0YW5kYXJkaXNlZCIsIAogICAgICBjYXB0aW9uID0gIlRoaXJkIHF1YXJ0aWxlIG9mIHRoZSBmaWx0ZXJlZCBjb3VudHMgYWZ0ZXIgaW50ZXItc2FtcGxlIHN0YW5kYXJkaXNhdGlvbiBvZiB0aGUgdGhpcmQgcXVhcnRpbGVzLiAiKQojIGJveHBsb3QoZmFfZXhwcl9zdGFuZGFyZCwgaG9yaXpvbnRhbCA9IFRSVUUpCmBgYAoKCgoKIyMjIFRyYW5zZm9ybWF0aW9uIGxvZzIKCk5vdXMgYXBwbGlxdW9ucyB1bmUgdHJhbnNmb3JtYXRpb24gZW4gbG9nMiBkZXMgZG9ubsOpZXMgYnJ1dGVzLCBhcHLDqHMgYXZvaXIgYWpvdXTDqSB1biBlcHNpbG9uICRcZXBzaWxvbiA9IDEkIChsZXMgdmFsZXVycyBudWxsZXMgc2Vyb250IGRvbmMgcmVwcsOpc2VudMOpZXMgcGFyIHVuIGxvZzIoY291bnRzKSB2YWxhbnQgJDAkLiBOb3VzIHN0b2Nrb25zIGxlIHLDqXN1bHRhdCBkYW5zIHVuIGRhdGEuZnJhbWUgbm9tbcOpIGBmYV9leHByX2xvZzJgLgoKTm91cyBhZmZpY2hvbnMgdW4gZnJhZ21lbnQgZGVzIHRhYmxlYXV4IGBmYV9leHByX3Jhd2AgZXQgYGZhX2V4cHJfbG9nMmAgZW4gc8OpbGVjdGlvbm5hbnQgbGVzIGxpZ25lcyAxMDAgw6AgMTA5IGV0IGxlcyBjb2xvbm5lcyA1IMOgIDEwLCBhZmluIGRlIG5vdXMgYXNzdXJlciBxdWUgbGEgdHJhbnNmb3JtYXRpb24gZW4gbG9nMiBhIGJpZW4gZm9uY3Rpb25uw6kuIAoKYGBge3IgbG9nMl90cmFuc2Zvcm19CiMjIExvZzIgdHJhbnNmb3JtYXRpb24gb2YgdGhlIHRyYW5zY3JpcHRvbWUgZGF0YQplcHNpbG9uIDwtIDEKZmFfZXhwcl9sb2cyIDwtIGxvZzIoZmFfZXhwcl9zdGFuZGFyZCArIGVwc2lsb24pCiMgZGltKGZhX2V4cHJfbG9nMikKIyBWaWV3KGhlYWQoZmFfZXhwcl9sb2cyKSkKCiMjIERpc3BsYXkgb2YgYSBmcmFnbWVudCBvZiB0aGUgZGF0YSBiZWZvcmUgYW5kIGFmdGVyIGxvZzIgdHJhbnNmb3JtYXRpb24Ka2FibGUoZmFfZXhwcl9yYXdbMTAwOjEwOSwgNToxMF0sIGNhcHRpb24gPSAiRnJhZ21lbnQgZGVzIGRvbm7DqWVzIHRyYW5zY3JpcHRvbWlxdWVzIGJydXRlcyIpCmthYmxlKGZhX2V4cHJfbG9nMlsxMDA6MTA5LCA1OjEwXSwgY2FwdGlvbiA9ICJGcmFnbWVudCBkZXMgZG9ubsOpZXMgdHJhbnNjcmlwdG9taXF1ZXMgYXByw6hzIHRyYW5zZm9ybWF0aW9uIGxvZzIiKQpgYGAKCiMjIDMuIFN0YXRpc3RpcXVlcyBkZXNjcmlwdGl2ZXMgc3VyIGxlcyBkb25uw6llcyBub3JtYWxpc8OpZXMKCioqKkEgdm91cyBkZSBqb3VlciEqKioKCiMjIyBTdGF0aXN0aXF1ZXMgcGFyIGfDqG5lIGFwcsOocyBub3JtYWxpc2F0aW9uCgpHw6luw6lyZXogdW4gZGF0YS5mcmFtZSBub21tw6llIGBnZW5lX3N0YXRfbm9ybWAgYXZlYyB1bmUgbGlnbmUgcGFyIGfDqG5lIMOgIHBhcnRpciBkdSB0YWJsZWF1IGRlIGRvbm7DqWVzIG5vcm1hbGlzw6llcywgYXZlYyBsZXMgc3RhdGlzdGlxdWVzIHN1aXZhbnRlcyAodW5lIHN0YXRpc3RpcXVlIHBhciBjb2xvbm5lKToKCi0gbW95ZW5uZQotIHZhcmlhbmNlCi0gw6ljYXJ0LXR5cGUKLSBjb2VmZmljaWVudCBkZSB2YXJpYXRpb24gKMOpY2FydC10eXBlIGRpdmlzw6kgcGFyIGxhIG1veWVubmUpCi0gaW50ZXJ2YWxsZSBpbnRlci1xdWFydGlsZXMKLSBtaW5pbXVtCi0gbcOpZGlhbmUKLSBtYXhpbXVtCgpgYGB7ciBnZW5lX3N0YXRfcG9zdF9ub3JtfQojIyBHZW5lLXdpc2Ugc3RhdGlzdGljcyBhZnRlciBub3JtYWxpc2F0aW9uCm1lc3NhZ2UoIkNvbXB1dGluZyBnZW5lLXdpc2Ugc3RhdGlzdGljcyBvbiBsb2cyLXRyYW5zZm9ybWVkIGFuZCBub3JtYWxpc2VkIGNvdW50cyIpCmdlbmVfc3RhdF9ub3JtIDwtIGRhdGEuZnJhbWUoCiAgbWVhbiA9IGFwcGx5KGZhX2V4cHJfbG9nMiwgMSwgbWVhbiwgbmEucm0gPSBGKSwKICB2YXIgPSBhcHBseShmYV9leHByX2xvZzIsIDEsIHZhciwgbmEucm0gPSBUUlVFKSwKICBzZCA9IGFwcGx5KGZhX2V4cHJfbG9nMiwgMSwgc2QsIG5hLnJtID0gRiksCiAgQ1YgPSBOQSwKICBtaW4gPSBhcHBseShmYV9leHByX2xvZzIsIDEsIG1pbiwgbmEucm0gPSBUUlVFKSwKICBRMSA9IGFwcGx5KGZhX2V4cHJfbG9nMiwgMSwgcXVhbnRpbGUsIHAgPSAwLjI1LCBuYS5ybSA9IFRSVUUpLAogIG1lZGlhbiA9IGFwcGx5KGZhX2V4cHJfbG9nMiwgMSwgbWVkaWFuLCBuYS5ybSA9IFRSVUUpLAogIFEzID0gYXBwbHkoZmFfZXhwcl9sb2cyLCAxLCBxdWFudGlsZSwgcCA9IDAuNzUsIG5hLnJtID0gVFJVRSksCiAgbWF4ID0gYXBwbHkoZmFfZXhwcl9sb2cyLCAxLCBtYXgsIG5hLnJtID0gVFJVRSksCiAgbnVsbCA9IGFwcGx5KGZhX2V4cHJfbG9nMiA9PSAwLCAxLCBzdW0sIG5hLnJtID0gVFJVRSkKICApCmdlbmVfc3RhdF9ub3JtJENWIDwtIGdlbmVfc3RhdF9ub3JtJHNkIC8gZ2VuZV9zdGF0X25vcm0kbWVhbgpgYGAKCiMjIyBBbm5vdGF0aW9uIGRlcyBnw6huZXMKCkNoYXF1ZSBnw6huZSDDqXRhbnQgZG9ubsOpIHBhciBzb24gaWRlbnRpZmlhbnQgZGFucyBsYSBiYXNlIGRlIGRvbm7DqWVzIEVOU0VNQkwgdm91cyB1dGlsaXNlcmV6IGxlIGBwYXF1ZXQgYmlvbWFSdCBkZSBiaW9jb25kdWN0b3JgIHBvdXIgYWpvdXRlciBkZXMgYW5ub3RhdGlvbnMgOiBzeW1ib2xlLCBjaHJvbW9zb21lLCBjb29yZG9ubsOpZXMgZ8Opbm9taXF1ZXMsIGJyaW4uIApTdWl2ZXogcGFzIMOgIHBhcyBsYSBtw6l0aG9kZSBwcm9wb3PDqWUgKCoqKmNlcnRhaW5lcyDDqXRhcGVzIHBldXZlbnQgcHJlbmRyZSBxdWVscXVlcyBtaW51dGVzKioqKToKCiAtIGNoYXJnZXogbGUgcGFxdWV0IGJpb21hUnQsIHZvaXJlIGluc3RhbGxlci1sZSB1bmlxdWVtZW50IHNpIG7DqWNlc3NhaXJlLiBJbmRpcXVleiBsZSBjb2RlIMOgIGwnZW1wbGFjZW1lbnQgYWTDqXF1YXQgZGFucyBkZSAuUm1kLgoKIC0gc8OpbGVjdGlvbm5leiBsYSBiYXNlIGRlIGRvbm7DqWVzIEVOU0VNQkwgYXZlYyBsYSBmb25jdGlvbiBgdXNlTWFydCgpYC4gQXR0ZW50aW9uIMOgIGNob2lzaXIgbGUgYm9uIGfDqW5vbWUgYXZlYyBsJ2FndW1lbnQgYGRhdGFzZXRgOiBgbW11c2N1bHVzX2dlbmVfZW5zZW1ibGAKIAogLSBhdmVjIGxhIGZvbmN0aW9uIGBnZXRCTSgpYCByw6ljdXDDqXJleiBkZSBsYSBiYXNlIGRlIGRvbm7DqWVzIEVOU0VNQkwgbGVzIGNoYW1wcyBkZW1hbmTDqXMgKCoqKnBvdXIgc3ltYm9sZSB1dGlsaXNleiBleHRlcm5hbF9nZW5lX25hbWUqKiopIGVuIGFwcGxpcXVhbnQgImVuc2VtYmxfZ2VuZWlkIiBwb3VyIGwnYWd1bWVudCBgZmlsdGVyYCBldCBlbiBpbmRpcXVhbnQgcG91ciBsJ2FyZ3VtZW50IGB2YWx1ZXNgIGxlIHZlY3RldXIgZGVzIGlkZW50aWZpYW50cyBkZXMgZ8OobmVzIHByw6lzZW50cyBkYW5zIGxlIGRhdGFmcmFtZSBgZ2VuZV9zdGF0X25vcm1gLiBWb3VzIG9idGVuZXogdW4gZGF0YWZyYW1lLgogCkEgcHLDqXNlbnQsIGFqb3V0ZXogYXUgZGF0YWZyYW1lIGBnZW5lX3N0YXRfbm9ybWAgZW4gMcOocmVzIGNvbG9ubmVzIGxlcyBhbm5vdGF0aW9ucyByZXRyb3V2w6llcyBncsOiY2Ugw6AgYmlvbWFSdC4gQXR0ZW50aW9uLCBjZXJ0YWlucyBnw6huZXMgbmUgc29udCBwYXMgcmV0cm91dsOpcyBkYW5zIGxhIHZlcnNpb24gZCdFTlNFTUJMIHN1ciBiaW9tYVJ0IGRvbmMgbGFpc3NleiBkZXMgTkEgY29tbWUgZG9ubsOpZXMgbWFucXVhbnRlcyBkYW5zIGNlIGNhcy4gTm91cyB2b3VzIHJlY29tbWFuZG9ucyBkJ3V0aWxpc2VyIGxhIGZ1bmN0aW9uIGBtZXJnZSgpYCBkZSBSIGJhc2Ugb3UgYmllbiBgbGVmdF9qb2luKClgIGRlIGBkcGx5cmAgcG91ciBmdXNpb25uZXIgbGVzIGRldXggZGF0YWZyYW1lcyBlbiB1biBzZXVsLgogCmBgYHtyIGdlbmVfYW5ub3RhdGlvbnN9CiMjIyBHZW5lIGFubm90YXRpb25zICMjIyMKbWVzc2FnZSgiR2V0dGluZyBnZW5lIGFubm90YXRpb25zIikKCiMjIE9wZW4gYSBjb25uZWN0aW9uIHRvIEVuc2VtYmwgTUFSVAptZXNzYWdlKCJPcGVuaW5nIGNvbm5lY3Rpb24gdG8gRW5zZW1ibCBNQVJUIikKZW5zZW1ibCA8LSB1c2VNYXJ0KCJFTlNFTUJMX01BUlRfRU5TRU1CTCIsIAogICAgICAgICAgICAgICAgICAgaG9zdCA9ICJ3d3cuZW5zZW1ibC5vcmciLCAKICAgICAgICAgICAgICAgICAgIGRhdGFzZXQgPSAibW11c2N1bHVzX2dlbmVfZW5zZW1ibCIpCgojIyBHZXQgZ2VuZSBhbm5vdGF0aW9ucwptZXNzYWdlKCJHZXR0aW5nIGdlbmUgYW5ub3RhdGlvbnMiKQpnZW5lcyA8LSBnZXRCTShhdHRyaWJ1dGVzID0gYygiZW5zZW1ibF9nZW5lX2lkIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJleHRlcm5hbF9nZW5lX25hbWUiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNocm9tb3NvbWVfbmFtZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzdGFydF9wb3NpdGlvbiIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZW5kX3Bvc2l0aW9uIiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzdHJhbmQiKSwgCiAgICAgICAgICAgICAgIGZpbHRlciA9ICJlbnNlbWJsX2dlbmVfaWQiLAogICAgICAgICAgICAgICB2YWx1ZXMgPSByb3cubmFtZXMoZ2VuZV9zdGF0X25vcm0pLAogICAgICAgICAgICAgICBtYXJ0ID0gZW5zZW1ibCkKICAKIyMgTWVyZ2UgZ2VuZSBhbm5vdGF0aW9ucyBhbmQgZXhwcmVzc2lvbiBzdGF0aXN0aWNzCmdlbmVfc3RhdF9ub3JtIDwtIG1lcmdlKGdlbmVzLCBnZW5lX3N0YXRfbm9ybSwgYnkueCA9ICJlbnNlbWJsX2dlbmVfaWQiLCBieS55ID0gMCwgc29ydCA9IEZBTFNFKQoKa2FibGUoZ2VuZV9zdGF0X25vcm1bMTAwOjEwOSwgXSwgY2FwdGlvbiA9ICJHZW5lLXdpc2Ugc3RhdGlzdGljcyBhZnRlciBub3JtYWxpc2F0aW9uIikKYGBgCgoqKkNoYWxsZW5nZSBmYWxjdWx0YXRpZjoqKgoKUsOpb3Jkb25uZXogbGVzIGfDqG5lcyBwYXIgcG9zaXRpb24gZ8Opbm9taXF1ZSBldCBhZmZpY2hleiBsZXMgbGlnbmVzIDUgcHJlbWnDqHJlcyBldCAgNSBkZXJuacOocmVzIGxpZ25lcyBkZSBjZSB0YWJsZWF1IGRlIHN0YXRpc3RpcXVlcy4gCgpgYGB7ciBzb3J0X2dlbmVzX2J5X2Nocm9tfQojIyMjIFNvcnRpbmcgZ2VuZXMgYnkgY2hyb21vc29tZSAjIyMjCm1lc3NhZ2UoIlNvcnRpbmcgZ2VuZXMgYnkgY2hyb21vc29tZSIpCgoKZ2VuZV9zdGF0X25vcm0gPC0gZ2VuZV9zdGF0X25vcm1bb3JkZXIoZ2VuZV9zdGF0X25vcm0kY2hyb21vc29tZV9uYW1lLCBnZW5lX3N0YXRfbm9ybSRzdGFydF9wb3NpdGlvbiksXQoKa2FibGUoZ2VuZV9zdGF0X25vcm1bYygxOjUsIChucm93KGdlbmVfc3RhdF9ub3JtKSAtIDQpOm5yb3coZ2VuZV9zdGF0X25vcm0pKSwgXSwgCiAgICAgIGNhcHRpb24gPSAiR2VuZS13aXNlIHN0YXRpc3RpY3MgYWZ0ZXIgbm9ybWFsaXNhdGlvbi4iKQpgYGAKCgojIyMgRGlzdHJpYnV0aW9uIGRlcyBkb25uw6llcwoKLSBEZXNzaW5leiBzb3VzIGZvcm1lIGQndW4gaGlzdG9ncmFtbWUgbGEgZGlzdHJpYnV0aW9uIGRlcyB2YWxldXJzIGFwcsOocyBub3JtYWxpc2F0aW9uICh0b3VzIMOpY2hhbnRpbGxvbnMgY29uZm9uZHVzKQoKYGBge3IgZmFfZXhwcl9ub3JtX2Rpc3RyaWIsIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTUsIG91dC53aWR0aD0iNzAlIiwgZmlnLmNhcD0iRGlzdHJpYnV0aW9uIG9mIGV4cHJlc3Npb24gdmFsdWVzIChsb2cyIGNvdW50cykgYWZ0ZXIgZ2VuZSBmaWx0ZXJpbmcgYW5kIHN0YW5kYXJkaXNhdGlvbiBvbiB0aGUgc2FtcGxlLXdpc2UgdGhpcmQtcXVhcnRpbGUgb2Ygbm9uLW51bGwgdmFsdWVzLiBUaGUgdmVydGljYWwgbGluZSBoaWdobGlnaHRzIHRoZSBtZWFuIHZhbHVlLiAifQpoaXN0KHVubGlzdChmYV9leHByX2xvZzIpLCAKICAgICBicmVha3MgPSBzZXEoZnJvbSA9IDAsIHRvID0gbWF4KGZhX2V4cHJfbG9nMikgKyAxLCBieSA9IDAuMjUpLAogICAgIHhsYWIgPSAibG9nMihjb3VudHMpIGFmdGVyIHN0YW5kYXJkaXNhdGlvbiIsIAogICAgIHlsYWIgPSAibnVtYmVyIG9mIGdlbmVzIGFmdGVyIGZpbHRlcmluZyIsCiAgICAgY29sID0gIiNCQkRERkYiLAogICAgIGxhcyA9IDEsIGNleC5heGlzID0gMC44LAogICAgIG1haW4gPSAiZGlzdHJpYnV0aW9uIGFmdGVyIHN0YW5kYXJkaXNhdGlvbiIpCmFibGluZSh2ID0gbWVhbihmYV9leHByX2xvZzIpLCBjb2wgPSAiZGFya2dyZWVuIiwgbHdkID0gMikKYGBgCgotIERlc3NpbmV6IHVuIGJveCBwbG90IHBhciDDqWNoYW50aWxsb24gYXZhbnQgZXQgYXByw6hzIG5vcm1hbGlzYXRpb24sIGV0IGNvbW1lbnRleiBsYSBmYcOnb24gZG9udCBsJ2VmZmV0IGRlIGxhIG5vcm1hbGlzYXRpb24gYXBwYXJhw650IHN1ciBjZXMgZ3JhcGhpcXVlcy4gCgpgYGB7ciBib3hwbG90c19ub3JtYWxpc2F0aW9uX2ltcGFjdCwgZmlnLndpZHRoPTEwLCBmaWcuaGVpZ2h0PTEyLCBvdXQud2lkdGg9IjEwMCUiLCBmaWcuY2FwPSJCb3ggcGxvdHMgc2hvd2luZyB0aGUgaW1wYWN0IG9mIG5vcm1hbGlzYXRpb24ifQojIyMjIEJveCBwbG90cyB0byBzaG93IG5vcm1hbGlzYXRpb24gaW1wYWN0ICMjIyMKcGFyKG1hciA9IGMoNCw2LDQsMSkpICMjIFNldCB0aGUgbWFyZ2lucwpwYXIobWZyb3cgPSBjKDIsMikpCmJveHBsb3QoZmFfZXhwcl9yYXcsIAogICAgICAgIGhvcml6b250YWwgPSBUUlVFLAogICAgICAgIHhsYWIgPSAiY291bnRzIiwgCiAgICAgICAgbGFzID0gMSwgCiAgICAgICAgY29sID0gZmFfbWV0YSRjb2xvciwgCiAgICAgICAgbWFpbiA9ICJSYXcgY291bnRzLCBhbGwgZ2VuZXMiKQpib3hwbG90KGZhX2V4cHJfZmlsdGVyZWQsIAogICAgICAgIGhvcml6b250YWwgPSBUUlVFLCAKICAgICAgICB4bGFiID0gImNvdW50cyIsIAogICAgICAgIGxhcyA9IDEsIAogICAgICAgIGNvbCA9IGZhX21ldGEkY29sb3IsIAogICAgICAgIG1haW4gPSAiUmF3IGNvdW50cywgZmlsdGVyZWQgZ2VuZXMiKQpib3hwbG90KGZhX2V4cHJfc3RhbmRhcmQsIAogICAgICAgIGhvcml6b250YWwgPSBUUlVFLCAKICAgICAgICB4bGFiID0gImNvdW50cyIsIAogICAgICAgIGxhcyA9IDEsIAogICAgICAgIGNvbCA9IGZhX21ldGEkY29sb3IsIAogICAgICAgIG1haW4gPSAiU3RhbmRhcmRpc2VkIGNvdW50cyAoc2FtcGxlIFEzKSIpCmJveHBsb3QoZmFfZXhwcl9sb2cyLCAKICAgICAgICB4bGFiID0gImxvZzIoY291bnRzKSIsIAogICAgICAgIGxhcyA9IDEsIAogICAgICAgIGhvcml6b250YWwgPSBUUlVFLCAKICAgICAgICBjb2wgPSBmYV9tZXRhJGNvbG9yLCAKICAgICAgICBtYWluID0gIk5vcm1hbGlzZWQgY291bnRzIikKcGFyKG1mcm93ID0gYygxLCAxKSkKcGFyKG1hciA9IGMoNCw1LDUsMSkpCmBgYAoKIyMgNC4gQW5hbHlzZSBkZSByZWdyb3VwZW1lbnQgZGVzIGRvbm7DqWVzCgoqKipBIHZvdXMgZGUgam91ZXIhKioqCgojIyMgU8OpbGVjdGlvbiBkZSBnw6huZXMgZCdleHByZXNzaW9uIMOpbGV2w6llIGV0IHZhcmlhYmxlCgpQb3VyIHLDqWR1aXJlIGxlIG5vbWJyZSBkZSBnw6huZXMsIG5vdXMgYWxsb25zIMOpY2FydGVyIGxlcyBnw6huZXMgZmFpYmxlbWVudCBleHByaW3DqXMgKGxvZzIgbW95ZW4gaW5mw6lyaWV1ciDDoCA0KSwgZXQgbmUgcmV0ZW5pciBxdWUgY2V1eCBxdWkgbW9udHJlbnQgZGVzIHZhcmlhdGlvbnMgaW1wb3J0YW50ZXMgZW50cmUgw6ljaGFudGlsbG9ucy4gUG91ciBjZSBkZXJuaWVyIGNyaXTDqHJlLCBub3VzIG5vdXMgYmFzb25zIHN1ciBsYSB2YXJpYW5jZS4gCgo8IS0tIFPDqWxlY3Rpb25uZXogbGVzIGfDqG5lcyBheWFudCB1biBuaXZlYXUgbG9nMiBtb3llbiBtaW5pbWFsIHN1cMOpcmlldXIgw6AgMyAoJG0gPiAzJCkgZXQgdW4gY29lZmZpY2llbnQgZGUgdmFyaWF0aW9uIHN1cMOpcmlldXIgw6AgMC41ICgkQ1YgPiAwLjUkKS4gTm90ZTogY2VzIHZhbGV1cnMgc29udCBwYXJmYWl0ZW1lbnQgYXJiaXRyYWlyZXMsIGVsbGVzIG9udCDDqXTDqSBjaG9pc2llcyBwb3VyIG9idGVuaXIgdW4gbm9tYnJlIHJhaXNvbm5hYmxlIGRlIGfDqG5lcy4gIC0tPgoKU8OpbGVjdGlvbm5leiBsZXMgZ8OobmVzIGF5YW50IHVuIG5pdmVhdSBsb2cyIG1veWVuIG1pbmltYWwgc3Vww6lyaWV1ciDDoCA1ICgkbSA+IDUkKSBldCB1bmUgdmFyaWFuY2Ugc3Vww6lyaWV1cmUgw6AgMiAoJHNeMiA+IDIkKS4gTm90ZTogY2VzIHZhbGV1cnMgc29udCBwYXJmYWl0ZW1lbnQgYXJiaXRyYWlyZXMsIGVsbGVzIG9udCDDqXTDqSBjaG9pc2llcyBwb3VyIG9idGVuaXIgdW4gbm9tYnJlIHJhaXNvbm5hYmxlIGRlIGfDqG5lcy4gCgpgYGB7ciBnZW5lX3NlbGVjdGlvbn0KIyMjIyBTZWxlY3Rpb24gb2YgYSBzdWJzZXQgb2YgZ2VuZXMgd2l0aCBpZ2ggZXhwcmVzc2lvbiBhbmQgdmFyaWFuY2UgIyMjIwptZXNzYWdlKCJTZWxlY3RpbmcgZ2VuZXMgd2l0aCBoaWdoIGV4cHJlc3Npb24gYW5kIHZhcmlhbmNlIikKCiMjIENvbXB1dGUgYSBCb29sZWFuIHZlY3RvciBpbmRpY2F0aW5nIHdoZXRoZXIgZWFjaCBnZW5lIHBhc3NlcyBvciBub3QgdGhlIGV4cHJlc3Npb24gbGV2ZWwgdGhyZXNob2xkCmhpZ2hfZXhwcmVzc2lvbiA8LSBnZW5lX3N0YXRfbm9ybSRtZWFuID4gNQojIHRhYmxlKGhpZ2hfZXhwcmVzc2lvbikgIyBjb3VudCBudW1iZXIgb2YgZ2VuZXMgd2l0aCBoaWdoL3dlYWsgZXhwcmVzc2lvbgoKIyMgQ29tcHV0ZSBhIEJvb2xlYW4gdmVjdG9yIGluZGljYXRpbmcgd2hldGhlciBlYWNoIGdlbmUgcGFzc2VzIG9yIG5vdCB0aGUgdmFyaWFuY2UgdGhyZXNob2xkCmhpZ2hfdmFyaWFuY2UgPC0gZ2VuZV9zdGF0X25vcm0kdmFyID4gMgojIHRhYmxlKGhpZ2hfdmFyaWFuY2UpICMgY291bnQgbnVtYmVyIG9mIGdlbmVzIHdpdGggd2VhayBoaWdoIHZhcmlhbmNlCgojIyBTZWxlY3QgZ2VuZXMgaGF2aW5nIGJvdGggYSBoaWdoIG1lYW4gZXhwcmVzc2lvbiBhbmQgYSBoaWdoIHZhcmlhbmNlCnNlbGVjdGVkX2dlbmVzIDwtIGhpZ2hfdmFyaWFuY2UgJiBoaWdoX2V4cHJlc3Npb24KIyB0YWJsZShzZWxlY3RlZF9nZW5lcykgIyBjb3VudCBudW1iZXIgb2YgZ2VuZXMgd2l0aCB3ZWFrIGhpZ2ggY29lZmZmaWNpZW50IG9mIHZhcmlhdGlvbgpwcmludChwYXN0ZTAoIlNlbGVjdGVkIGdlbmVzOiAiLCBzdW0oc2VsZWN0ZWRfZ2VuZXMpKSkKCiMjIENyZWF0ZSBhIGRhdGEgZnJhbWUgd2l0aCB0aGUgZXhwcmVzc2lvbiBvZiB0aGUgc2VsZWN0ZWQgZ2VuZXMKZmFfZXhwcl9zZWxlY3RlZCA8LSBmYV9leHByX2xvZzJbc2VsZWN0ZWRfZ2VuZXMsIF0KYGBgCgpEZXNzaW5leiBkZXMgaGlzdG9ncmFtbWVzIGRlcyB2YWxldXJzIGQnZXhwcmVzc2lvbiBhdmFudCBldCBhcHLDqHMgY2V0dGUgc8OpbGVjdGlvbiBkZSBnw6huZXMsIGV0IGNvbW1lbnRleiBsZXMgZGlmZsOpcmVuY2VzLiAKCmBgYHtyIGhpc3RfZXhwcl9zZWxlY3RlZF9nZW5lcywgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9Niwgb3V0LndpZHRoPSIxMDAlIiwgZmlnLmNhcD0iRGlzdHJpYnV0aW9uIG9mIGV4cHJlc3Npb24gdmFsdWVzIGJlZm9yZSBhbmQgYWZ0ZXIgZ2VuZSBzZWxlY3Rpb24ifQojIyMjIEhpc3RvZ3JhbXMgb2YgZXhwcmVzc2lvbiBiZWZvcmUgYW5kIGFmdGVyIGdlbmUgc2VsZWN0aW9uICMjIyMKcGFyKG1mcm93ID0gYygyLDEpKQpoaXN0KHVubGlzdChmYV9leHByX2xvZzIpLCAKICAgICBicmVha3MgPSBzZXEoZnJvbSA9IDAsIHRvID0gbWF4KGZhX2V4cHJfbG9nMikgKyAxLCBieSA9IDAuMjUpLAogICAgIGxhcyA9IDEsIAogICAgIGNleC5heGlzID0gMC44LCAKICAgICBtYWluID0gIlN0YW5kYXJkaXplZCB2YWx1ZXMgYmVmb3JlIGdlbmUgc2VsZWN0aW9uIiwKICAgICBjb2wgPSAgIiNEREJCRkYiKQoKaGlzdCh1bmxpc3QoZmFfZXhwcl9zZWxlY3RlZCksIAogICAgIGJyZWFrcyA9IHNlcShmcm9tID0gMCwgdG8gPSBtYXgoZmFfZXhwcl9sb2cyKSArIDEsIGJ5ID0gMC4yNSksCiAgICAgbGFzID0gMSwgCiAgICAgY2V4LmF4aXMgPSAwLjgsIAogICAgIG1haW4gPSAiU3RhbmRhcmRpemVkIHZhbHVlcyBhZnRlciBnZW5lIHNlbGVjdGlvbiIsCiAgICAgY29sID0gICIjRkZEREJCIikKCnBhcihtZnJvdyA9IGMoMSwxKSkKCmBgYAoKRGVzc2luZXogdW4gYm94IHBsb3QgcGFyIMOpY2hhbnRpbGxvbiBkZXMgdmFsZXVycyBkJ2V4cHJlc3Npb24gYXZhbnQgZXQgYXByw6hzIHPDqWxlY3Rpb24gZGVzIGfDqG5lcywgZXQgY29tbWVudGV6IGxlIHLDqXN1bHRhdC4gCgpgYGB7ciBib3hwbG90c19leHByX3NlbGVjdGVkX2dlbmVzLCBmaWcud2lkdGg9MTAsIGZpZy5oZWlnaHQ9NSwgb3V0LndpZHRoPSI2MCUiLCBmaWcuY2FwPSJCb3ggcGxvdHMgb2Ygc3RhbmRhcmRpc2VkIGV4cHJlc3Npb24gdmFsdWVzIGJlZm9yZSBhbmQgYWZ0ZXIgZ2VuZSBzZWxlY3Rpb24uICJ9CiMjIyMgQm94cGxvdHMgb2YgZXhwcmVzc2lvbiBiZWZvcmUgYW5kIGFmdGVyIGdlbmUgc2VsZWN0aW9uICMjIyMKCnBhcihtZnJvdyA9IGMoMSwyKSkKCmJveHBsb3QoZmFfZXhwcl9sb2cyLCAKICAgICAgICBob3Jpem9udGFsID0gVFJVRSwKICAgICAgICB4bGFiID0gImxvZzIoY291bnRzKSIsIAogICAgICAgIGxhcyA9IDEsIAogICAgICAgIGNvbCA9IGZhX21ldGEkY29sb3IsIAogICAgICAgIG1haW4gPSAiQmVmb3JlIGdlbmUgc2VsZWN0aW9uIikKYm94cGxvdChmYV9leHByX3NlbGVjdGVkLCAKICAgICAgICBob3Jpem9udGFsID0gVFJVRSwKICAgICAgICB4bGFiID0gImxvZzIoY291bnRzKSIsIAogICAgICAgIGxhcyA9IDEsIAogICAgICAgIGNvbCA9IGZhX21ldGEkY29sb3IsIAogICAgICAgIG1haW4gPSAiQWZ0ZXIgZ2VuZSBzZWxlY3Rpb24iKQoKcGFyKG1mcm93ID0gYygxLDEpKQpgYGAKCgojIyMgQUNQCgpEZXNzaW5leiB1biBwbG90IEFDUCBkZXMgw6ljaGFudGlsbG9ucyBlbiBsZXMgY29sb3JhbnQgcGFyIGNvbmRpdGlvbiBhdmFudCBldCBhcHLDqHMgbm9ybWFsaXNhdGlvbi4KCi0gYXZlYyBsZXMgY29tcHRhZ2VzIGJydXRzIGRlIGxhIG1hdHJpY2UgZCdleHByZXNzaW9uIGluaXRpYWxlICgkZmFfZXhwciQpCgpgYGB7ciBhY3BfcmF3X2FsbF9nZW5lcywgZmlnLndpZHRoPTgsIGZpZy5oZWlnaHQ9OCwgb3V0LndpZHRoPSI2MCUiLCBmaWcuY2FwPSJQQyBwbG90IG9mIHRoZSBzYW1wbGVzIGZyb20gdGhlIHJhdyBleHByZXNzaW9uIHZhbHVlcyBvZiBhbGwgZ2VuZXMuICJ9CiMjIyMgUENBIGZyb20gcmF3IGNvdW50cywgYWxsIGdlbmVzICMjIyMKbWVzc2FnZSgiUnVubmluZyBQQ0Egd2l0aCByYXcgY291bnRzLCBhbGwgZ2VuZXMiKQoKIyMgUmF3IGV4cHJlc3Npb24gdmFsdWVzLCBhbGwgZ2VuZXMKbWFfcGNhX3Jhd190dCA8LSBQQ0EodChmYV9leHByX3JhdyksIAogICAgICAgICAgICAgICAgICAgICAgc2NhbGUudW5pdCA9IEZBTFNFLCAKICAgICAgICAgICAgICAgICAgICAgIGdyYXBoID0gRkFMU0UpCiMgcGxvdChtYV9wY2FfcmF3X3R0LCBjaG9peCA9ICJpbmQiKQpmdml6X3BjYV9pbmQobWFfcGNhX3Jhd190dCwgY29sLmluZCA9IGZhX21ldGFbLCJjb25kaXRpb24iXSkKYGBgCgoKLSBhdmVjIGxhIG1hdHJpY2UgZGUgdmFsZXVycyBub3JtYWxpc8OpZXMgZGVzIGfDqG5lcyBmaWx0csOpcwoKYGBge3IgYWNwX25vcm1fZmlsdGVyZWRfZ2VuZXMsIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTgsIG91dC53aWR0aD0iNjAlIiwgZmlnLmNhcD0iUEMgcGxvdCBvZiB0aGUgc2FtcGxlcyBmcm9tIG5vcm1hbGlzZWQgY291bnRzLCBiZWZvcmUgZ2VuZSBzZWxlY3Rpb24uICJ9CiMjIyMgUENBIGZyb20gbm9ybWFsaXNlZCBjb3VudHMsIGFsbCBnZW5lcyAjIyMjCm1lc3NhZ2UoIlJ1bm5pbmcgUENBIHdpdGggbm9ybWFsaXNlZCBjb3VudHMsIGFsbCBnZW5lcyIpCgptYV9wY2FfZmlsdGVyZWQgPC0gUENBKHQoZmFfZXhwcl9sb2cyKSwgc2NhbGUudW5pdCA9IEZBTFNFLAogICAgICAgICAgICAgICAgICBncmFwaCA9IEZBTFNFKQojIHBsb3QobWFfcGNhX2ZpbHRlcmVkLCBjaG9peCA9ICJ2YXIiKQojIHBsb3QobWFfcGNhX3NlbCwgY2hvaXggPSAiaW5kIikKZnZpel9wY2FfaW5kKG1hX3BjYV9maWx0ZXJlZCwgY29sLmluZCA9IGZhX21ldGFbLCAiY29uZGl0aW9uIl0pCmBgYAoKLSBhdmVjIGxhIG1hdHJpY2UgZmluYWxlICh0cmFuc2Zvcm1hdGlvbiBsb2cyLCBmaWx0cmUgZGVzIGfDqG5lcyBub24tZMOpdGVjdMOpcywgc3RhbmRhcmRpc2F0aW9uIGV0IHPDqWxlY3Rpb24gZGVzIGfDqG5lcyBmb3J0ZW1lbnQgZXhwcmltw6lzIGV0IMOgIGhhdXQgY29lZmZpY2llbnQgZGUgdmFyaWF0aW9uKQoKYGBge3IgYWNwX25vcm1fc2VsZWN0ZWRfZ2VuZXMsIGZpZy53aWR0aD04LCBmaWcuaGVpZ2h0PTgsIG91dC53aWR0aD0iNjAlIiwgZmlnLmNhcD0iUEMgcGxvdCBvZiB0aGUgc2FtcGxlcyBmcm9tIG5vcm1hbGlzZWQgdmFsdWVzLCBhZnRlciBnZW5lIHNlbGVjdGlvbi4gIn0KIyMjIyBQQ0EgZnJvbSBub3JtYWxpc2VkIGNvdW50cywgc2VsZWN0ZWQgZ2VuZXMgIyMjIwptZXNzYWdlKCJSdW5uaW5nIFBDQSB3aXRoIG5vcm1hbGlzZWQgY291bnRzLCBzZWxlY3RlZCBnZW5lcyIpCgptYV9wY2Ffc2VsIDwtIFBDQSh0KGZhX2V4cHJfc2VsZWN0ZWQpLCBzY2FsZS51bml0ID0gRkFMU0UsCiAgICAgICAgICAgICAgICAgIGdyYXBoID0gRkFMU0UpCiMgcGxvdChtYV9wY2Ffc2VsLCBjaG9peCA9ICJ2YXIiKQojIHBsb3QobWFfcGNhX3NlbCwgY2hvaXggPSAiaW5kIikKZnZpel9wY2FfaW5kKG1hX3BjYV9zZWwsIGNvbC5pbmQgPSBmYV9tZXRhWywgImNvbmRpdGlvbiJdKQpgYGAKCiMjIyBDbHVzdGVyaW5nCgotIENhbGN1bGV6IGxlcyBtYXRyaWNlcyBkZSBkaXN0YW5jZSBlbnRyZSDDqWNoYW50aWxsb25zLCBlbiB1dGlsaXNhbnQgcmVzcGVjdGl2ZW1lbnQgbGVzIGRpc3RhbmNlcyBldWNsaWRpZW5uZSAoYGRpc3QoKWApLCBjb2VmZmljaWVudCBkZSBQZWFyc29uIChgY29yKCwgbWV0aG9kID0gInBlYXJzb24iKWApICBldCBkZSBTcGVhcm1hbiAoYGNvcigsIG1ldGhvZCA9ICJzcGVhcm1hbiIpYCkuCgoKYGBge3Igc2FtcGxlX2Rpc3RhbmNlc30KIyMjIyBTYW1wbGUgZGlzdGFuY2VzICMjIyMKbWVzc2FnZSgiQ29tcHV0aW5nIGludGVyLXNhbXBsZSBkaXN0YW5jZXMiKQoKZGlzdF9ldWNfc2FtcGxlcyA8LSBkaXN0KHQoZmFfZXhwcl9zZWxlY3RlZCkpCmNvcl9wZWFyc29uX3NhbXBsZXMgPC0gYXMuZGlzdCgxIC0gY29yKGZhX2V4cHJfc2VsZWN0ZWQpKQpjb3Jfc3BlYXJtYW5fc2FtcGxlcyA8LSBhcy5kaXN0KDEgLSBjb3IoZmFfZXhwcl9zZWxlY3RlZCwgbWV0aG9kID0gInNwZWFybWFuIikpCmBgYAoKLSBFZmZlY3R1ZXogdW4gY2x1c3RlcmluZyBoacOpcmFyY2hpcXVlIGRlcyDDqWNoYW50aWxsb25zLCBlbiB1dGlsaXNhbnQgbGUgY3JpdMOocmUgImNvbXBsZXRlIiBwb3VyIGwnYWdnbG9tw6lyYXRpb24uIENvbXBhcmV6IGxlcyBhcmJyZXMgZCfDqWNoYW50aWxsb25zIG9idGVudXMgYXZlYyBjZXMgdHJvaXMgbcOpdHJpcXVlcyBldCBjaG9pc2lzc2V6IGNlbGxlIHF1aSB2b3VzIHBhcmHDrnQgbGEgcGx1cyBwZXJ0aW5lbnRlLgoKYGBge3Igc2FtcGxlX2NsdXN0ZXJpbmcsIGZpZy53aWR0aD0xMiwgcGxvdC5oZWlnaHQ9NSwgb3V0LndpZHRoPSIxMDAlIiwgZmlnLmNhcD0iU2FtcGxlIHRyZWUgd2l0aCB0aHJlZSBhbHRlcm5hdGl2ZSBkaXN0YW5jZSBtZXRyaWNzOiBFdWNsaWRpYW50IGRpc3RhbmNlIChsZWZ0KSwgUGVhcnNvbiBjb3JyZWxhdGlvbiAoY2VudGVyKSwgU3BlYXJtYW4gY29ycmVsYXRpb24gKHJpZ2h0KS4/ICJ9CiMjIyMgU2FtcGxlIGNsdXN0ZXJpbmcgIyMjIwptZXNzYWdlKCJTYW1wbGUgY2x1c3RlcmluZyIpCgpwYXIobWZyb3cgPSBjKDEsMykpCnBsb3QoaGNsdXN0KGRpc3RfZXVjX3NhbXBsZXMpLCBoYW5nID0gLTEsCiAgICAgbWFpbiA9ICJldWNsaWRlYW4gZGlzdGFuY2UiKQpwbG90KGhjbHVzdChjb3JfcGVhcnNvbl9zYW1wbGVzKSwgaGFuZyA9IC0xLAogICAgIG1haW4gPSAicGVhcnNvbiIpCnBsb3QoaGNsdXN0KGNvcl9zcGVhcm1hbl9zYW1wbGVzKSwgaGFuZyA9IC0xLAogICAgIG1haW4gPSAic3BlYXJtYW4iKQpwYXIobWZyb3cgPSBjKDEsMSkpCmBgYAoKLSBFZmZlY3R1ZXogdW4gY2x1c3RlcmluZyBoacOpcmFyY2hpcXVlIGRlcyBnw6huZXMgZW4gdXRpbGlzYW50IGxhIGRpc3RhbmNlIGJhc8OpZSBzdXIgbGUgY29lZmZpY2llbnQgZGUgUGVhcnNvbiBldCBsYSByw6hnbGUgZCdhZ2dsb23DqXJhdGlvbiBjb21wbMOodGUKCmBgYHtyIGdlbmVfdHJlZX0KIyMjIyBHZW5lIHRyZWUgd2l0aCBQZWFyc29uIGNvcnJlbGF0aW9uICMjIyMKbWVzc2FnZSgiRHJhd2luZyBnZW5lIHRyZWUiKQoKCmNsdXN0ZXJpbmdfbWV0aG9kIDwtICJjb21wbGV0ZSIgIyMgQ2hvb3NlIGEgY2x1c3RlcmluZyBtZXRob2QKY29yX3BlYXJzb25fZ2VuZXMgPC0gIGFzLmRpc3QoMSAtIGNvcih0KGZhX2V4cHJfc2VsZWN0ZWQpKSkKCiMjIEJ1aWxkIGEgZ2VuZSB0cmVlCmdlbmVfdHJlZV9wZWFyc29uIDwtIGhjbHVzdChjb3JfcGVhcnNvbl9nZW5lcywgbWV0aG9kID0gY2x1c3RlcmluZ19tZXRob2QpCgojIyBQbG90IHRoZSBnZW5lIHRyZWUKcGxvdChnZW5lX3RyZWVfcGVhcnNvbiwgaGFuZyA9IC0xLCBsYXMgPSAxLCAKICAgICBtYWluID0gcGFzdGUwKCJHZW5lIHRyZWU7IFBlYXJzb24gY29lZmZpY2llbnQ7ICIsIGNsdXN0ZXJpbmdfbWV0aG9kLCAiIGNsdXN0ZXJpbmciKSwgCiAgICAgbGFiZWxzID0gRkFMU0UpCmBgYAoKLSBEZXNzaW5leiB1biBhcmJyZSBhdmVjIGxlIHLDqXN1bHRhdCBkdSBjbHVzdGVyaW5nIGRlcyBnw6huZXMgZXQgY29tbWVudGV6IHNhIHN0cnVjdHVyZS4gU2kgdm91cyBkZXZpZXogY2hvaXNpciBkZSBmYcOnb24gYXJiaXRyYWlyZSB1biBub21icmUgZGUgY2x1c3RlcnMsIHF1ZSBjaG9pc2lyaWV6LXZvdXMgPyBQb3VycXVvaSA/IFBhcyBkZSBwYW5pcXVlLCBub3VzIHBvdXZvbnMgYXNzdW1lciBpY2kgcXVlIGxhIHLDqXBvbnNlIGNvbXBvcnRlIHVuZSBwYXJ0IGRlIHN1YmplY3Rpdml0w6kuIAoKYGBge3IgZ2VuZV90cmVlX3dpdGhfYm94ZXN9CiMjIyMgUGxvdCB0aGUgZ2VuZSB0cmVlIHdpdGggYm94ZXMgdG8gZGVub3RlIHRoZSBjbHVzdGVycyAjIyMjCm1lc3NhZ2UoIlBsb3R0aW5nIGdlbmUgdHJlZSIpCgpwbG90KGdlbmVfdHJlZV9wZWFyc29uLCBoYW5nID0gLTEsCiAgICAgbWFpbiA9IHBhc3RlMCgiR2VuZSB0cmVlIHdpdGggNyBjbHVzdGVyczsgUGVhcnNvbiBjb2VmZmljaWVudDsgIiwgY2x1c3RlcmluZ19tZXRob2QsICIgY2x1c3RlcmluZyIpLCAKICAgICBsYWJlbHMgPSBGQUxTRSkKcmVjdC5oY2x1c3QoZ2VuZV90cmVlX3BlYXJzb24sIGsgPSA3KQpgYGAKCi0gRGVzc2luZXogdW5lIGhlYXRtYXAgZHUgcsOpc3VsdGF0LCBlbiBzw6lsZWN0aW9ubmFudCBsZXMgZGV1eCByw6lzdWx0YXRzIGRlIGNsdXN0ZXJpbmcgY2ktZGVzc3VzIHBvdXIgbGVzIGfDqG5lcyBldCBsZXMgw6ljaGFudGlsbG9ucy4gCgpgYGB7ciBoZWF0bWFwX2JpY2x1c3RlcmluZywgZmlnLndpZHRoPTEwLCBmaWcuaGVpZ2h0PTgsIG91dC53aWR0aD0iOTAlIiwgZmlnLmNhcD0iSGVhdG1hcCBzaG93aW5nIHRoZSBiaWNsdXN0ZXJpbmcgb2YgZ2VuZXMgYW5kIHNhbXBsZXMuICJ9CiMjIyMgSGVhdG1hcCB3aXRoIGJpY2x1c3RlcmluZyAjIyMjCm1lc3NhZ2UoImhlYXRtYXAgd2l0aCBiaWNsdXN0ZXJpbmciKQoKcGhlYXRtYXAodChmYV9leHByX3NlbGVjdGVkKSwgCiAgICAgICAgIG1haW4gPSBwYXN0ZTAoIkJpY2x1c3RlcmluZzsgIiwgIlBlYXJzb24gY29ycmVsYXRpb247ICIsIGNsdXN0ZXJpbmdfbWV0aG9kLCAiIGNsdXN0ZXJpbmciKSwKICAgICAgICAgc2hvd19jb2xuYW1lcyA9IEZBTFNFLCBzY2FsZSA9ICJub25lIiwKICAgICAgICAgY2x1c3RlcmluZ19tZXRob2QgPSBjbHVzdGVyaW5nX21ldGhvZCwgCiAgICAgICAgIGNsdXN0ZXJpbmdfZGlzdGFuY2VfY29scyA9ICJjb3JyZWxhdGlvbiIsIAogICAgICAgICBjbHVzdGVyaW5nX2Rpc3RhbmNlX3Jvd3MgPSAiY29ycmVsYXRpb24iKQpgYGAKCi0gRGVzc2luZXogdW5lIGhlYXRtYXAgZHUgcsOpc3VsdGF0LCBlbiBhZmZpY2hhbnQgdW4gYXJicmUgc3VyIGxlcyBnw6huZXMgbWFpcyBwYXMgc3VyIGxlcyDDqWNoYW50aWxsb25zCgpgYGB7ciBoZWF0bWFwX2dlbmVfY2x1c3RlcmluZywgZmlnLndpZHRoPTEwLCBmaWcuaGVpZ2h0PTgsIG91dC53aWR0aD0iOTAlIiwgZmlnLmNhcD0iSGVhdG1hcCB3aXRoIGdlbmUgY2x1c3RlcmluZy4gIn0KIyMjIyBIZWF0bWFwIHdpdGggY2x1c3RlcmluZyBvbiBnZW5lcyBvbmx5ICMjIyMKbWVzc2FnZSgiSGVhdG1hcCB3aXRoIGdlbmUgY2x1c3RlcmluZyIpCgpwaGVhdG1hcCh0KGZhX2V4cHJfc2VsZWN0ZWQpLCAKICAgICAgICAgbWFpbiA9IHBhc3RlMCgiR2VuZSBjbHVzdGVyaW5nOyAiLCAiUGVhcnNvbiBjb3JyZWxhdGlvbjsgIiwgY2x1c3RlcmluZ19tZXRob2QsICIgY2x1c3RlcmluZyIpLAogICAgICAgICBzaG93X2NvbG5hbWVzID0gRkFMU0UsIHNjYWxlID0gIm5vbmUiLAogICAgICAgICBjbHVzdGVyaW5nX21ldGhvZCA9IGNsdXN0ZXJpbmdfbWV0aG9kLCAKICAgICAgICAgY2x1c3RlcmluZ19kaXN0YW5jZV9jb2xzID0gImNvcnJlbGF0aW9uIiwgCiAgICAgICAgIGNsdXN0ZXJfcm93cyA9IEZBTFNFKQpgYGAKCgpJbnRlcnByw6l0ZXogbGVzIHLDqXN1bHRhdHMgZW4gcXVlbHF1ZXMgcGhyYXNlcy4gCgoKIyMgNS4gRW5yaWNoaXNzZW1lbnQgZm9uY3Rpb25uZWwKCioqKkEgdm91cyBkZSBqb3VlciEqKioKCkVmZmVjdHVleiB1bmUgYW5hbHlzZSBkJ2VucmljaGlzc2VtZW50IGZvbmN0aW9ubmVsIGF2ZWMgbGVzIHByaW5jaXBhdXggY2x1c3RlcnMgb2J0ZW51cyBkYW5zIGxhIHNlY3Rpb24gcHLDqWPDqWRlbnRlLiAKCmBgYHtyIGZ1bmN0aW9uYWxfZW5yaWNobWVudCwgZmlnLndpZHRoPTcsIGZpZy5oZWlnaHQ9NSwgb3V0LndpZHRoPSI4MCUiLCBmaWcuY2FwPSJEeW5hbWljIG1hcCBvZiB0aGUgZW5yaWNobWVudCBhbmFseXNpcyBmb3IgdGhlIHNlbGVjdGVkIGdlbmVzLiBQb3NpdGlvbiB0aGUgY3Vyc29yIG9uIGEgY2lyY2xlIHRvIHNlZSB0aGUgZW5yaWNoZWQgdGVybS4gIn0KIyMjIyBSdW4gZW5yaWNobWVudCBhbmFseXNpcyB3aXRoIGdvc3QoKSAjIyMjCm1lc3NhZ2UoIlJ1bm5pbmcgZW5yaWNobWVudCBhbmFseXNpcyBmb3IgIiwgc3VtKHNlbGVjdGVkX2dlbmVzKSAsICIgc2VsZWN0ZWQgZ2VuZXMiKQoKIyMgR2V0IHRoZSBsaXN0IG9mIElEcyBmb3IgdGhlIHNlbGVjdGVkIGdlbmVzICMjCmdlbmVfaWRzIDwtIHJvd25hbWVzKGdlbmVfc3RhdF9ub3JtKVtzZWxlY3RlZF9nZW5lc10KCiMjIENvbXB1dGUgZW5yaWNobWVudApnb3N0cmVzIDwtIGdvc3QocXVlcnkgPSBnZW5lX2lkcywgCiAgICAgICAgICAgICAgICBvcmdhbmlzbSA9ICJtbXVzY3VsdXMiLCAKICAgICAgICAgICAgICAgIG9yZGVyZWRfcXVlcnkgPSBGQUxTRSwgCiAgICAgICAgICAgICAgICBtdWx0aV9xdWVyeSA9IEZBTFNFLCAKICAgICAgICAgICAgICAgIHNpZ25pZmljYW50ID0gVFJVRSwgCiAgICAgICAgICAgICAgICBleGNsdWRlX2llYSA9IEZBTFNFLCAKICAgICAgICAgICAgICAgIG1lYXN1cmVfdW5kZXJyZXByZXNlbnRhdGlvbiA9IEZBTFNFLCAKICAgICAgICAgICAgICAgIGV2Y29kZXMgPSBGQUxTRSwgCiAgICAgICAgICAgICAgICB1c2VyX3RocmVzaG9sZCA9IDAuMDUsIAogICAgICAgICAgICAgICAgY29ycmVjdGlvbl9tZXRob2QgPSAiZmRyIiwgCiAgICAgICAgICAgICAgICBkb21haW5fc2NvcGUgPSAiYW5ub3RhdGVkIiwgCiAgICAgICAgICAgICAgICBjdXN0b21fYmcgPSBOVUxMLCAKICAgICAgICAgICAgICAgIG51bWVyaWNfbnMgPSAiIiwgCiAgICAgICAgICAgICAgICBzb3VyY2VzID0gTlVMTCwgCiAgICAgICAgICAgICAgICBhc19zaG9ydF9saW5rID0gRkFMU0UpCgoKIyMgQ2hlY2sgdGhlIHN0cnVjdHVyZSBvZiB0aGUgcmVzdWx0Cm5hbWVzKGdvc3RyZXMpCm5hbWVzKGdvc3RyZXMkcmVzdWx0KQprYWJsZShzdW1tYXJ5KGdvc3RyZXMpKQoKIyBWaXN1YWxpemF0aW9uCmdvc3RwbG90KGdvc3RyZXMsIGNhcHBlZCA9IFRSVUUsIGludGVyYWN0aXZlID0gVFJVRSkKCiMjIENoZWNrIHRoZSBtb3N0IHNpZ25pZmljYW50IHJlc3VsdHMsIGZvcm1hdGluZyBmb3Iga2FibGUKZW5yaWNoX29yZGVyIDwtIG9yZGVyKGdvc3RyZXMkcmVzdWx0JHBfdmFsdWUsIGRlY3JlYXNpbmcgPSBGQUxTRSkKc29ydGVkX3Jlc3VsdCA8LSBnb3N0cmVzJHJlc3VsdFtlbnJpY2hfb3JkZXIsIF0Ka2FibGUoaGVhZChzb3J0ZWRfcmVzdWx0LCBuID0gMTApLCAKICAgICAgZGlnaXRzID0gYygwLCAwLCAxNSwgNywgNywgNywgMywgMywgMCwgMCwgNywgNywgMCwgMCksIAogICAgICBjYXB0aW9uID0gIlRvcCAxMCBtb3N0IHNpZ25pZmljYW50IGVucmljaGVkIGZ1bmN0aW9uYWwgY2xhc3NlcyIpCm5hbWVzKGdvc3RyZXMkbWV0YSkKYGBgCgoKKipDaGFsbGVuZ2UgZmFsY3VsdGF0aWY6KioKCkVmZmVjdHVleiB1bmUgYW5hbHlzZSBkJ2VucmljaGlzc2VtZW50IHN1ciBjaGFjdW4gZGVzIGNsdXN0ZXJzIG9idGVudXMgw6AgcGFydGlyIGRlIGwnYXJicmUgZGVzIGfDqG5lcy4gCgpgYGB7ciBmdW5jdGlvbmFsX2VucmljaG1lbnRfY2x1c3RlcnMsIGZpZy53aWR0aD03LCBmaWcuaGVpZ2h0PTUsIG91dC53aWR0aD0iODAlIiwgZmlnLmNhcD0iRHluYW1pYyBtYXAgb2YgdGhlIGVucmljaG1lbnQgYW5hbHlzaXMgZm9yIHRoZSBjbHVzdGVycyBvYnRhaW5lZCBmcm9tIHRoZSBnZW5lIHRyZWUuIFBvc2l0aW9uIHRoZSBjdXJzb3Igb24gYSBjaXJjbGUgdG8gc2VlIHRoZSBlbnJpY2hlZCB0ZXJtLiAifQojIyMjIEVucmljaG1lbnQgYnkgY2x1c3RlciAjIyMjCm1lc3NhZ2UoIkVucmljaG1lbnQgYW5hbHlzaXMgYnkgY2x1c3RlcnMiKQoKCmBgYAoKIyMgQ29uY2x1c2lvbnMgZ8OpbsOpcmFsZXMKCgpSw6lzdW1leiBlbiBxdWVscXVlcyBwaHJhc2VzIHZvcyBjb25jbHVzaW9ucyDDoCBwYXJ0aXIgZGVzIHLDqXN1bHRhdHMgb2J0ZW51cy4gCgoKIyMgU2Vzc2lvbiBpbmZvCgoKYGBge3Igc2Vzc2lvbl9pbmZvfQojIyMjIFNlc3Npb24gaW5mbyAjIyMjCnNlc3Npb25JbmZvKCkKCmBgYAoK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("solutions_m3-stat-R_mini-projet.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
